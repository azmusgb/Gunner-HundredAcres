<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Pooh's Magical Honey Hunt</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no" />
  <meta name="theme-color" content="#d4a574" />
  <meta name="description" content="A magical interactive adventure in the Hundred Acre Wood with Pooh Bear!" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Fredoka+One&display=swap" rel="stylesheet">

  <style>
    /* ===============================
       THEME & ANIMATIONS
    ================================ */
    :root {
      --pooh-bear: #d4a574;
      --pooh-light: #e8c9a3;
      --pooh-red: #e63946;
      --honey-pot: #8b4513;
      --honey-gold: #ffa500;
      --honey-shine: #ffd700;
      --wood-brown: #5d4e37;
      --wood-light: #8b7355;
      --grass-green: #7cb342;
      --grass-dark: #558b2f;
      --sky-blue: #87ceeb;
      --sky-light: #b0e0e6;
      --bee-yellow: #ffd700;
      --bee-black: #1a1a1a;
      --cloud-white: rgba(255, 255, 255, 0.95);
      --shadow-soft: 0 8px 32px rgba(0,0,0,0.15);
      --shadow-strong: 0 16px 48px rgba(0,0,0,0.25);
      --blossom-pink: #ffb7c5;
      --blossom-light: #ffd7dd;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(-1deg); }
      50% { transform: translateY(-12px) rotate(1deg); }
    }

    @keyframes cloudDrift {
      0% { transform: translateX(0); }
      100% { transform: translateX(100vw); }
    }

    @keyframes sway {
      0%, 100% { transform: rotate(-3deg); }
      50% { transform: rotate(3deg); }
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0) scale(1); }
      50% { transform: translateY(-15px) scale(1.08); }
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateY(30px) scale(0.9); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }

    @keyframes scorePopIn {
      0% { transform: scale(0.3) rotate(-15deg); opacity: 0; }
      50% { transform: scale(1.4) rotate(8deg); }
      100% { transform: scale(1) rotate(0deg); opacity: 1; }
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0) rotate(0deg); }
      25% { transform: translateX(-8px) rotate(-3deg); }
      75% { transform: translateX(8px) rotate(3deg); }
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0.4; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.4); }
    }

    @keyframes honeyDrip {
      0% { transform: translateY(0) scaleY(1); }
      50% { transform: translateY(5px) scaleY(1.2); }
      100% { transform: translateY(0) scaleY(1); }
    }

    @keyframes blossomFall {
      0% { transform: translateY(-50px) rotate(0deg); }
      100% { transform: translateY(100vh) rotate(360deg); }
    }

    @keyframes butterflyFlutter {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(10deg); }
    }

    @keyframes ripple {
      0% { transform: scale(0); opacity: 1; }
      100% { transform: scale(4); opacity: 0; }
    }

    @keyframes pulse {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 1; }
    }

    /* ===============================
       RESET & BASE
    ================================ */
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      -webkit-tap-highlight-color: transparent;
    }

    html, body {
      height: 100%;
      background: linear-gradient(180deg, #0a3d62 0%, #87ceeb 40%, #b0e0e6 100%);
      font-family: 'Patrick Hand', 'Comic Sans MS', cursive, system-ui;
      color: var(--wood-brown);
      overflow: hidden;
      touch-action: none;
    }

    main {
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
      position: relative;
      filter: drop-shadow(0 0 20px rgba(0,0,0,0.1));
    }

    /* ===============================
       BACKGROUND ELEMENTS
    ================================ */
    .background-layer {
      position: fixed;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      z-index: 0;
    }

    .cloud {
      position: absolute;
      background: white;
      border-radius: 100px;
      opacity: 0.8;
      animation: cloudDrift linear infinite;
      filter: drop-shadow(0 5px 15px rgba(255,255,255,0.2));
    }

    .cloud::before,
    .cloud::after {
      content: '';
      position: absolute;
      background: white;
      border-radius: 100px;
    }

    .cloud-1 {
      width: 120px;
      height: 50px;
      top: 15%;
      left: -140px;
      animation-duration: 40s;
    }

    .cloud-1::before {
      width: 60px;
      height: 60px;
      top: -30px;
      left: 15px;
    }

    .cloud-1::after {
      width: 70px;
      height: 50px;
      top: -20px;
      right: 15px;
    }

    .cloud-2 {
      width: 180px;
      height: 70px;
      top: 30%;
      left: -200px;
      animation-duration: 60s;
      animation-delay: 10s;
    }

    .cloud-2::before {
      width: 80px;
      height: 80px;
      top: -40px;
      left: 20px;
    }

    .cloud-2::after {
      width: 90px;
      height: 70px;
      top: -30px;
      right: 20px;
    }

    .blossom {
      position: absolute;
      width: 12px;
      height: 12px;
      background: linear-gradient(135deg, var(--blossom-pink) 0%, var(--blossom-light) 100%);
      border-radius: 50% 50% 50% 0;
      opacity: 0.7;
      animation: blossomFall linear infinite;
    }

    .butterfly {
      position: absolute;
      width: 24px;
      height: 16px;
      background: linear-gradient(135deg, #ff6b6b 0%, #ffd93d 100%);
      border-radius: 50%;
      opacity: 0.8;
      animation: butterflyFlutter 3s ease-in-out infinite;
    }

    .butterfly::before,
    .butterfly::after {
      content: '';
      position: absolute;
      width: 16px;
      height: 24px;
      background: inherit;
      border-radius: 50%;
      top: -4px;
    }

    .butterfly::before {
      left: -8px;
      transform: rotate(45deg);
    }

    .butterfly::after {
      right: -8px;
      transform: rotate(-45deg);
    }

    /* ===============================
       TOP BAR - ENHANCED STYLE
    ================================ */
    .top-bar {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      max-width: 480px;
      display: flex;
      justify-content: space-between;
      padding: 0 24px;
      z-index: 10;
      gap: 16px;
    }

    .stat-card {
      background: linear-gradient(135deg, rgba(255, 248, 225, 0.9) 0%, rgba(255, 232, 184, 0.9) 100%);
      backdrop-filter: blur(10px);
      border: 4px solid var(--wood-brown);
      padding: 14px 24px;
      border-radius: 24px;
      box-shadow: 
        var(--shadow-soft),
        inset 0 4px 0 rgba(255,255,255,0.6),
        inset 0 -4px 0 rgba(0,0,0,0.1);
      font-weight: 900;
      font-size: 1rem;
      display: flex;
      flex-direction: column;
      gap: 4px;
      min-width: 110px;
      animation: slideIn 0.5s ease-out;
      position: relative;
      border-bottom-width: 6px;
      font-family: 'Fredoka One', cursive;
    }

    .stat-card::before {
      content: '';
      position: absolute;
      top: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 20px;
      height: 20px;
      background: radial-gradient(circle, var(--honey-gold) 0%, var(--honey-shine) 100%);
      border-radius: 50%;
      box-shadow: 0 4px 12px rgba(255,165,0,0.6);
      animation: twinkle 2s infinite, pulse 1.5s infinite;
      z-index: 1;
    }

    .stat-label {
      font-size: 0.75rem;
      opacity: 0.9;
      text-transform: uppercase;
      letter-spacing: 1.5px;
      color: var(--wood-brown);
      text-shadow: 1px 1px 0 rgba(255,255,255,0.8);
      font-family: 'Patrick Hand', cursive;
    }

    .stat-value {
      font-size: 2rem;
      color: var(--pooh-red);
      text-shadow: 
        3px 3px 0 rgba(0,0,0,0.15),
        -1px -1px 0 rgba(255,255,255,0.5);
      animation: scorePopIn 0.4s ease-out;
      line-height: 1;
    }

    /* ===============================
       CANVAS CONTAINER
    ================================ */
    .game-container {
      position: relative;
      animation: float 6s ease-in-out infinite;
      filter: 
        drop-shadow(0 25px 50px rgba(0,0,0,0.3))
        drop-shadow(0 0 20px rgba(255, 215, 0, 0.2));
      transition: filter 0.3s ease;
    }

    .game-container:hover {
      filter: 
        drop-shadow(0 25px 50px rgba(0,0,0,0.3))
        drop-shadow(0 0 30px rgba(255, 215, 0, 0.4));
    }

    #honey-game {
      background: linear-gradient(180deg, 
        #0a3d62 0%,
        #1e6fa8 20%,
        #87ceeb 40%,
        #b0e0e6 60%,
        #a8d5a3 80%,
        #7cb342 100%
      );
      border-radius: 28px;
      border: 8px solid var(--wood-brown);
      box-shadow: 
        0 0 0 4px var(--wood-light),
        var(--shadow-strong),
        inset 0 -8px 24px rgba(0,0,0,0.2),
        inset 0 8px 24px rgba(255,255,255,0.1);
      touch-action: none;
      cursor: none;
      position: relative;
      overflow: hidden;
    }

    #honey-game::before {
      content: '';
      position: absolute;
      inset: 0;
      background: 
        radial-gradient(circle at 20% 80%, rgba(255,255,255,0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(255,255,255,0.1) 0%, transparent 50%);
      pointer-events: none;
      z-index: 1;
    }

    /* ===============================
       CUSTOM CURSOR
    ================================ */
    .honey-cursor {
      position: fixed;
      width: 48px;
      height: 48px;
      pointer-events: none;
      z-index: 9999;
      transform: translate(-50%, -50%);
      transition: transform 0.1s ease;
      filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
      display: none;
    }

    .honey-cursor.active {
      display: block;
    }

    .honey-cursor .spoon {
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at 30% 30%, #ffd700 0%, #ffa500 100%);
      clip-path: polygon(0% 45%, 60% 45%, 60% 30%, 100% 50%, 60% 70%, 60% 55%, 0% 55%);
      transform-origin: 60% 50%;
      animation: honeyDrip 2s infinite;
    }

    /* ===============================
       FLOATING ELEMENTS
    ================================ */
    .score-popup {
      position: absolute;
      font-weight: 900;
      font-size: 2.4rem;
      color: var(--honey-gold);
      pointer-events: none;
      text-shadow: 
        4px 4px 0 var(--wood-brown),
        -2px -2px 0 white,
        0 0 30px rgba(255,165,0,0.9);
      animation: popupFloat 1.5s ease-out forwards;
      z-index: 100;
      font-family: 'Fredoka One', cursive;
      letter-spacing: 1px;
    }

    @keyframes popupFloat {
      0% { 
        opacity: 1; 
        transform: translate(-50%, 0) scale(0.5) rotate(-20deg);
      }
      40% {
        transform: translate(-50%, -60px) scale(1.4) rotate(10deg);
      }
      100% { 
        opacity: 0; 
        transform: translate(-50%, -120px) scale(1) rotate(0deg);
      }
    }

    .honey-word {
      position: absolute;
      font-size: 1.6rem;
      font-weight: 900;
      color: var(--honey-gold);
      text-shadow: 
        3px 3px 0 var(--wood-brown),
        -1px -1px 0 white,
        0 0 20px rgba(255,165,0,0.8);
      pointer-events: none;
      animation: floatWord 2.5s ease-out forwards;
      z-index: 101;
      font-family: 'Patrick Hand', cursive;
      text-align: center;
      padding: 8px 16px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      backdrop-filter: blur(5px);
    }

    @keyframes floatWord {
      0% { opacity: 0; transform: translateY(0) scale(0.3) rotate(-10deg); }
      30% { opacity: 1; transform: translateY(-40px) scale(1.3) rotate(5deg); }
      100% { opacity: 0; transform: translateY(-100px) scale(0.8) rotate(0deg); }
    }

    /* ===============================
       OVERLAYS - STORYBOOK STYLE
    ================================ */
    .overlay {
      position: absolute;
      inset: 0;
      background: 
        linear-gradient(135deg, 
          rgba(255, 248, 225, 0.95) 0%, 
          rgba(255, 232, 184, 0.95) 50%, 
          rgba(255, 216, 155, 0.95) 100%);
      backdrop-filter: blur(20px);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 32px;
      text-align: center;
      z-index: 1000;
      animation: slideIn 0.6s ease-out;
      border: 12px solid var(--wood-brown);
      box-shadow: 
        inset 0 0 80px rgba(212,165,116,0.4),
        0 0 60px rgba(0,0,0,0.2);
      padding: 40px;
    }

    .overlay::before {
      content: '';
      position: absolute;
      inset: 24px;
      border: 3px dashed var(--wood-light);
      border-radius: 16px;
      pointer-events: none;
    }

    .overlay::after {
      content: '';
      position: absolute;
      top: -6px;
      left: 50%;
      transform: translateX(-50%);
      width: 120px;
      height: 24px;
      background: var(--wood-brown);
      border-radius: 12px 12px 0 0;
      box-shadow: 0 -4px 0 rgba(0,0,0,0.2);
    }

    .overlay.hidden {
      display: none;
    }

    .overlay h1 {
      font-size: 4rem;
      font-weight: 900;
      color: var(--pooh-red);
      text-shadow: 
        6px 6px 0 var(--pooh-bear),
        8px 8px 0 var(--wood-brown);
      letter-spacing: 2px;
      line-height: 1.1;
      animation: bounce 3s ease-in-out infinite;
      font-family: 'Fredoka One', cursive;
      margin-bottom: 8px;
    }

    .overlay .subtitle {
      font-size: 1.5rem;
      color: var(--wood-brown);
      text-shadow: 2px 2px 0 rgba(255,255,255,0.5);
      font-family: 'Patrick Hand', cursive;
      max-width: 400px;
      line-height: 1.4;
    }

    .btn {
      background: linear-gradient(135deg, var(--pooh-red) 0%, #c62828 100%);
      border: 6px solid var(--wood-brown);
      padding: 22px 56px;
      font-size: 1.5rem;
      font-weight: 900;
      border-radius: 60px;
      cursor: pointer;
      box-shadow: 
        0 8px 0 #8b2020,
        0 16px 32px rgba(0,0,0,0.4),
        inset 0 4px 0 rgba(255,255,255,0.4);
      color: white;
      text-transform: uppercase;
      letter-spacing: 3px;
      transition: all 0.2s ease;
      position: relative;
      font-family: 'Fredoka One', cursive;
      text-shadow: 3px 3px 0 rgba(0,0,0,0.3);
      overflow: hidden;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: -10px;
      left: -10px;
      right: -10px;
      bottom: -10px;
      background: linear-gradient(45deg, 
        transparent 30%, 
        rgba(255,255,255,0.1) 50%, 
        transparent 70%);
      transform: translateX(-100%);
      transition: transform 0.6s ease;
    }

    .btn:hover {
      transform: translateY(-4px);
      box-shadow: 
        0 12px 0 #8b2020,
        0 24px 48px rgba(0,0,0,0.5),
        inset 0 4px 0 rgba(255,255,255,0.4);
    }

    .btn:hover::before {
      transform: translateX(100%);
    }

    .btn:active {
      transform: translateY(6px);
      box-shadow: 
        0 4px 0 #8b2020,
        0 8px 16px rgba(0,0,0,0.3),
        inset 0 4px 0 rgba(255,255,255,0.4);
    }

    /* ===============================
       GAME OVER - ENHANCED
    ================================ */
    .final-score {
      font-size: 6rem;
      font-weight: 900;
      color: var(--honey-gold);
      text-shadow: 
        6px 6px 0 var(--wood-brown),
        -3px -3px 0 white,
        0 0 40px rgba(255,165,0,0.8);
      animation: bounce 2s ease-in-out infinite;
      margin: 20px 0;
      font-family: 'Fredoka One', cursive;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 24px;
      margin: 32px 0;
      width: 100%;
      max-width: 400px;
    }

    .stat-box {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(240, 230, 210, 0.9) 100%);
      backdrop-filter: blur(10px);
      border: 5px solid var(--wood-brown);
      padding: 24px;
      border-radius: 24px;
      box-shadow: 
        var(--shadow-soft),
        inset 0 4px 0 rgba(255,255,255,0.8);
      transition: transform 0.3s ease;
    }

    .stat-box:hover {
      transform: translateY(-5px) scale(1.05);
    }

    .stat-box-label {
      font-size: 1rem;
      opacity: 0.9;
      margin-bottom: 12px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 2px;
      color: var(--wood-brown);
      font-family: 'Patrick Hand', cursive;
    }

    .stat-box-value {
      font-size: 2.8rem;
      font-weight: 900;
      color: var(--pooh-red);
      text-shadow: 3px 3px 0 rgba(0,0,0,0.1);
      line-height: 1;
    }

    .pooh-quote {
      font-style: italic;
      color: var(--wood-brown);
      font-size: 1.3rem;
      max-width: 360px;
      line-height: 1.6;
      opacity: 0.9;
      margin-top: 16px;
      padding: 16px 24px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      border-left: 6px solid var(--pooh-red);
      font-family: 'Patrick Hand', cursive;
    }

    /* ===============================
       ACCESSIBILITY
    ================================ */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      overflow: hidden;
      clip: rect(0 0 0 0);
    }

    /* ===============================
       RESPONSIVE
    ================================ */
    @media (max-width: 480px) {
      .top-bar {
        padding: 0 16px;
        flex-direction: column;
        align-items: center;
        gap: 12px;
      }
      
      .stat-card {
        min-width: 90px;
        padding: 12px 20px;
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
      }

      .stat-card::before {
        width: 16px;
        height: 16px;
        top: -8px;
      }

      .overlay h1 {
        font-size: 3rem;
      }

      .overlay .subtitle {
        font-size: 1.2rem;
      }

      .btn {
        padding: 20px 40px;
        font-size: 1.2rem;
      }

      .stats-grid {
        grid-template-columns: 1fr;
        gap: 16px;
      }

      .final-score {
        font-size: 4rem;
      }
    }

    @media (max-height: 700px) {
      .game-container {
        transform: scale(0.85);
      }
      
      .overlay {
        padding: 20px;
        gap: 20px;
      }
      
      .overlay h1 {
        font-size: 2.5rem;
        margin-bottom: 4px;
      }
    }
  </style>
</head>

<body>
<div class="background-layer" id="background-layer"></div>

<!-- Custom Honey Cursor -->
<div class="honey-cursor" id="honey-cursor">
  <div class="spoon"></div>
</div>

<main id="game-root" role="main">

  <header class="top-bar">
    <div class="stat-card">
      <div class="stat-label">Honey Pots</div>
      <div class="stat-value" id="score">0</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Streak</div>
      <div class="stat-value" id="streak">0</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Lives</div>
      <div class="stat-value" id="lives">3</div>
    </div>
  </header>

  <div class="game-container">
    <canvas
      id="honey-game"
      width="420"
      height="700"
      role="img"
      aria-label="Pooh's Magical Honey Hunt game in the Hundred Acre Wood"
      aria-describedby="game-status"
    ></canvas>
  </div>

  <div id="game-status" class="sr-only" aria-live="polite">
    Game ready
  </div>

  <!-- Start Overlay -->
  <div class="overlay" id="start-overlay">
    <h1>Pooh's<br>Magical<br>Honey Hunt</h1>
    <p class="subtitle">Help Pooh catch falling honey pots in the Hundred Acre Wood!<br>Watch out for the bees!</p>
    <button class="btn" id="start-btn">
      <span>‚ú® Let's Play! ‚ú®</span>
    </button>
  </div>

  <!-- Pause Overlay -->
  <div class="overlay hidden" id="pause-overlay">
    <h2>‚è∏Ô∏è Taking a Rest</h2>
    <p class="pooh-quote">"Don't underestimate the value of Doing Nothing, of just going along, listening to all the things you can't hear, and not bothering."</p>
    <button class="btn" id="resume-btn">Continue Adventure</button>
  </div>

  <!-- Game Over Overlay -->
  <div class="overlay hidden" id="gameover-overlay">
    <h2>Oh Bother!</h2>
    <div class="final-score" id="final-score">0</div>
    <div class="stats-grid">
      <div class="stat-box">
        <div class="stat-box-label">Best Streak</div>
        <div class="stat-box-value" id="best-streak">0</div>
      </div>
      <div class="stat-box">
        <div class="stat-box-label">Pots Caught</div>
        <div class="stat-box-value" id="honey-caught">0</div>
      </div>
      <div class="stat-box">
        <div class="stat-box-label">Time Played</div>
        <div class="stat-box-value" id="time-played">0s</div>
      </div>
      <div class="stat-box">
        <div class="stat-box-label">High Score</div>
        <div class="stat-box-value" id="high-score">0</div>
      </div>
    </div>
    <p class="pooh-quote">"A little Consideration, a little Thought for Others, makes all the difference."</p>
    <button class="btn" id="restart-btn">Play Again üçØ</button>
  </div>

</main>

<script>
(() => {
  'use strict';

  /* ===============================
     INITIALIZATION
  ================================ */
  const canvas = document.getElementById('honey-game');
  const ctx = canvas.getContext('2d', { alpha: false, desynchronized: true });

  const scoreEl = document.getElementById('score');
  const streakEl = document.getElementById('streak');
  const livesEl = document.getElementById('lives');
  const statusEl = document.getElementById('game-status');
  const honeyCursor = document.getElementById('honey-cursor');

  const startOverlay = document.getElementById('start-overlay');
  const pauseOverlay = document.getElementById('pause-overlay');
  const gameoverOverlay = document.getElementById('gameover-overlay');

  const startBtn = document.getElementById('start-btn');
  const resumeBtn = document.getElementById('resume-btn');
  const restartBtn = document.getElementById('restart-btn');

  const gameContainer = document.querySelector('.game-container');
  const backgroundLayer = document.getElementById('background-layer');

  /* ===============================
     BACKGROUND ENHANCEMENTS
  ================================ */
  function createBlossoms() {
    for (let i = 0; i < 15; i++) {
      const blossom = document.createElement('div');
      blossom.className = 'blossom';
      blossom.style.left = `${Math.random() * 100}vw`;
      blossom.style.animationDelay = `${Math.random() * 5}s`;
      blossom.style.animationDuration = `${20 + Math.random() * 30}s`;
      blossom.style.opacity = `${0.3 + Math.random() * 0.4}`;
      blossom.style.width = `${8 + Math.random() * 8}px`;
      blossom.style.height = blossom.style.width;
      backgroundLayer.appendChild(blossom);
    }

    for (let i = 0; i < 3; i++) {
      const butterfly = document.createElement('div');
      butterfly.className = 'butterfly';
      butterfly.style.left = `${Math.random() * 100}vw`;
      butterfly.style.top = `${20 + Math.random() * 60}vh`;
      butterfly.style.animationDelay = `${Math.random() * 3}s`;
      butterfly.style.animationDuration = `${5 + Math.random() * 5}s`;
      backgroundLayer.appendChild(butterfly);
    }
  }

  /* ===============================
     GAME STATE
  ================================ */
  let lastTime = 0;
  let running = false;
  let paused = false;
  let startTime = 0;
  let timePlayed = 0;
  let highScore = parseInt(localStorage.getItem('poohHighScore')) || 0;

  let score = 0;
  let streak = 0;
  let bestStreak = 0;
  let honeyCaught = 0;
  let lives = 3;

  const player = {
    x: canvas.width / 2,
    y: canvas.height - 70,
    vx: 0,
    radius: 32,
    wobble: 0,
    armAngle: 0,
    trail: []
  };

  /* ===============================
     ENHANCED PARTICLES
  ================================ */
  const particles = [];

  function createParticles(x, y, color, count = 20, type = 'star') {
    const types = ['circle', 'star', 'heart', 'honey'];
    
    for (let i = 0; i < count; i++) {
      const particleType = type === 'mixed' ? types[Math.floor(Math.random() * types.length)] : type;
      const angle = (Math.PI * 2 * i) / count + (Math.random() - 0.5);
      const speed = 60 + Math.random() * 100;
      
      particles.push({
        x,
        y,
        vx: Math.cos(angle) * speed,
        vy: Math.sin(angle) * speed - 40,
        life: 1,
        decay: 0.01 + Math.random() * 0.02,
        size: 4 + Math.random() * 8,
        color,
        type: particleType,
        rotation: Math.random() * Math.PI * 2,
        rotationSpeed: (Math.random() - 0.5) * 0.3,
        gravity: type === 'honey' ? 400 : 300,
        drag: 0.96 + Math.random() * 0.03
      });
    }
  }

  function updateParticles(dt) {
    for (let i = particles.length - 1; i >= 0; i--) {
      const p = particles[i];
      p.x += p.vx * dt;
      p.y += p.vy * dt;
      p.vy += p.gravity * dt;
      p.vx *= p.drag;
      p.rotation += p.rotationSpeed;
      p.life -= p.decay;
      
      if (p.life <= 0) {
        particles.splice(i, 1);
      }
    }
  }

  /* ===============================
     OBJECT MANAGEMENT
  ================================ */
  const honeys = [];
  const bees = [];
  const powerups = [];

  function spawnHoney() {
    const h = {
      x: 40 + Math.random() * (canvas.width - 80),
      y: -40,
      vy: 120 + Math.random() * 80 + score / 100,
      active: true,
      wobble: Math.random() * Math.PI * 2,
      rotation: Math.random() * Math.PI * 2,
      rotationSpeed: (Math.random() - 0.5) * 0.08,
      scale: 0.8 + Math.random() * 0.4,
      type: Math.random() < 0.1 ? 'golden' : 'normal'
    };
    return h;
  }

  function spawnBee() {
    const side = Math.random() < 0.5 ? 'left' : 'right';
    const b = {
      x: side === 'left' ? -40 : canvas.width + 40,
      y: 50 + Math.random() * 300,
      vx: side === 'left' ? 140 + Math.random() * 80 : -(140 + Math.random() * 80),
      vy: (Math.random() - 0.5) * 60,
      active: true,
      wobble: Math.random() * Math.PI * 2,
      wingFlap: 0,
      angry: Math.random() < 0.3,
      trail: []
    };
    return b;
  }

  /* ===============================
     INPUT HANDLING
  ================================ */
  let targetX = player.x;
  let isDragging = false;

  canvas.addEventListener('touchstart', (e) => {
    e.preventDefault();
    isDragging = true;
    const rect = canvas.getBoundingClientRect();
    targetX = e.touches[0].clientX - rect.left;
    showCursor(true);
  }, { passive: false });

  canvas.addEventListener('touchmove', (e) => {
    e.preventDefault();
    const rect = canvas.getBoundingClientRect();
    targetX = e.touches[0].clientX - rect.left;
    updateCursor(e.touches[0].clientX, e.touches[0].clientY);
  }, { passive: false });

  canvas.addEventListener('touchend', () => {
    isDragging = false;
    showCursor(false);
  });

  canvas.addEventListener('mousemove', (e) => {
    const rect = canvas.getBoundingClientRect();
    targetX = e.clientX - rect.left;
    updateCursor(e.clientX, e.clientY);
    showCursor(true);
  });

  canvas.addEventListener('mouseleave', () => showCursor(false));

  window.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowLeft') targetX = Math.max(0, targetX - 80);
    if (e.key === 'ArrowRight') targetX = Math.min(canvas.width, targetX + 80);
    if (e.key === ' ' || e.key === 'Escape') togglePause();
  });

  function updateCursor(x, y) {
    honeyCursor.style.left = `${x}px`;
    honeyCursor.style.top = `${y}px`;
  }

  function showCursor(show) {
    if (show && running && !paused) {
      honeyCursor.classList.add('active');
    } else {
      honeyCursor.classList.remove('active');
    }
  }

  /* ===============================
     GAME LOOP
  ================================ */
  let spawnTimer = 0;
  let beeSpawnTimer = 0;

  function loop(now) {
    if (!running) return;

    const dt = Math.min((now - lastTime) / 1000, 0.033);
    lastTime = now;

    if (!paused) {
      update(dt);
      updateParticles(dt);
      timePlayed += dt;
    }
    render();

    requestAnimationFrame(loop);
  }

  function update(dt) {
    // Player movement with smooth interpolation
    const dx = targetX - player.x;
    player.vx += dx * 0.25;
    player.vx *= 0.75;
    player.x += player.vx * dt * 70;
    player.x = Math.max(player.radius, Math.min(canvas.width - player.radius, player.x));
    
    player.wobble += dt * 4;
    player.armAngle = Math.sin(player.wobble * 2.5) * 0.4;

    // Trail effect
    player.trail.unshift({ x: player.x, y: player.y });
    if (player.trail.length > 8) player.trail.pop();

    // Spawn honey pots
    spawnTimer += dt;
    if (spawnTimer > Math.max(0.4, 1.0 - score / 4000)) {
      honeys.push(spawnHoney());
      spawnTimer = 0;
    }

    // Spawn bees
    beeSpawnTimer += dt;
    if (beeSpawnTimer > Math.max(1.5, 3.5 - score / 3000)) {
      bees.push(spawnBee());
      beeSpawnTimer = 0;
    }

    // Update honey pots
    for (let i = honeys.length - 1; i >= 0; i--) {
      const h = honeys[i];
      h.y += h.vy * dt;
      h.wobble += dt * 6;
      h.rotation += h.rotationSpeed;

      const dist = Math.hypot(h.x - player.x, h.y - player.y);
      if (dist < player.radius + 22) {
        const multiplier = h.type === 'golden' ? 3 : 1;
        const points = (10 + streak * 4) * multiplier;
        score += points;
        streak++;
        honeyCaught++;
        if (streak > bestStreak) bestStreak = streak;
        
        createParticles(h.x, h.y, h.type === 'golden' ? '#ffd700' : '#ffa500', 
                       h.type === 'golden' ? 30 : 20, 'mixed');
        
        showScorePopup(h.x, h.y, `+${points}${h.type === 'golden' ? ' ‚ú®' : ''}`);
        
        if (streak % 8 === 0) {
          showHoneyWord(player.x, player.y, 'TIGGERIFIC!');
        }
        
        updateHUD();
        honeys.splice(i, 1);
        continue;
      }

      if (h.y > canvas.height + 60) {
        if (streak > 0) {
          streak = Math.max(0, streak - 2);
          updateHUD();
        }
        honeys.splice(i, 1);
      }
    }

    // Update bees
    for (let i = bees.length - 1; i >= 0; i--) {
      const b = bees[i];
      b.x += b.vx * dt;
      b.y += b.vy * dt;
      b.wobble += dt * 10;
      b.wingFlap += dt * 25;

      // Bee trail
      b.trail.unshift({ x: b.x, y: b.y });
      if (b.trail.length > 5) b.trail.pop();

      const dist = Math.hypot(b.x - player.x, b.y - player.y);
      if (dist < player.radius + 20) {
        lives--;
        streak = 0;
        createParticles(b.x, b.y, '#000', 25, 'circle');
        createParticles(player.x, player.y, '#d4a574', 18, 'star');
        shakeScreen();
        showHoneyWord(player.x, player.y, 'OH BOTHER!');
        
        if (lives <= 0) {
          endGame();
        }
        
        updateHUD();
        bees.splice(i, 1);
        continue;
      }

      if ((b.x < -100 && b.vx < 0) || (b.x > canvas.width + 100 && b.vx > 0)) {
        bees.splice(i, 1);
      }
    }
  }

  /* ===============================
     ENHANCED RENDERING
  ================================ */
  function render() {
    // Sky with gradient animation
    const time = Date.now() / 1000;
    const pulse = Math.sin(time * 0.5) * 0.1 + 0.9;
    
    const skyGradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
    skyGradient.addColorStop(0, `rgb(${10 + pulse * 5}, ${61 + pulse * 10}, ${98 + pulse * 10})`);
    skyGradient.addColorStop(0.2, `rgb(${30 + pulse * 10}, ${111 + pulse * 20}, ${168 + pulse * 20})`);
    skyGradient.addColorStop(0.4, `rgb(${135}, ${206}, ${235})`);
    skyGradient.addColorStop(0.6, `rgb(${176}, ${224}, ${230})`);
    skyGradient.addColorStop(0.8, `rgb(${168}, ${213}, ${163})`);
    skyGradient.addColorStop(1, `rgb(${124}, ${179}, ${66})`);
    
    ctx.fillStyle = skyGradient;
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Sun with glow
    const sunGradient = ctx.createRadialGradient(340, 90, 0, 340, 90, 60);
    sunGradient.addColorStop(0, '#fff9e6');
    sunGradient.addColorStop(0.3, '#ffe066');
    sunGradient.addColorStop(1, 'rgba(255, 204, 0, 0.2)');
    ctx.fillStyle = sunGradient;
    ctx.beginPath();
    ctx.arc(340, 90, 60, 0, Math.PI * 2);
    ctx.fill();

    // Distant hills
    ctx.fillStyle = '#558b2f';
    ctx.beginPath();
    ctx.moveTo(0, canvas.height - 150);
    ctx.bezierCurveTo(100, canvas.height - 200, 200, canvas.height - 180, 300, canvas.height - 150);
    ctx.bezierCurveTo(400, canvas.height - 200, canvas.width, canvas.height - 180, canvas.width, canvas.height - 150);
    ctx.lineTo(canvas.width, canvas.height);
    ctx.lineTo(0, canvas.height);
    ctx.closePath();
    ctx.fill();

    // Ground with detailed grass
    const grassGradient = ctx.createLinearGradient(0, canvas.height - 40, 0, canvas.height);
    grassGradient.addColorStop(0, '#7cb342');
    grassGradient.addColorStop(1, '#558b2f');
    ctx.fillStyle = grassGradient;
    ctx.fillRect(0, canvas.height - 40, canvas.width, 40);

    // Individual grass blades
    ctx.strokeStyle = '#8bc34a';
    ctx.lineWidth = 1.5;
    for (let i = 0; i < canvas.width; i += 6) {
      ctx.beginPath();
      ctx.moveTo(i, canvas.height - 40);
      const curve = Math.sin(i * 0.1 + time) * 8;
      ctx.quadraticCurveTo(i + curve, canvas.height - 60, i, canvas.height - 80);
      ctx.stroke();
    }

    // Trees
    drawTree(80, canvas.height - 40, 80, 0.8);
    drawTree(200, canvas.height - 40, 100, 1);
    drawTree(320, canvas.height - 40, 90, 0.9);

    function drawTree(x, y, height, scale) {
      ctx.save();
      ctx.translate(x, y);
      const sway = Math.sin(time * 0.5 + x * 0.01) * 5;
      ctx.rotate(sway * 0.01);
      
      // Trunk
      const trunkGradient = ctx.createLinearGradient(-12, 0, 12, -height);
      trunkGradient.addColorStop(0, '#8b4513');
      trunkGradient.addColorStop(1, '#5d4e37');
      ctx.fillStyle = trunkGradient;
      ctx.fillRect(-12 * scale, -height, 24 * scale, height);
      
      // Leaves
      const leafGradient = ctx.createRadialGradient(0, -height, 0, 0, -height, 50 * scale);
      leafGradient.addColorStop(0, '#81c784');
      leafGradient.addColorStop(1, '#388e3c');
      ctx.fillStyle = leafGradient;
      
      ctx.beginPath();
      ctx.arc(-20 * scale, -height, 35 * scale, 0, Math.PI * 2);
      ctx.fill();
      
      ctx.beginPath();
      ctx.arc(20 * scale, -height, 35 * scale, 0, Math.PI * 2);
      ctx.fill();
      
      ctx.beginPath();
      ctx.arc(0, -height - 25 * scale, 40 * scale, 0, Math.PI * 2);
      ctx.fill();
      
      ctx.restore();
    }

    // Pooh Bear with trail
    drawPooh();

    // Bees with trail
    for (const b of bees) {
      drawBee(b);
    }

    // Honey pots
    for (const h of honeys) {
      drawHoneyPot(h);
    }

    // Particles
    drawParticles();

    // UI elements
    drawUI();
  }

  function drawPooh() {
    ctx.save();
    ctx.translate(player.x, player.y);
    
    const wobble = Math.sin(player.wobble) * 3;
    
    // Trail effect
    for (let i = 0; i < player.trail.length; i++) {
      const point = player.trail[i];
      const alpha = (player.trail.length - i) / player.trail.length * 0.3;
      ctx.fillStyle = `rgba(212, 165, 116, ${alpha})`;
      ctx.beginPath();
      ctx.arc(point.x - player.x, point.y - player.y, player.radius * (i / player.trail.length), 0, Math.PI * 2);
      ctx.fill();
    }

    // Shadow
    ctx.globalAlpha = 0.3;
    ctx.fillStyle = '#000';
    ctx.beginPath();
    ctx.ellipse(0, player.radius + 12, player.radius * 0.7, 10, 0, 0, Math.PI * 2);
    ctx.fill();
    ctx.globalAlpha = 1;

    // Body
    const bodyGradient = ctx.createRadialGradient(-8, -8, 0, 0, 0, player.radius);
    bodyGradient.addColorStop(0, '#f0d8b8');
    bodyGradient.addColorStop(0.7, '#d4a574');
    bodyGradient.addColorStop(1, '#b8863c');
    ctx.fillStyle = bodyGradient;
    ctx.beginPath();
    ctx.arc(0, wobble, player.radius, 0, Math.PI * 2);
    ctx.fill();

    // Red shirt
    ctx.fillStyle = '#e63946';
    ctx.beginPath();
    ctx.arc(0, wobble + 10, player.radius - 6, 0, Math.PI);
    ctx.fill();

    // Arms
    ctx.save();
    ctx.rotate(player.armAngle);
    ctx.fillStyle = '#d4a574';
    ctx.beginPath();
    ctx.ellipse(-player.radius + 8, wobble, 10, 16, -0.4, 0, Math.PI * 2);
    ctx.fill();
    ctx.restore();

    ctx.save();
    ctx.rotate(-player.armAngle);
    ctx.fillStyle = '#d4a574';
    ctx.beginPath();
    ctx.ellipse(player.radius - 8, wobble, 10, 16, 0.4, 0, Math.PI * 2);
    ctx.fill();
    ctx.restore();

    // Ears
    ctx.fillStyle = '#d4a574';
    ctx.beginPath();
    ctx.arc(-player.radius + 10, wobble - player.radius + 10, 12, 0, Math.PI * 2);
    ctx.arc(player.radius - 10, wobble - player.radius + 10, 12, 0, Math.PI * 2);
    ctx.fill();

    // Face details
    ctx.fillStyle = '#1a1a1a';
    ctx.beginPath();
    ctx.arc(-10, wobble - 8, 3.5, 0, Math.PI * 2);
    ctx.arc(10, wobble - 8, 3.5, 0, Math.PI * 2);
    ctx.fill();

    ctx.fillStyle = '#fff';
    ctx.beginPath();
    ctx.arc(-9, wobble - 9, 1.8, 0, Math.PI * 2);
    ctx.arc(11, wobble - 9, 1.8, 0, Math.PI * 2);
    ctx.fill();

    // Nose
    ctx.fillStyle = '#1a1a1a';
    ctx.beginPath();
    ctx.arc(0, wobble + 3, 5, 0, Math.PI * 2);
    ctx.fill();

    // Smile
    ctx.strokeStyle = '#1a1a1a';
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.arc(0, wobble + 8, 8, 0.2, Math.PI - 0.2);
    ctx.stroke();

    ctx.restore();
  }

  function drawHoneyPot(h) {
    ctx.save();
    ctx.translate(h.x, h.y);
    ctx.rotate(h.rotation);
    ctx.scale(h.scale, h.scale);
    
    const wobbleX = Math.sin(h.wobble) * 3;
    
    // Pot
    const potGradient = ctx.createLinearGradient(-15, -12, 15, 15);
    potGradient.addColorStop(0, h.type === 'golden' ? '#ffd700' : '#a0633b');
    potGradient.addColorStop(0.5, h.type === 'golden' ? '#ffa500' : '#8b4513');
    potGradient.addColorStop(1, h.type === 'golden' ? '#da9100' : '#6b3410');
    ctx.fillStyle = potGradient;
    
    ctx.beginPath();
    ctx.moveTo(-12, -10);
    ctx.quadraticCurveTo(-15, 0, -12, 15);
    ctx.lineTo(12, 15);
    ctx.quadraticCurveTo(15, 0, 12, -10);
    ctx.closePath();
    ctx.fill();

    // Honey
    const honeyGradient = ctx.createLinearGradient(-8, -8, 8, 8);
    honeyGradient.addColorStop(0, '#ffd700');
    honeyGradient.addColorStop(0.5, '#ffa500');
    honeyGradient.addColorStop(1, '#da9100');
    ctx.fillStyle = honeyGradient;
    
    ctx.beginPath();
    ctx.ellipse(0, 2, 8, 6, 0, 0, Math.PI * 2);
    ctx.fill();

    // Drip effect
    ctx.fillStyle = '#ffa500';
    ctx.beginPath();
    ctx.moveTo(-2, 8);
    ctx.quadraticCurveTo(0, 15, 2, 8);
    ctx.fill();

    // Label
    ctx.fillStyle = h.type === 'golden' ? '#fff' : '#fff8e1';
    ctx.font = 'bold 10px "Patrick Hand"';
    ctx.textAlign = 'center';
    ctx.fillText(h.type === 'golden' ? 'GOLDEN' : 'HUNNY', 0, 4);

    ctx.restore();
  }

  function drawBee(b) {
    ctx.save();
    ctx.translate(b.x, b.y);
    
    const wobbleY = Math.sin(b.wobble) * 6;
    const wingFlap = Math.sin(b.wingFlap) * 0.5;
    
    // Trail
    for (let i = 0; i < b.trail.length; i++) {
      const point = b.trail[i];
      const alpha = (b.trail.length - i) / b.trail.length * 0.2;
      ctx.fillStyle = `rgba(255, 215, 0, ${alpha})`;
      ctx.beginPath();
      ctx.arc(point.x - b.x, point.y - b.y, 4 * (i / b.trail.length), 0, Math.PI * 2);
      ctx.fill();
    }

    // Wings
    ctx.globalAlpha = 0.6;
    ctx.fillStyle = b.angry ? '#ff9999' : '#e8f4f8';
    ctx.save();
    ctx.rotate(wingFlap);
    ctx.beginPath();
    ctx.ellipse(-12, -10, 12, 20, -0.5, 0, Math.PI * 2);
    ctx.fill();
    ctx.restore();
    
    ctx.save();
    ctx.rotate(-wingFlap);
    ctx.beginPath();
    ctx.ellipse(12, -10, 12, 20, 0.5, 0, Math.PI * 2);
    ctx.fill();
    ctx.restore();
    ctx.globalAlpha = 1;

    // Body
    const beeGradient = ctx.createLinearGradient(0, -15, 0, 15);
    beeGradient.addColorStop(0, '#ffd700');
    beeGradient.addColorStop(1, b.angry ? '#ff4444' : '#daa520');
    ctx.fillStyle = beeGradient;
    ctx.beginPath();
    ctx.ellipse(0, wobbleY, 15, 20, 0, 0, Math.PI * 2);
    ctx.fill();

    // Stripes
    ctx.fillStyle = b.angry ? '#8b0000' : '#1a1a1a';
    for (let i = 0; i < 3; i++) {
      ctx.fillRect(-15, -12 + i * 10 + wobbleY, 30, 5);
    }

    // Angry eyebrows
    if (b.angry) {
      ctx.strokeStyle = '#8b0000';
      ctx.lineWidth = 3;
      ctx.lineCap = 'round';
      ctx.beginPath();
      ctx.moveTo(-8, -18 + wobbleY);
      ctx.lineTo(-2, -15 + wobbleY);
      ctx.moveTo(8, -18 + wobbleY);
      ctx.lineTo(2, -15 + wobbleY);
      ctx.stroke();
    }

    ctx.restore();
  }

  function drawParticles() {
    for (const p of particles) {
      ctx.save();
      ctx.globalAlpha = p.life;
      ctx.translate(p.x, p.y);
      ctx.rotate(p.rotation);
      
      ctx.fillStyle = p.color;
      
      switch (p.type) {
        case 'star':
          ctx.beginPath();
          for (let i = 0; i < 5; i++) {
            const angle = (i * 4 * Math.PI) / 5;
            const r = i % 2 === 0 ? p.size : p.size / 2;
            const px = Math.cos(angle) * r;
            const py = Math.sin(angle) * r;
            if (i === 0) ctx.moveTo(px, py);
            else ctx.lineTo(px, py);
          }
          ctx.closePath();
          ctx.fill();
          break;
          
        case 'heart':
          ctx.beginPath();
          const s = p.size;
          ctx.moveTo(0, s/4);
          ctx.bezierCurveTo(-s, -s/2, -s/2, -s, 0, 0);
          ctx.bezierCurveTo(s/2, -s, s, -s/2, 0, s/4);
          ctx.fill();
          break;
          
        case 'honey':
          ctx.beginPath();
          ctx.ellipse(0, 0, p.size, p.size * 0.7, 0, 0, Math.PI * 2);
          ctx.fill();
          break;
          
        default: // circle
          ctx.beginPath();
          ctx.arc(0, 0, p.size * p.life, 0, Math.PI * 2);
          ctx.fill();
      }
      
      ctx.restore();
    }
    ctx.globalAlpha = 1;
  }

  function drawUI() {
    // Lives display
    for (let i = 0; i < lives; i++) {
      const x = 30 + i * 40;
      const y = canvas.height - 30;
      
      ctx.save();
      ctx.translate(x, y);
      
      // Heart glow
      const heartGradient = ctx.createRadialGradient(0, 0, 0, 0, 0, 15);
      heartGradient.addColorStop(0, '#ff6b6b');
      heartGradient.addColorStop(1, 'rgba(255, 107, 107, 0)');
      ctx.fillStyle = heartGradient;
      ctx.beginPath();
      ctx.arc(0, 0, 15, 0, Math.PI * 2);
      ctx.fill();
      
      // Heart
      ctx.fillStyle = '#e63946';
      ctx.beginPath();
      ctx.moveTo(0, 6);
      ctx.bezierCurveTo(-10, -8, -5, -12, 0, -4);
      ctx.bezierCurveTo(5, -12, 10, -8, 0, 6);
      ctx.fill();
      
      ctx.restore();
    }
  }

  /* ===============================
     UI UPDATES
  ================================ */
  function updateHUD() {
    scoreEl.textContent = score;
    streakEl.textContent = streak;
    livesEl.textContent = lives;
    statusEl.textContent = `Score ${score}, streak ${streak}, lives ${lives}`;
  }

  function showScorePopup(x, y, text) {
    const popup = document.createElement('div');
    popup.className = 'score-popup';
    popup.textContent = text;
    popup.style.left = x + 'px';
    popup.style.top = y + 'px';
    gameContainer.appendChild(popup);
    
    setTimeout(() => popup.remove(), 1500);
  }

  function showHoneyWord(x, y, text) {
    const word = document.createElement('div');
    word.className = 'honey-word';
    word.textContent = text;
    word.style.left = x + 'px';
    word.style.top = y + 'px';
    gameContainer.appendChild(word);
    
    setTimeout(() => word.remove(), 2500);
  }

  function shakeScreen() {
    gameContainer.style.animation = 'none';
    setTimeout(() => {
      gameContainer.style.animation = 'shake 0.5s ease-in-out, float 6s ease-in-out infinite';
    }, 10);
  }

  /* ===============================
     GAME STATE MANAGEMENT
  ================================ */
  function startGame() {
    startOverlay.classList.add('hidden');
    gameoverOverlay.classList.add('hidden');
    running = true;
    paused = false;
    score = 0;
    streak = 0;
    bestStreak = 0;
    honeyCaught = 0;
    lives = 3;
    timePlayed = 0;
    startTime = Date.now();
    honeys.length = 0;
    bees.length = 0;
    particles.length = 0;
    player.trail.length = 0;
    spawnTimer = 0;
    beeSpawnTimer = 0;
    player.x = canvas.width / 2;
    player.wobble = 0;
    targetX = player.x;
    updateHUD();
    lastTime = performance.now();
    requestAnimationFrame(loop);
  }

  function togglePause() {
    if (!running) return;
    paused = !paused;
    pauseOverlay.classList.toggle('hidden', !paused);
    showCursor(!paused && running);
  }

  function endGame() {
    running = false;
    showCursor(false);
    
    // Update high score
    if (score > highScore) {
      highScore = score;
      localStorage.setItem('poohHighScore', highScore.toString());
    }
    
    // Update final stats
    document.getElementById('final-score').textContent = score;
    document.getElementById('best-streak').textContent = bestStreak;
    document.getElementById('honey-caught').textContent = honeyCaught;
    document.getElementById('time-played').textContent = `${Math.round(timePlayed)}s`;
    document.getElementById('high-score').textContent = highScore;
    
    gameoverOverlay.classList.remove('hidden');
  }

  /* ===============================
     EVENT LISTENERS
  ================================ */
  startBtn.addEventListener('click', startGame);
  resumeBtn.addEventListener('click', togglePause);
  restartBtn.addEventListener('click', startGame);

  /* ===============================
     INITIALIZATION
  ================================ */
  createBlossoms();
  updateHUD();

  // Add some initial clouds
  for (let i = 0; i < 4; i++) {
    const cloud = document.createElement('div');
    cloud.className = `cloud cloud-${(i % 3) + 1}`;
    cloud.style.top = `${10 + Math.random() * 40}%`;
    cloud.style.left = `${Math.random() * 20 - 20}%`;
    cloud.style.animationDelay = `${Math.random() * 20}s`;
    backgroundLayer.appendChild(cloud);
  }

})();
</script>
</body>
</html>