<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0, viewport-fit=cover" name="viewport">
    <title>Baby Gunnar's Hundred Acre Wood Adventure</title>
    <meta content="A storybook-style Hundred Acre Wood adventure with a honey-catching game to celebrate Baby Gunnar."
          name="description">
    <meta content="#f4a944" name="theme-color">
    <meta content="light dark" name="color-scheme">
    <meta content="Baby Gunnar's Hundred Acre Wood Shower" property="og:title">
    <meta content="A sweet storybook and honey-catching game‚Äîread, play, and leave your wishes."
          property="og:description">
    <meta content="icons/icon.svg" property="og:image">
    <meta content="website" property="og:type">
    <!-- Font Awesome for game icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <link as="image" href="Images/Characters/Gunnar.png" rel="preload">

    <link rel="stylesheet" href="styles.css">


<!-- inline styles moved to styles.merged.css -->
</head>
<body>
<!-- Decorative Elements -->
<div aria-hidden="true" class="enhanced-scene" id="enhancedScene"></div>
<div aria-hidden="true" class="cloud-layer">
    <div class="cloud">‚òÅÔ∏è</div>
    <div class="cloud">‚òÅÔ∏è</div>
    <div class="cloud">‚òÅÔ∏è</div>
</div>

<!-- Settings Panel -->
<div class="settings-panel">
    <button class="settings-button" id="settingsButton" aria-label="Open settings">
        ‚öôÔ∏è
    </button>
</div>

<div class="settings-overlay" id="settingsOverlay">
    <div class="settings-card">
        <div class="settings-header">
            <h2>Game Settings</h2>
            <button class="close-settings" id="closeSettings" aria-label="Close settings">√ó</button>
        </div>

        <!-- Game Difficulty -->
        <section class="settings-section">
            <h3><span class="icon">üéÆ</span> Game Difficulty</h3>
            <div class="setting-option">
                <div class="setting-label">
                    <span>Difficulty Level</span>
                    <small>Adjusts jar speed, bee frequency, and time limit</small>
                </div>
                <select class="setting-select" id="difficultySelect">
                    <option value="easy">Easy</option>
                    <option value="medium" selected>Medium</option>
                    <option value="hard">Hard</option>
                    <option value="expert">Expert</option>
                </select>
            </div>
        </section>

        <!-- Sound & Music -->
        <section class="settings-section">
            <h3><span class="icon">üîä</span> Sound & Music</h3>
            <div class="setting-option">
                <div class="setting-label">
                    <span>Background Music</span>
                    <small>Play soothing Hundred Acre Wood music</small>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="musicToggle" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-option">
                <div class="setting-label">
                    <span>Sound Effects</span>
                    <small>Honey catches, bee buzzes, and game sounds</small>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="sfxToggle" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-option">
                <div class="setting-label">
                    <span>Volume Level</span>
                    <small>Adjust overall volume</small>
                </div>
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <input type="range" class="setting-range" id="volumeSlider" min="0" max="100" value="80">
                    <span class="setting-range-value" id="volumeValue">80%</span>
                </div>
            </div>
        </section>

        <!-- Visual Theme -->
        <section class="settings-section">
            <h3><span class="icon">üé®</span> Visual Theme</h3>
            <div class="theme-options">
                <div class="theme-option active" data-theme="light">
                    <span class="icon">‚òÄÔ∏è</span>
                    <span class="name">Light</span>
                </div>
                <div class="theme-option" data-theme="dark">
                    <span class="icon">üåô</span>
                    <span class="name">Dark</span>
                </div>
                <div class="theme-option" data-theme="auto">
                    <span class="icon">‚öôÔ∏è</span>
                    <span class="name">Auto</span>
                </div>
            </div>
        </section>

        <!-- Game Visuals -->
        <section class="settings-section">
            <h3><span class="icon">‚ú®</span> Visual Effects</h3>
            <div class="setting-option">
                <div class="setting-label">
                    <span>Particle Effects</span>
                    <small>Show honey sparkles and catch effects</small>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="particlesToggle" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-option">
                <div class="setting-label">
                    <span>Animations</span>
                    <small>Page transitions and character animations</small>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="animationsToggle" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-option">
                <div class="setting-label">
                    <span>Control Sensitivity</span>
                    <small>Adjust bear movement speed</small>
                </div>
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <input type="range" class="setting-range" id="sensitivitySlider" min="50" max="400" value="260" step="10">
                    <span class="setting-range-value" id="sensitivityValue">260</span>
                </div>
            </div>
        </section>

        <!-- Game Controls -->
        <section class="settings-section">
            <h3><span class="icon">üéØ</span> Game Controls</h3>
            <div class="setting-option">
                <div class="setting-label">
                    <span>Vibration (Mobile)</span>
                    <small>Haptic feedback on mobile devices</small>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="vibrationToggle">
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-option">
                <div class="setting-label">
                    <span>Show Mobile Controls</span>
                    <small>Display touch controls on mobile</small>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="mobileControlsToggle" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
        </section>

        <!-- Actions -->
        <div class="settings-actions">
            <button class="settings-btn secondary" id="resetSettingsBtn">
                <span>üîÅ</span> Reset to Defaults
            </button>
            <button class="settings-btn primary" id="applySettingsBtn">
                <span>üíæ</span> Apply Settings
            </button>
        </div>
    </div>
</div>

<!-- Hero Header -->
<header class="masthead-hero hero-enhancements">
    <!-- Hero Banner with Image and Title Overlay -->
    <div class="hero-banner">
        <div class="hero-image-container">
            <picture>
                <source sizes="80vw"
                        srcset="Images/Characters/Gunnar.png 800w, Images/Characters/Gunnar.png 1200w, Images/Characters/Gunnar.png 1600w">
                <img alt="Baby Gunnar with Hundred Acre Wood friends in the Hundred Acre Wood" class="hero-banner__img" height="900" loading="eager"
                     src="Images/Characters/Gunnar.png" width="800">
            </picture>
            <!-- Decorative corner elements -->
            <div aria-hidden="true" class="hero-corner-decoration top-left">üåø</div>
            <div aria-hidden="true" class="hero-corner-decoration top-right">üçØ</div>
            <div aria-hidden="true" class="hero-corner-decoration bottom-left">üíõ</div>
            <div aria-hidden="true" class="hero-corner-decoration bottom-right">üêù</div>
        </div>
        <!-- Title Container with Background -->
        <div class="hero-title-container">
            <div class="title-background">
                <h1 class="masthead-title">
                    <span class="title-line title-line--primary">Baby Gunnar's</span>
                    <span class="title-line title-line--secondary">Hundred Acre Wood Shower</span>
                </h1>
                <div aria-hidden="true" class="title-underline">
                    <span class="underline-dot">‚Ä¢</span>
                    <span class="underline-dot">‚Ä¢</span>
                    <span class="underline-dot">‚Ä¢</span>
                </div>
                <p class="hero-subtitle">A storybook celebration with Pooh & friends</p>
            </div>
        </div>
    </div>
    <!-- Decorative Elements -->
    <div aria-hidden="true" class="hero-sparkles" id="heroSparkles"></div>
    <div aria-hidden="true" class="hero-bunting">
        <span>‚ú®</span><span>üéà</span><span>üçØ</span><span>üíù</span><span>üß∏</span><span>üìñ</span><span>‚ú®</span>
    </div>
    <div aria-hidden="true" class="hero-sheen"></div>
    <!-- Hero Info Panel -->
    <div class="masthead-hero-inner">
        <section class="hero-panel">
            <!-- Event Badge -->
            <div class="hero-badge">
                <div aria-hidden="true" class="badge-icon">
                    <div class="badge-icon-inner">üéâ</div>
                </div>
                <div class="badge-copy">
                    <p class="badge-eyebrow">A Very Special</p>
                    <p class="badge-label">Hundred Acre Gathering</p>
                    <p class="badge-title">Virtual Baby Shower Celebration</p>
                </div>
                <div class="badge-meta">
                    <time class="badge-pill date" datetime="2025-06-15">
                        <span aria-hidden="true" class="pill-icon">üìÖ</span>
                        <span class="pill-text">June 15, 2025</span>
                    </time>
                    <div class="badge-pill location">
                        <span aria-hidden="true" class="pill-icon">üìç</span>
                        <span class="pill-text">Online Celebration</span>
                    </div>
                </div>
            </div>
            <!-- Hero Details Grid -->
            <div class="hero-details-grid">
                <div class="hero-detail">
                    <div aria-hidden="true" class="detail-icon">üìö</div>
                    <div class="detail-content">
                        <h4 class="detail-title">Interactive Storybook</h4>
                        <p class="detail-text">Read through four charming chapters</p>
                    </div>
                </div>
                <div class="hero-detail">
                    <div aria-hidden="true" class="detail-icon">üéÆ</div>
                    <div class="detail-content">
                        <h4 class="detail-title">Honey Game</h4>
                        <p class="detail-text">Help Pooh catch honey pots</p>
                    </div>
                </div>
                <div class="hero-detail">
                    <div aria-hidden="true" class="detail-icon">üéÅ</div>
                    <div class="detail-content">
                        <h4 class="detail-title">Gift Registry</h4>
                        <p class="detail-text">Share your wishes & blessings</p>
                    </div>
                </div>
            </div>
            <!-- Quick Actions -->
            <div class="hero-actions">
                <button class="hero-action-btn primary" onclick="scrollToChapter(1)">
                    <span aria-hidden="true" class="btn-icon">üìñ</span>
                    <span class="btn-text">Begin the Story</span>
                </button>
                <button class="hero-action-btn secondary" onclick="scrollToChapter(2)">
                    <span aria-hidden="true" class="btn-icon">üçØ</span>
                    <span class="btn-text">Play Honey Game</span>
                </button>
                <button class="hero-action-btn ghost" onclick="scrollToChapter(3)">
                    <span aria-hidden="true" class="btn-icon">üíù</span>
                    <span class="btn-text">View Registry</span>
                </button>
            </div>
            <!-- Orientation Hint -->
            <div class="orientation-hint">
                <div aria-hidden="true" class="hint-icon">üì±</div>
                <p class="hint-text">For the best experience: Rotate for wider game view, or stay in portrait for lovely
                    story reading.</p>
            </div>
        </section>
    </div>
</header>
<!-- Main Content -->
<main class="book-container" id="storybook">
    <!-- Chapter Navigation -->
    <nav aria-label="Story chapters" class="chapter-tracker">
        <h2 class="sr-only">Chapter navigation</h2>
        <div class="tracker-row">
            <div class="tracker-label">Story path</div>
            <div aria-valuemax="100" aria-valuemin="0" aria-valuenow="0" class="book-progress" role="progressbar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>
        <div class="chapter-pill-row">
            <button aria-current="page" class="chapter-pill sparkle active" data-chapter-target="1">
                <span class="pill-number">1</span>
                <span class="pill-text">
               <span class="pill-title">Welcome</span>
               <span class="pill-detail">Invitation arrives</span>
               </span>
            </button>
            <button class="chapter-pill sparkle" data-chapter-target="2">
                <span class="pill-number">2</span>
                <span class="pill-text">
               <span class="pill-title">Honey Hunt</span>
               <span class="pill-detail">Play the game</span>
               </span>
            </button>
            <button class="chapter-pill sparkle" data-chapter-target="3">
                <span class="pill-number">3</span>
                <span class="pill-text">
               <span class="pill-title">Gifts & Wishes</span>
               <span class="pill-detail">Registry & guestbook</span>
               </span>
            </button>
            <button class="chapter-pill sparkle" data-chapter-target="4">
                <span class="pill-number">4</span>
                <span class="pill-text">
               <span class="pill-title">Celebration</span>
               <span class="pill-detail">Welcome Gunnar</span>
               </span>
            </button>
        </div>
    </nav>
    <!-- Story Pages -->
    <div class="book">
        <div class="pages-wrapper">
            <!-- Chapter 1 -->
            <article class="page active" data-chapter="1">
                <header class="chapter-header">
                    <p class="chapter-number">Chapter One</p>
                    <h2 class="chapter-title">A Special Day in the Hundred Acre Wood</h2>
                    <p class="chapter-subtitle">An Invitation to Celebrate</p>
                    <span aria-hidden="true" class="honey-drip"></span>
                </header>
                <div class="page-content">
                    <p class="story-text">One fine spring day, in a corner of the Hundred Acre Wood where the sun shines
                        warmly through the trees and the flowers bloom in cheerful colors, something wonderful was
                        happening. All the forest friends were gathering, for there was to be a celebration unlike any
                        other.</p>
                    <p class="story-text">"What sort of celebration?" you might ask. Well, it was the very best sort‚Äîthe
                        kind that welcomes a new little friend to the world. A baby boy named Gunnar James was soon to
                        arrive, and everyone in the Hundred Acre Wood wanted to share in the joy.</p>
                    <div class="chapter-illustrations">
                        <figure class="storybook-figure figure-theme-honey clickable-character" data-character="pooh">
                            <img alt="Winnie the Pooh holding a honey pot" height="96"
                                 loading="eager" src="Images/Characters/honey-bear.png" width="96">
                            <figcaption class="figure-copy">
                                <div class="figure-name">Pooh brings the first pot</div>
                                <p class="figure-note">"A baby celebration needs extra honey," he whispered as he dusted
                                    off the lid.</p>
                            </figcaption>
                            <div aria-live="polite" class="character-message"></div>
                        </figure>
                        <figure class="storybook-figure figure-theme-sky clickable-character" data-character="piglet">
                            <img alt="Piglet carrying a welcome banner" height="96" loading="eager"
                                 src="Images/Characters/piglet.png" width="96">
                            <figcaption class="figure-copy">
                                <div class="figure-name">Piglet pins up the banner</div>
                                <p class="figure-note">He fluttered through the clearing making sure every friend felt
                                    warmly invited.</p>
                            </figcaption>
                            <div aria-live="polite" class="character-message"></div>
                        </figure>
                    </div>
                    <p class="story-text">Winnie the Pooh, being a Bear of Very Little Brain but a Very Big Heart, knew
                        that the most important thing for any celebration was honey. And not just a little honey, but
                        lots and lots of it. After all, welcoming Baby Gunnar was a Very Important Matter.</p>
                    <p class="story-text">"But first," thought Pooh, looking up at his honey pots on the high shelf,
                        "we'll need to gather more honey. Won't you help?"</p>
                    <div aria-hidden="true" class="divider">üå≥ ‚úø üêù ‚úø üå≥</div>
                </div>
            </article>
            <!-- Chapter 2: Game -->
            <article class="page page--game" data-chapter="2" id="honey-game">
                <header class="chapter-header">
                    <p class="chapter-number">Chapter Two</p>
                    <h2 class="chapter-title">Pooh's Honey Gathering Adventure</h2>
                    <p class="chapter-subtitle">A Game of Skill and Sweetness</p>
                    <span aria-hidden="true" class="honey-drip"></span>
                </header>
                <div class="chapter-illustrations">
                    <figure class="storybook-figure figure-theme-forest clickable-character" data-character="tigger">
                        <img alt="Tigger bouncing" height="96" loading="lazy" src="Images/Characters/tigger.png"
                             width="96">
                        <figcaption class="figure-copy">
                            <div class="figure-name">Tigger stakes out the course</div>
                            <p class="figure-note">He marked the path with springy footprints so every honey pot feels
                                like an adventure to catch.</p>
                        </figcaption>
                        <div aria-live="polite" class="character-message"></div>
                    </figure>
                    <figure class="storybook-figure figure-theme-honey clickable-character" data-character="roo">
                        <img alt="Roo cheering" height="96" loading="lazy" src="Images/Characters/roo.png" width="96">
                        <figcaption class="figure-copy">
                            <div class="figure-name">Roo cheers from the sidelines</div>
                            <p class="figure-note">"Mind the bees!" he giggled, handing out cozy scarves.</p>
                        </figcaption>
                        <div aria-live="polite" class="character-message"></div>
                    </figure>
                </div>
                <div class="page-content">
                    <div class="game-embed__frame">
                        <iframe
                                src="game.html"
                                title="Honey Hunt ‚Äî Baby Gunnar‚Äôs Hundred Acre Wood"
                                loading="lazy"
                                class="game-frame"
                        ></iframe>
                    </div>
                    <p class="story-text">Help Pooh gather sweet honey by playing the Honey Hunt game below. Launch the
                        adventure to catch jars, dodge bees, and send your best score to the Hundred Acre Wood crew!</p>
                </div>
            </article>
            <!-- Chapter 3: Gifts & Wishes -->
            <article class="page" data-chapter="3">
                <header class="chapter-header">
                    <p class="chapter-number">Chapter Three</p>
                    <h2 class="chapter-title">Gifts from the Heart</h2>
                    <p class="chapter-subtitle">Preparing for Baby Gunnar's Arrival</p>
                    <span aria-hidden="true" class="honey-drip"></span>
                </header>
                <div class="page-content">
                    <section class="story-section">
                        <p class="story-text">Back in the Hundred Acre Wood, Pooh sat thoughtfully by his honey pots.
                            "Honey is wonderful," he mused, "but I wonder what else a growing bear‚Äîoh, I mean baby‚Äîmight
                            need?"</p>
                        <p class="story-text">Just then, Piglet came scurrying up, holding something soft. "I was
                            thinking, Pooh," he said in his small voice, "perhaps something cozy for chilly
                            evenings?"</p>
                        <div class="dialogue-bubble dialogue-piglet">
                            <div class="bubble-arrow"></div>
                            <p>"Something soft and warm, for when the wind howls!"</p>
                            <span class="speaker">‚Äî Piglet</span>
                        </div>
                    </section>
                    <div class="chapter-illustrations">
                        <figure class="storybook-figure figure-theme-forest clickable-character"
                                data-character="piglet">
                            <img alt="Piglet with blanket" height="96" loading="lazy" src="Images/Characters/piglet.png"
                                 width="96">
                            <figcaption class="figure-copy">
                                <div class="figure-name">Piglet's Cozy Corner</div>
                                <p class="figure-note">Found the snuggliest blanket in all the Wood.</p>
                            </figcaption>
                            <div aria-live="polite" class="character-message"></div>
                        </figure>
                        <figure class="storybook-figure figure-theme-honey clickable-character" data-character="pooh">
                            <img alt="Pooh thinking" height="96" loading="lazy" src="Images/Characters/honey-bear.png"
                                 width="96">
                            <figcaption class="figure-copy">
                                <div class="figure-name">Pooh's Pondering</div>
                                <p class="figure-note">Thinking of practical things (between honey snacks).</p>
                            </figcaption>
                            <div aria-live="polite" class="character-message"></div>
                        </figure>
                        <figure class="storybook-figure figure-theme-sky clickable-character" data-character="tigger">
                            <img alt="Tigger bouncing" height="96" loading="lazy" src="Images/Characters/tigger.png"
                                 width="96">
                            <figcaption class="figure-copy">
                                <div class="figure-name">Tigger's Toys</div>
                                <p class="figure-note">Bounced in with the bounciest ideas!</p>
                            </figcaption>
                            <div aria-live="polite" class="character-message"></div>
                        </figure>
                    </div>
                    <section class="story-section">
                        <p class="story-text">Soon, all the friends had gathered with their ideas. Tigger bounced about
                            toys that bounce, Eeyore suggested "something useful that won't blow away," and Rabbit began
                            making a very organized list.</p>
                        <div class="dialogue-bubble dialogue-pooh">
                            <div class="bubble-arrow"></div>
                            <p>"The most important thing," said Pooh wisely, "is that Baby Gunnar knows he is surrounded
                                by love. But if you'd like to bring something special, his parents have shared a few
                                ideas that would be helpful."</p>
                            <span class="speaker">‚Äî Pooh Bear</span>
                        </div>
                    </section>
                    <div class="registry-container">
                        <aside class="registry-section">
                            <div class="registry-header">
                                <div aria-hidden="true" class="registry-icon">üéÅ</div>
                                <div>
                                    <h3>Baby Gunnar's Registry</h3>
                                    <p class="registry-subtitle">Your presence is the greatest present, but if you'd
                                        like to contribute to his woodland adventures:</p>
                                </div>
                            </div>
                            <div class="registry-grid">
                                <a class="registry-card" href="https://my.babylist.com/lea-hardesty" rel="noopener"
                                   target="_blank">
                                    <div class="card-icon">üéØ</div>
                                    <div class="card-content">
                                        <h4>babylist Registry</h4>
                                        <p>For everyday essentials and nursery items</p>
                                        <span class="card-link">Browse registry ‚Üí</span>
                                    </div>
                                </a>
                                <div class="registry-card gift-idea-card">
                                    <div class="card-icon">üíù</div>
                                    <div class="card-content">
                                        <h4>Gift Ideas</h4>
                                        <ul class="gift-ideas">
                                            <li>Board books & stories</li>
                                            <li>Woodland-themed clothing</li>
                                            <li>Soft blankets & swaddles</li>
                                            <li>Diapers & essentials</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </aside>
                    </div>
                    <section class="nursery-details">
                        <h3><span aria-hidden="true">üß∏</span> Nursery Details</h3>
                        <div class="details-grid">
                            <div class="detail-card">
                                <div class="detail-icon">üé®</div>
                                <div class="detail-content">
                                    <h4>Theme</h4>
                                    <p>Hundred Acre Wood Adventures</p>
                                    <small>Featuring Winnie the Pooh & friends</small>
                                </div>
                            </div>
                            <div class="detail-card">
                                <div class="detail-icon">üåà</div>
                                <div class="detail-content">
                                    <h4>Colors</h4>
                                    <p>Honey gold, Pooh red, sage green, cream</p>
                                    <small>Soft & soothing woodland palette</small>
                                </div>
                            </div>
                            <div class="detail-card">
                                <div class="detail-icon">üìö</div>
                                <div class="detail-content">
                                    <h4>Favorite Items</h4>
                                    <p>Swaddles, sleepers, board books, cozy blankets</p>
                                </div>
                            </div>
                            <div class="detail-card">
                                <div class="detail-icon">üìç</div>
                                <div class="detail-content">
                                    <h4>Location</h4>
                                    <p>Arizona</p>
                                    <small>Where adventures begin</small>
                                </div>
                            </div>
                        </div>
                    </section>
                    <section class="wishes-section">
                        <div class="wishes-header">
                            <h3>Share Your Wishes <span aria-hidden="true">‚ú®</span></h3>
                            <p>Leave wisdom, well-wishes, or favorite childhood memories for Gunnar's storybook</p>
                        </div>
                        <div class="wishes-form-container">
                            <form class="enhanced-form" id="wishesForm">
                                <div class="form-grid">
                                    <div class="form-field">
                                        <label for="guestName">Your Name</label>
                                        <input id="guestName" placeholder="How should we call you?" required
                                               type="text">
                                    </div>
                                    <div class="form-field">
                                        <label for="guestRelation">Your Relation</label>
                                        <select id="guestRelation">
                                            <option value="">Choose one...</option>
                                            <option value="family">Family</option>
                                            <option value="friend">Friend</option>
                                            <option value="colleague">Colleague</option>
                                            <option value="woodland-friend">Woodland Friend</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-field">
                                    <label for="wishMessage">Your Message</label>
                                    <textarea id="wishMessage" placeholder="What wisdom or wishes would you like to share with Baby Gunnar?..."
                                              required
                                              rows="4"></textarea>
                                    <div class="character-count">0/500 characters</div>
                                </div>
                                <div class="form-actions">
                                    <button class="submit-btn" type="submit">
                                        <span aria-hidden="true">üìù</span> Add to Gunnar's Storybook
                                    </button>
                                    <div aria-live="polite" class="form-feedback" id="wishFeedback" role="status"></div>
                                </div>
                            </form>
                        </div>
                        <div class="sample-wishes">
                            <h4>Wishes from the Wood:</h4>
                            <div class="wish-examples">
                                <blockquote class="wish-example">
                                    <p>"May your days be filled with wonder and your nights with sweet dreams."</p>
                                    <cite>‚Äî Owl</cite>
                                </blockquote>
                                <blockquote class="wish-example">
                                    <p>"Remember: even the smallest creatures can have the biggest hearts."</p>
                                    <cite>‚Äî Piglet</cite>
                                </blockquote>
                            </div>
                        </div>
                    </section>
                    <div class="wishes-display" id="wishesDisplay">
                        <!-- Dynamic wishes will appear here -->
                    </div>
                </div>
            </article>
            <!-- Chapter 4: Celebration -->
            <article class="page" data-chapter="4">
                <header class="chapter-header">
                    <p class="chapter-number">Chapter Four</p>
                    <h2 class="chapter-title">The Gathering</h2>
                    <p class="chapter-subtitle">Celebrating What's to Come</p>
                    <span aria-hidden="true" class="honey-drip"></span>
                </header>
                <div class="page-content">
                    <p class="story-text">As the sun began to set over the Hundred Acre Wood, casting long golden
                        shadows through the trees, Pooh and his friends gathered to celebrate the coming arrival of Baby
                        Gunnar.</p>
                    <div class="chapter-illustrations">
                        <figure class="storybook-figure figure-theme-honey clickable-character" data-character="pooh">
                            <img alt="Pooh with honey pot" height="96" loading="lazy" src="Images/Characters/honey-bear.png"
                                 width="96">
                            <figcaption class="figure-copy">
                                <div class="figure-name">Pooh's special pot</div>
                                <p class="figure-note">He saved one golden pot for Gunnar's first visit.</p>
                            </figcaption>
                            <div aria-live="polite" class="character-message"></div>
                        </figure>
                        <figure class="storybook-figure figure-theme-sky clickable-character" data-character="gunnar">
                            <img alt="Baby Gunnar" height="96" loading="lazy" src="Images/Characters/Gunnar.png"
                                 width="96">
                            <figcaption class="figure-copy">
                                <div class="figure-name">Coming Soon</div>
                                <p class="figure-note">The Hundred Acre Wood awaits its newest friend.</p>
                            </figcaption>
                            <div aria-live="polite" class="character-message"></div>
                        </figure>
                    </div>
                    <p class="story-text">With honey gathered, gifts prepared, and wishes shared, everyone in the
                        Hundred Acre Wood looked forward to the day they would meet Baby Gunnar. For as Pooh always
                        said, "How lucky I am to have something to look forward to."</p>
                    <div class="welcome-panel">
                        <div aria-hidden="true" class="welcome-icon">üåü</div>
                        <h3 class="welcome-heading">We Can't Wait to Meet You!</h3>
                        <p class="welcome-subtitle">Baby Gunnar, your adventure in the Hundred Acre Wood is about to
                            begin</p>
                    </div>
                    <section class="countdown-section">
                        <h3>Until We Meet üêª</h3>
                        <div class="countdown-display">
                            <div class="countdown-item">
                                <span class="countdown-number" id="days">--</span>
                                <span class="countdown-label">Days</span>
                            </div>
                            <div class="countdown-item">
                                <span class="countdown-number" id="hours">--</span>
                                <span class="countdown-label">Hours</span>
                            </div>
                        </div>
                        <p class="countdown-note">Expected arrival:
                            <time datetime="2025-08">Late August 2025</time>
                        </p>
                    </section>
                    <div class="honey-jar-interactive">
                        <div aria-hidden="true">üçØ</div>
                        <h3>Gunnar's Honey Jar of Hopes</h3>
                        <p>Share your hopes and dreams for Baby Gunnar's future adventures.</p>
                        <button class="btn primary" id="addHopeBtn">‚ûï Add Your Hope</button>
                    </div>
                    <aside class="final-thought">
                        <blockquote>
                            <p>"Sometimes the smallest things take up the most room in your heart."<br>
                                <cite>‚Äî Winnie the Pooh</cite>
                            </p>
                        </blockquote>
                        <p class="signature">With love from all your friends in the Hundred Acre Wood</p>
                    </aside>
                </div>
            </article>
        </div>
        <!-- Navigation -->
        <nav aria-label="Page navigation" class="chapter-nav">
            <button class="chapter-nav-btn" id="prevBtn">‚Üê Previous</button>
            <div class="chapter-indicator" id="pageIndicator">Chapter 1 of 4</div>
            <button class="chapter-nav-btn next" id="nextBtn">Next ‚Üí</button>
        </nav>
    </div>
</main>
<!-- Footer -->
<footer class="site-footer">
    <p>Made with üíô and üçØ for Baby Gunnar's special day</p>
    <div class="footer-links">
        <button class="footer-link" id="printPageBtn">üñ® Print</button>
        <button class="footer-link" id="sharePageBtn">üì§ Share</button>
        <button class="footer-link" id="toggleAnimationsBtn">üé≠ Animations</button>
    </div>
</footer>

<!-- Game Script -->
<script>
    // Honey Hunt Game - Simplified Version
    (function() {
        "use strict";

        // Game variables
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const gameContainer = document.getElementById('gameInlineContainer');
        const gameStartOverlay = document.getElementById('gameStartOverlay');
        const gameStartButton = document.getElementById('gameStartButton');
        const gameHUD = document.getElementById('gameHUD');
        const gamePauseOverlay = document.getElementById('gamePauseOverlay');
        const gameOverOverlay = document.getElementById('gameOverOverlay');
        const gameResumeButton = document.getElementById('gameResumeButton');
        const gameRestartButton = document.getElementById('gameRestartButton');
        const mobileControls = document.getElementById('mobileControls');
        const mobileLeftBtn = document.getElementById('mobileLeftBtn');
        const mobileRightBtn = document.getElementById('mobileRightBtn');
        const mobilePauseBtn = document.getElementById('mobilePauseBtn');

        // Game state
        let gameState = {
            running: false,
            paused: false,
            timeLeft: 60,
            score: 0,
            best: localStorage.getItem('honeyHuntBest') || 0,
            streak: 0,
            lives: 3,
            shieldTime: 0
        };

        // Game objects
        const bear = {
            x: 0,
            y: 0,
            width: 40,
            height: 60,
            speed: 260,
            vx: 0
        };

        const jars = [];
        const bees = [];
        const particles = [];

        // Control keys
        const keys = {
            left: false,
            right: false
        };

        // Initialize game
        function initGame() {
            // Set canvas size
            resizeCanvas();

            // Initialize bear position
            bear.x = canvas.width / 2;
            bear.y = canvas.height * 0.85;

            // Apply sensitivity from settings
            if (window.getGameSettings) {
                const settings = window.getGameSettings();
                bear.speed = settings.sensitivity || 260;
            }

            // Clear arrays
            jars.length = 0;
            bees.length = 0;
            particles.length = 0;

            // Reset game state with difficulty settings
            const difficulty = window.gameDifficulty || {
                timeLimit: 60,
                lives: 3
            };

            gameState.timeLeft = difficulty.timeLimit || 60;
            gameState.score = 0;
            gameState.streak = 0;
            gameState.lives = difficulty.lives || 3;
            gameState.shieldTime = 0;

            // Update HUD
            updateHUD();

            // Show start overlay
            gameStartOverlay.classList.remove('hidden');
            gameHUD.classList.remove('visible');
            mobileControls.classList.remove('visible');
            gamePauseOverlay.classList.remove('visible');
            gameOverOverlay.classList.remove('visible');

            // Show mobile controls based on settings
            if (window.getGameSettings) {
                const settings = window.getGameSettings();
                if (settings.mobileControls && ('ontouchstart' in window || navigator.maxTouchPoints > 0)) {
                    mobileControls.classList.add('visible');
                }
            }
        }

        // Start game
        function startGame() {
            gameState.running = true;
            gameState.paused = false;
            gameStartOverlay.classList.add('hidden');
            gameHUD.classList.add('visible');
            gamePauseOverlay.classList.remove('visible');
            gameOverOverlay.classList.remove('visible');

            // Start game loop
            lastTimestamp = performance.now();
            requestAnimationFrame(gameLoop);
        }

        // Pause game
        function pauseGame() {
            if (!gameState.running) return;
            gameState.paused = true;
            gamePauseOverlay.classList.add('visible');
        }

        // Resume game
        function resumeGame() {
            if (!gameState.running) return;
            gameState.paused = false;
            gamePauseOverlay.classList.remove('visible');
            lastTimestamp = performance.now();
            requestAnimationFrame(gameLoop);
        }

        // End game
        function endGame() {
            gameState.running = false;

            // Update best score
            if (gameState.score > gameState.best) {
                gameState.best = gameState.score;
                localStorage.setItem('honeyHuntBest', gameState.best);
            }

            // Update final score display
            document.getElementById('finalGameScore').textContent = gameState.score;
            document.getElementById('finalGameBest').textContent = gameState.best;

            // Show game over overlay
            gameOverOverlay.classList.add('visible');
            gameHUD.classList.remove('visible');
        }

        // Resize canvas
        function resizeCanvas() {
            const rect = gameContainer.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = rect.height;
        }

        // Update HUD
        function updateHUD() {
            document.getElementById('gameScoreValue').textContent = gameState.score;
            document.getElementById('gameBestValue').textContent = gameState.best;
            document.getElementById('gameTimeValue').textContent = Math.max(0, Math.floor(gameState.timeLeft));
            document.getElementById('gameStreakValue').textContent = gameState.streak;

            // Update lives display
            const livesValue = document.getElementById('gameLivesValue');
            const full = "‚ô•".repeat(gameState.lives);
            const empty = "‚ô°".repeat(3 - gameState.lives);
            livesValue.textContent = full + empty;

            // Update streak badge
            const streakBadge = document.getElementById('gameStreakBadge');
            if (gameState.streak >= 5) {
                streakBadge.classList.add('visible');
            } else {
                streakBadge.classList.remove('visible');
            }
        }

        // Draw functions
        function drawBear() {
            ctx.save();
            ctx.translate(bear.x, bear.y);

            // Draw bear body
            ctx.fillStyle = '#fbbf24';
            ctx.beginPath();
            ctx.ellipse(0, -10, 25, 35, 0, 0, Math.PI * 2);
            ctx.fill();

            // Draw head
            ctx.fillStyle = '#fbbf24';
            ctx.beginPath();
            ctx.arc(0, -48, 20, 0, Math.PI * 2);
            ctx.fill();

            // Draw ears
            ctx.fillStyle = '#f59e0b';
            ctx.beginPath();
            ctx.arc(-12, -60, 8, 0, Math.PI * 2);
            ctx.arc(12, -60, 8, 0, Math.PI * 2);
            ctx.fill();

            // Draw face
            ctx.fillStyle = '#1f2937';
            ctx.beginPath();
            ctx.arc(-8, -52, 3, 0, Math.PI * 2);
            ctx.arc(8, -52, 3, 0, Math.PI * 2);
            ctx.fill();

            // Draw mouth (smile)
            ctx.strokeStyle = '#1f2937';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(0, -45, 6, 0.2, Math.PI - 0.2);
            ctx.stroke();

            // Draw honey jar
            ctx.fillStyle = '#b45309';
            ctx.fillRect(-20, 0, 40, 30);

            ctx.fillStyle = '#f59e0b';
            ctx.fillRect(-18, 2, 36, 26);

            ctx.restore();

            // Draw shield if active
            if (gameState.shieldTime > 0) {
                ctx.save();
                ctx.translate(bear.x, bear.y - 10);

                ctx.strokeStyle = '#38bdf8';
                ctx.lineWidth = 3;
                ctx.globalAlpha = 0.6;
                ctx.beginPath();
                ctx.arc(0, 0, 35, 0, Math.PI * 2);
                ctx.stroke();

                ctx.restore();
            }
        }

        function drawJar(x, y, type = 'normal') {
            ctx.save();
            ctx.translate(x, y);

            let color = '#fbbf24';
            if (type === 'gold') color = '#f59e0b';
            if (type === 'shield') color = '#38bdf8';

            // Jar body
            ctx.fillStyle = color;
            ctx.fillRect(-10, -20, 20, 40);

            // Jar lid
            ctx.fillStyle = '#92400e';
            ctx.fillRect(-12, -25, 24, 5);

            // Honey inside
            ctx.fillStyle = '#d97706';
            ctx.fillRect(-8, 0, 16, 15);

            ctx.restore();
        }

        function drawBee(x, y) {
            ctx.save();
            ctx.translate(x, y);

            // Bee body
            ctx.fillStyle = '#fbbf24';
            ctx.beginPath();
            ctx.ellipse(0, 0, 12, 8, 0, 0, Math.PI * 2);
            ctx.fill();

            // Bee stripes
            ctx.fillStyle = '#1f2937';
            ctx.fillRect(-10, -2, 20, 4);

            // Bee wings
            ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';
            ctx.beginPath();
            ctx.ellipse(-6, -10, 8, 5, Math.PI/4, 0, Math.PI * 2);
            ctx.ellipse(6, -10, 8, 5, -Math.PI/4, 0, Math.PI * 2);
            ctx.fill();

            ctx.restore();
        }

        // Game loop
        let lastTimestamp = 0;

        function gameLoop(timestamp) {
            if (!gameState.running || gameState.paused) return;

            const dt = (timestamp - lastTimestamp) / 1000;
            lastTimestamp = timestamp;

            // Update game state
            updateGame(dt);

            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw game objects
            drawBear();

            // Draw jars
            for (const jar of jars) {
                drawJar(jar.x, jar.y, jar.type);
            }

            // Draw bees
            for (const bee of bees) {
                drawBee(bee.x, bee.y);
            }

            // Draw particles if enabled
            if (window.getGameSettings && window.getGameSettings().particles !== false) {
                for (const p of particles) {
                    ctx.save();
                    ctx.translate(p.x, p.y);
                    ctx.fillStyle = p.color;
                    ctx.globalAlpha = p.life;
                    ctx.fillRect(-2, -2, 4, 4);
                    ctx.restore();
                }
            }

            // Continue game loop
            if (gameState.running && !gameState.paused) {
                requestAnimationFrame(gameLoop);
            }
        }

        function updateGame(dt) {
            // Update time
            gameState.timeLeft -= dt;
            if (gameState.timeLeft <= 0) {
                gameState.timeLeft = 0;
                endGame();
                return;
            }

            // Update shield
            if (gameState.shieldTime > 0) {
                gameState.shieldTime -= dt;
            }

            // Use difficulty settings if available
            const difficulty = window.gameDifficulty || {
                jarSpawnRate: 0.02,
                jarSpeed: { min: 150, max: 200 },
                beeSpawnRate: 0.01,
                beeSpeed: { min: 100, max: 150 },
                timeLimit: 60,
                lives: 3
            };

            // Spawn jars with difficulty settings
            if (Math.random() < difficulty.jarSpawnRate) {
                const type = Math.random() < 0.1 ? 'gold' : Math.random() < 0.15 ? 'shield' : 'normal';
                jars.push({
                    x: Math.random() * (canvas.width - 40) + 20,
                    y: -20,
                    vy: difficulty.jarSpeed.min + Math.random() * (difficulty.jarSpeed.max - difficulty.jarSpeed.min),
                    type: type
                });
            }

            // Spawn bees with difficulty settings
            if (Math.random() < difficulty.beeSpawnRate) {
                bees.push({
                    x: Math.random() < 0.5 ? -20 : canvas.width + 20,
                    y: Math.random() * canvas.height * 0.6 + 50,
                    vx: (Math.random() < 0.5 ? -1 : 1) * (difficulty.beeSpeed.min + Math.random() * (difficulty.beeSpeed.max - difficulty.beeSpeed.min)),
                    vy: 0
                });
            }

            // Update bear position
            if (keys.left) bear.vx = -bear.speed;
            else if (keys.right) bear.vx = bear.speed;
            else bear.vx = 0;

            bear.x += bear.vx * dt;
            bear.x = Math.max(20, Math.min(canvas.width - 20, bear.x));

            // Update jars
            for (let i = jars.length - 1; i >= 0; i--) {
                const jar = jars[i];
                jar.y += jar.vy * dt;

                // Check collision with bear
                const dx = jar.x - bear.x;
                const dy = jar.y - (bear.y - 20);
                const distance = Math.sqrt(dx * dx + dy * dy);

                if (distance < 30) {
                    // Jar caught!
                    jars.splice(i, 1);
                    gameState.score += jar.type === 'gold' ? 30 : jar.type === 'shield' ? 15 : 10;
                    gameState.streak++;

                    if (jar.type === 'shield') {
                        gameState.shieldTime = 5;
                    }

                    // Create particles if enabled
                    if (window.getGameSettings && window.getGameSettings().particles !== false) {
                        for (let j = 0; j < 10; j++) {
                            particles.push({
                                x: jar.x,
                                y: jar.y,
                                vx: (Math.random() - 0.5) * 200,
                                vy: -100 - Math.random() * 100,
                                color: jar.type === 'gold' ? '#f59e0b' : jar.type === 'shield' ? '#38bdf8' : '#fbbf24',
                                life: 1
                            });
                        }
                    }

                    // Play sound if enabled
                    if (window.getGameSettings && window.getGameSettings().sfx !== false) {
                        const honeySound = document.getElementById('honeySound');
                        if (honeySound) {
                            honeySound.currentTime = 0;
                            honeySound.play().catch(e => console.log('Sound play failed:', e));
                        }
                    }
                }

                // Remove off-screen jars
                if (jar.y > canvas.height + 50) {
                    jars.splice(i, 1);
                    gameState.streak = 0;
                }
            }

            // Update bees
            for (let i = bees.length - 1; i >= 0; i--) {
                const bee = bees[i];
                bee.x += bee.vx * dt;

                // Check collision with bear
                const dx = bee.x - bear.x;
                const dy = bee.y - bear.y;
                const distance = Math.sqrt(dx * dx + dy * dy);

                if (distance < 25) {
                    // Bee hit!
                    bees.splice(i, 1);

                    if (gameState.shieldTime > 0) {
                        gameState.shieldTime = 0;
                    } else {
                        gameState.lives--;
                        gameState.streak = 0;

                        if (gameState.lives <= 0) {
                            endGame();
                            return;
                        }
                    }
                }

                // Remove off-screen bees
                if (bee.x < -50 || bee.x > canvas.width + 50) {
                    bees.splice(i, 1);
                }
            }

            // Update particles
            for (let i = particles.length - 1; i >= 0; i--) {
                const p = particles[i];
                p.x += p.vx * dt;
                p.y += p.vy * dt;
                p.vy += 200 * dt;
                p.life -= dt;

                if (p.life <= 0) {
                    particles.splice(i, 1);
                }
            }

            // Update HUD
            updateHUD();
        }

        // Event listeners
        gameStartButton.addEventListener('click', startGame);
        gameResumeButton.addEventListener('click', resumeGame);
        gameRestartButton.addEventListener('click', () => {
            initGame();
            startGame();
        });        // Keyboard controls - FOR THE GAME
        document.addEventListener('keydown', (e) => {
            // Only handle game controls if we're in Chapter 2 AND game is running
            const gamePage = document.querySelector('.page[data-chapter="2"]');
            const isInGame = gamePage && gamePage.classList.contains('active');

            if (isInGame && gameState.running && !gameState.paused) {
                if (e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') {
                    e.preventDefault(); // Prevent chapter navigation
                    keys.left = true;
                } else if (e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') {
                    e.preventDefault(); // Prevent chapter navigation
                    keys.right = true;
                } else if (e.key === ' ' || e.key === 'Spacebar') {
                    e.preventDefault();
                    pauseGame();
                }
            }
        });

        document.addEventListener('keyup', (e) => {
            const gamePage = document.querySelector('.page[data-chapter="2"]');
            const isInGame = gamePage && gamePage.classList.contains('active');

            if (isInGame) {
                if (e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') {
                    e.preventDefault();
                    keys.left = false;
                } else if (e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') {
                    e.preventDefault();
                    keys.right = false;
                }
            }
        });

        // Mobile controls
        mobileLeftBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            keys.left = true;
        });

        mobileLeftBtn.addEventListener('touchend', (e) => {
            e.preventDefault();
            keys.left = false;
        });

        mobileRightBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            keys.right = true;
        });

        mobileRightBtn.addEventListener('touchend', (e) => {
            e.preventDefault();
            keys.right = false;
        });

        mobilePauseBtn.addEventListener('click', pauseGame);

        // Initialize game when page loads
        window.addEventListener('load', initGame);
        window.addEventListener('resize', resizeCanvas);

        // Make game functions available to chapter navigation
        window.initHoneyGame = initGame;
        window.pauseHoneyGame = pauseGame;
    })();

    // Storybook chapter navigation
    document.addEventListener("DOMContentLoaded", () => {
        const pages = [...document.querySelectorAll(".page")];
        const nextBtn = document.getElementById("nextBtn");
        const prevBtn = document.getElementById("prevBtn");
        const indicator = document.getElementById("pageIndicator");
        const progress = document.getElementById("progressFill");
        const total = pages.length;
        let current = 0;

        function scrollToChapter(chapter) {
            const target = chapter - 1;
            if (!isNaN(target) && target >= 0 && target < total) {
                current = target;
                updateUI();
            }
        }

        function updateUI() {
            pages.forEach((page, i) => {
                const wasActive = page.classList.contains("active");
                page.classList.toggle("active", i === current);

                // Initialize game when Chapter 2 becomes active
                if (i === 1 && i === current && !wasActive) {
                    setTimeout(() => {
                        if (typeof initHoneyGame === 'function') {
                            initHoneyGame();
                        }
                    }, 300);
                }

                // Pause game when leaving Chapter 2
                if (i === 1 && wasActive && i !== current) {
                    if (typeof pauseHoneyGame === 'function') {
                        pauseHoneyGame();
                    }
                }
            });

            indicator.textContent = `Chapter ${current + 1} of ${total}`;
            progress.style.width = `${((current + 1) / total) * 100}%`;
            document
                .querySelectorAll("[data-chapter-target]")
                .forEach((btn) =>
                    btn.classList.toggle(
                        "active",
                        parseInt(btn.dataset.chapterTarget, 10) === current + 1
                    )
                );

            // Smooth scroll to page
            pages[current].scrollIntoView({ behavior: "smooth", block: "start" });
        }

        nextBtn?.addEventListener("click", () => {
            if (current < total - 1) {
                current++;
                updateUI();
            }
        });

        prevBtn?.addEventListener("click", () => {
            if (current > 0) {
                current--;
                updateUI();
            }
        });

        // Allow clicking chapter pills directly
        document.querySelectorAll("[data-chapter-target]").forEach((btn) => {
            btn.addEventListener("click", () => {
                const target = parseInt(btn.dataset.chapterTarget, 10) - 1;
                if (!isNaN(target) && target >= 0 && target < total) {
                    current = target;
                    updateUI();
                }
            });
        });

        // Optional keyboard navigation - only works when NOT in Chapter 2
        document.addEventListener("keydown", (e) => {
            // Check if we're in the game chapter
            const gamePage = document.querySelector('.page[data-chapter="2"]');
            const isInGame = gamePage && gamePage.classList.contains('active');

            // Don't navigate chapters if we're in the game
            if (isInGame) return;

            if (e.key === "ArrowRight") nextBtn?.click();
            if (e.key === "ArrowLeft") prevBtn?.click();
        });

        // Make scrollToChapter globally accessible
        window.scrollToChapter = scrollToChapter;

        // Initialize
        updateUI();
    });

    // Settings Panel Functionality
    (function() {
        "use strict";

        const settingsButton = document.getElementById('settingsButton');
        const settingsOverlay = document.getElementById('settingsOverlay');
        const closeSettings = document.getElementById('closeSettings');
        const applySettingsBtn = document.getElementById('applySettingsBtn');
        const resetSettingsBtn = document.getElementById('resetSettingsBtn');

        // Settings elements
        const difficultySelect = document.getElementById('difficultySelect');
        const musicToggle = document.getElementById('musicToggle');
        const sfxToggle = document.getElementById('sfxToggle');
        const volumeSlider = document.getElementById('volumeSlider');
        const volumeValue = document.getElementById('volumeValue');
        const particlesToggle = document.getElementById('particlesToggle');
        const animationsToggle = document.getElementById('animationsToggle');
        const sensitivitySlider = document.getElementById('sensitivitySlider');
        const sensitivityValue = document.getElementById('sensitivityValue');
        const vibrationToggle = document.getElementById('vibrationToggle');
        const mobileControlsToggle = document.getElementById('mobileControlsToggle');
        const themeOptions = document.querySelectorAll('.theme-option');

        // Default settings
        const defaultSettings = {
            difficulty: 'medium',
            music: true,
            sfx: true,
            volume: 80,
            particles: true,
            animations: true,
            sensitivity: 260,
            vibration: false,
            mobileControls: true,
            theme: 'light'
        };

        // Current settings
        let currentSettings = { ...defaultSettings };

        // Load saved settings from localStorage
        function loadSettings() {
            const saved = localStorage.getItem('honeyGameSettings');
            if (saved) {
                try {
                    currentSettings = { ...defaultSettings, ...JSON.parse(saved) };
                    applySettingsToUI();
                } catch (e) {
                    console.error('Error loading settings:', e);
                }
            }
            applySettingsToGame();
        }

        // Save settings to localStorage
        function saveSettings() {
            localStorage.setItem('honeyGameSettings', JSON.stringify(currentSettings));
        }

        // Apply settings to UI controls
        function applySettingsToUI() {
            difficultySelect.value = currentSettings.difficulty;
            musicToggle.checked = currentSettings.music;
            sfxToggle.checked = currentSettings.sfx;
            volumeSlider.value = currentSettings.volume;
            volumeValue.textContent = `${currentSettings.volume}%`;
            particlesToggle.checked = currentSettings.particles;
            animationsToggle.checked = currentSettings.animations;
            sensitivitySlider.value = currentSettings.sensitivity;
            sensitivityValue.textContent = currentSettings.sensitivity;
            vibrationToggle.checked = currentSettings.vibration;
            mobileControlsToggle.checked = currentSettings.mobileControls;

            // Set active theme
            themeOptions.forEach(option => {
                option.classList.remove('active');
                if (option.dataset.theme === currentSettings.theme) {
                    option.classList.add('active');
                }
            });

            // Apply theme to document
            applyTheme(currentSettings.theme);
        }

        // Apply settings to game
        function applySettingsToGame() {
            // Apply difficulty
            switch(currentSettings.difficulty) {
                case 'easy':
                    window.gameDifficulty = {
                        jarSpawnRate: 0.015,
                        jarSpeed: { min: 100, max: 180 },
                        beeSpawnRate: 0.008,
                        beeSpeed: { min: 80, max: 120 },
                        timeLimit: 90,
                        lives: 4
                    };
                    break;
                case 'medium':
                    window.gameDifficulty = {
                        jarSpawnRate: 0.02,
                        jarSpeed: { min: 150, max: 200 },
                        beeSpawnRate: 0.01,
                        beeSpeed: { min: 100, max: 150 },
                        timeLimit: 60,
                        lives: 3
                    };
                    break;
                case 'hard':
                    window.gameDifficulty = {
                        jarSpawnRate: 0.025,
                        jarSpeed: { min: 180, max: 250 },
                        beeSpawnRate: 0.015,
                        beeSpeed: { min: 120, max: 180 },
                        timeLimit: 45,
                        lives: 2
                    };
                    break;
                case 'expert':
                    window.gameDifficulty = {
                        jarSpawnRate: 0.03,
                        jarSpeed: { min: 200, max: 300 },
                        beeSpawnRate: 0.02,
                        beeSpeed: { min: 150, max: 220 },
                        timeLimit: 30,
                        lives: 1
                    };
                    break;
            }

            // Apply sensitivity to bear
            if (window.bear) {
                window.bear.speed = currentSettings.sensitivity;
            }

            // Apply volume to audio elements
            const volume = currentSettings.volume / 100;
            const audioElements = document.querySelectorAll('audio');
            audioElements.forEach(audio => {
                audio.volume = volume;
            });

            // Apply theme
            applyTheme(currentSettings.theme);

            // Apply animations
            document.body.classList.toggle('no-animations', !currentSettings.animations);

            // Apply mobile controls
            const mobileControls = document.getElementById('mobileControls');
            if (mobileControls) {
                if (currentSettings.mobileControls && ('ontouchstart' in window || navigator.maxTouchPoints > 0)) {
                    mobileControls.classList.add('visible');
                } else {
                    mobileControls.classList.remove('visible');
                }
            }

            // Toggle music
            const bgMusic = document.getElementById('bgMusic');
            const ambientForest = document.getElementById('ambientForest');

            if (bgMusic) {
                if (currentSettings.music) {
                    bgMusic.play().catch(e => console.log('Audio play failed:', e));
                } else {
                    bgMusic.pause();
                }
            }

            if (ambientForest) {
                if (currentSettings.music) {
                    ambientForest.play().catch(e => console.log('Audio play failed:', e));
                } else {
                    ambientForest.pause();
                }
            }
        }

        // Apply theme to document
        function applyTheme(theme) {
            // Remove existing theme classes
            document.documentElement.classList.remove('theme-light', 'theme-dark');

            // Determine actual theme (auto checks system preference)
            let actualTheme = theme;
            if (theme === 'auto') {
                actualTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
            }

            // Apply theme class
            document.documentElement.classList.add(`theme-${actualTheme}`);

            // Update theme colors
            if (actualTheme === 'dark') {
                document.documentElement.style.setProperty('--bg', '#1a1a1a');
                document.documentElement.style.setProperty('--bg-soft', '#2a2a2a');
                document.documentElement.style.setProperty('--ink', '#f0f0f0');
                document.documentElement.style.setProperty('--ink-soft', '#cccccc');
                document.documentElement.style.setProperty('--card-bg', '#2a2a2a');
                document.documentElement.style.setProperty('--border-soft', 'rgba(255, 255, 255, 0.1)');
            } else {
                // Reset to light theme
                document.documentElement.style.setProperty('--bg', '#fff9ec');
                document.documentElement.style.setProperty('--bg-soft', '#fff4dd');
                document.documentElement.style.setProperty('--ink', '#3b2604');
                document.documentElement.style.setProperty('--ink-soft', '#5a4330');
                document.documentElement.style.setProperty('--card-bg', '#ffffff');
                document.documentElement.style.setProperty('--border-soft', 'rgba(0, 0, 0, 0.06)');
            }
        }

        // Collect settings from UI
        function collectSettingsFromUI() {
            return {
                difficulty: difficultySelect.value,
                music: musicToggle.checked,
                sfx: sfxToggle.checked,
                volume: parseInt(volumeSlider.value),
                particles: particlesToggle.checked,
                animations: animationsToggle.checked,
                sensitivity: parseInt(sensitivitySlider.value),
                vibration: vibrationToggle.checked,
                mobileControls: mobileControlsToggle.checked,
                theme: document.querySelector('.theme-option.active').dataset.theme
            };
        }

        // Update game with new settings
        function updateGameSettings() {
            currentSettings = collectSettingsFromUI();
            saveSettings();
            applySettingsToGame();

            // Show confirmation
            showNotification('Settings applied!');
        }

        // Reset to defaults
        function resetToDefaults() {
            if (confirm('Reset all settings to defaults?')) {
                currentSettings = { ...defaultSettings };
                saveSettings();
                applySettingsToUI();
                applySettingsToGame();
                showNotification('Settings reset to defaults');
            }
        }

        // Show notification
        function showNotification(message) {
            // Create notification element
            const notification = document.createElement('div');
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: linear-gradient(135deg, #f4b944, #f59e0b);
                color: #3b2604;
                padding: 12px 24px;
                border-radius: 999px;
                font-weight: 600;
                box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
                z-index: 1001;
                animation: slideDown 0.3s ease, slideUp 0.3s ease 2s forwards;
            `;

            document.body.appendChild(notification);

            // Remove after animation
            setTimeout(() => {
                notification.remove();
            }, 2300);
        }

        // Event Listeners
        settingsButton.addEventListener('click', () => {
            settingsOverlay.classList.add('visible');
            document.body.style.overflow = 'hidden';
        });

        closeSettings.addEventListener('click', () => {
            settingsOverlay.classList.remove('visible');
            document.body.style.overflow = '';
        });

        settingsOverlay.addEventListener('click', (e) => {
            if (e.target === settingsOverlay) {
                settingsOverlay.classList.remove('visible');
                document.body.style.overflow = '';
            }
        });

        applySettingsBtn.addEventListener('click', updateGameSettings);
        resetSettingsBtn.addEventListener('click', resetToDefaults);

        // Live updates for sliders
        volumeSlider.addEventListener('input', (e) => {
            volumeValue.textContent = `${e.target.value}%`;
        });

        sensitivitySlider.addEventListener('input', (e) => {
            sensitivityValue.textContent = e.target.value;
        });

        // Theme selection
        themeOptions.forEach(option => {
            option.addEventListener('click', () => {
                themeOptions.forEach(opt => opt.classList.remove('active'));
                option.classList.add('active');
            });
        });

        // Listen for system theme changes (for auto theme)
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
            if (currentSettings.theme === 'auto') {
                applyTheme('auto');
            }
        });

        // Close with Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && settingsOverlay.classList.contains('visible')) {
                settingsOverlay.classList.remove('visible');
                document.body.style.overflow = '';
            }
        });

        // Initialize settings
        window.addEventListener('load', loadSettings);

        // Make functions available globally
        window.applyGameSettings = applySettingsToGame;
        window.getGameSettings = () => currentSettings;
        window.showSettings = () => settingsButton.click();

    })();

</script>

<!-- Audio Elements -->
<audio id="bgMusic" loop preload="auto" src="media/hundred-acre-lullaby.mp3"></audio>
<audio id="honeySound" preload="auto">
    <source src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3">
</audio>
<audio id="pageSound" preload="auto">
    <source src="https://assets.mixkit.co/sfx/preview/mixkit-page-turn-single-1100.mp3">
</audio>
<audio id="pageRustle1" preload="auto">
    <source src="https://assets.mixkit.co/sfx/preview/mixkit-page-turn-single-1100.mp3">
</audio>
<audio id="pageRustle2" preload="auto">
    <source src="https://assets.mixkit.co/sfx/preview/mixkit-page-turn-medium-1103.mp3">
</audio>
<audio id="paperThump" preload="auto">
    <source src="https://assets.mixkit.co/sfx/preview/mixkit-soft-ui-click-2577.mp3">
</audio>
<audio id="ambientForest" loop preload="auto">
    <source src="https://assets.mixkit.co/sfx/preview/mixkit-forest-birds-ambience-121.mp3">
</audio>

</body>
</html>
