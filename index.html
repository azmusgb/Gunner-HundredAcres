<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0, viewport-fit=cover" name="viewport">
    <title>Baby Gunnar's Hundred Acre Wood Adventure</title>
    <meta content="A storybook-style Hundred Acre Wood adventure with a honey-catching game to celebrate Baby Gunnar."
          name="description">
    <meta content="#f4a944" name="theme-color">
    <meta content="light dark" name="color-scheme">
    <meta content="Baby Gunnar's Hundred Acre Wood Shower" property="og:title">
    <meta content="A sweet storybook and honey-catching game‚Äîread, play, and leave your wishes."
          property="og:description">
    <meta content="icons/icon.svg" property="og:image">
    <meta content="website" property="og:type">
    <!-- Font Awesome for game icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <link as="image" href="Images/Characters/Gunnar.png" rel="preload">
    <!--link href="styles.css" rel="stylesheet"-->
<style>
/* ==========================================================================
   BABY GUNNAR'S HUNDRED ACRE WOOD ADVENTURE - OPTIMIZED
   ========================================================================== */

/* 1. CRITICAL CSS - ABOVE THE FOLD */
:root {
    /* Consolidated Color Palette */
    --color-primary: #f4a944;
    --color-primary-dark: #d89230;
    --color-primary-light: #ffd89b;
    --color-accent: #dc4d3f;
    --color-accent-dark: #b02626;
    --color-secondary: #8b9d77;
    --color-secondary-light: #b8c9a4;
    --color-dark: #4a5e3f;
    --color-sky: #a8c9e8;
    --color-sky-light: #d4e6f5;
    --color-cream: #faf7f2;
    --color-white: #fffcf7;
    --color-wood: #8b6f47;
    --color-ink: #5A3A24;
    --color-ink-muted: #6B4A32;
    
    /* Neutrals */
    --color-text: #3a3a3a;
    --color-text-muted: #6b6b6b;
    --color-border: rgba(139, 157, 119, 0.2);
    
    /* Spacing */
    --space-xs: 0.5rem;
    --space-sm: 1rem;
    --space-md: 1.5rem;
    --space-lg: 2.5rem;
    --space-xl: 4rem;
    
    /* Typography */
    --font-primary: 'EB Garamond', 'Georgia', serif;
    --font-secondary: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    --font-display: 'Patrick Hand', cursive;
    
    /* Shadows */
    --shadow-sm: 0 2px 8px rgba(74, 94, 63, 0.08);
    --shadow-md: 0 4px 16px rgba(74, 94, 63, 0.12);
    --shadow-lg: 0 8px 32px rgba(74, 94, 63, 0.15);
    
    /* Borders */
    --radius-sm: 8px;
    --radius-md: 12px;
    --radius-lg: 20px;
    --radius-full: 9999px;
    
    /* Transitions */
    --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
    --transition-base: 250ms cubic-bezier(0.4, 0, 0.2, 1);
}

/* 2. BASE RESET & GLOBAL */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

*:focus {
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
}

html {
    scroll-behavior: smooth;
    -webkit-font-smoothing: antialiased;
}

body {
    font-family: var(--font-primary);
    font-size: clamp(16px, 1vw + 15px, 19px);
    line-height: 1.6;
    color: var(--color-text);
    background: linear-gradient(180deg, var(--color-cream) 0%, var(--color-white) 100%);
    min-height: 100vh;
    overflow-x: hidden;
    position: relative;
}

/* Enhanced background */
body::before {
    content: '';
    position: fixed;
    inset: 10px;
    border: 14px double rgba(125, 86, 44, 0.18);
    border-radius: 28px;
    box-shadow: inset 0 0 35px rgba(125, 86, 44, 0.08),
                0 18px 40px rgba(0, 0, 0, 0.15);
    pointer-events: none;
    z-index: 0;
    mix-blend-mode: multiply;
}

::selection {
    background: var(--color-primary-light);
    color: var(--color-dark);
}

/* 3. ACCESSIBILITY */
.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

.skip-link {
    position: absolute;
    top: -40px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--color-dark);
    color: white;
    padding: var(--space-sm) var(--space-md);
    border-radius: var(--radius-full);
    text-decoration: none;
    font-family: var(--font-secondary);
    font-weight: 600;
    z-index: 10000;
    transition: top var(--transition-fast);
}

.skip-link:focus {
    top: var(--space-sm);
}

@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        animation: none !important;
        transition: none !important;
        transform: none !important;
        scroll-behavior: auto !important;
    }
}

/* 4. LAYOUT CONTAINERS */
.layout-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 var(--space-md);
}

/* 5. HERO SECTION - OPTIMIZED */
.masthead-hero {
    width: 100%;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    background: linear-gradient(135deg, var(--color-sky-light) 0%, var(--color-cream) 50%, var(--color-primary-light) 100%);
    overflow: hidden;
    z-index: 10;
    margin: 0 auto 40px;
    padding: 0;
    border-radius: 24px;
    box-shadow: var(--shadow-lg);
    border: 2px solid rgba(244, 169, 68, 0.3);
}

.hero-banner {
    position: relative;
    width: 100%;
    max-width: 900px;
    margin: 0 auto;
    padding: var(--space-xl) var(--space-md) var(--space-lg);
}

.hero-image-container {
    position: relative;
    width: 100%;
    max-width: 800px;
    margin: 0 auto;
    border-radius: var(--radius-lg);
    overflow: hidden;
    box-shadow: var(--shadow-lg);
    background: white;
    padding: var(--space-md);
    aspect-ratio: 16/9;
    max-height: 500px;
}

.hero-banner__img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    object-position: center;
    display: block;
    border-radius: var(--radius-md);
}

.hero-title-container {
    text-align: center;
    margin-top: var(--space-lg);
    position: relative;
    padding: 40px 30px;
    background: linear-gradient(180deg, rgba(249, 244, 232, 0.95), rgba(232, 220, 197, 0.95));
    border-bottom: 2px solid rgba(244, 169, 68, 0.4);
    max-width: 800px;
    margin: 0 auto;
}

.title-background {
    display: inline-block;
    padding: var(--space-lg) var(--space-xl);
    background: rgba(255, 255, 255, 0.95);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-md);
    backdrop-filter: blur(10px);
    max-width: 600px;
    margin: 0 auto;
}

.masthead-title {
    font-family: var(--font-display);
    font-size: clamp(2.5rem, 6vw, 4.5rem);
    font-weight: 300;
    letter-spacing: 0.02em;
    color: var(--color-dark);
    line-height: 1.2;
    margin-bottom: var(--space-sm);
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
}

.title-line {
    display: block;
}

.title-line--primary {
    color: var(--color-primary);
    font-style: italic;
    font-weight: 700;
}

.title-line--secondary {
    color: var(--color-dark);
    font-weight: 400;
    font-size: clamp(1.8rem, 4vw, 2.5rem);
    margin-top: 8px;
}

.hero-subtitle {
    font-family: var(--font-secondary);
    font-size: clamp(1rem, 2.5vw, 1.5rem);
    color: var(--color-text-muted);
    font-weight: 400;
    max-width: 600px;
    margin: 20px auto 0;
    line-height: 1.5;
}

/* Hero Content */
.hero-panel {
    max-width: 900px;
    width: 100%;
    background: white;
    border-radius: var(--radius-lg);
    padding: var(--space-xl);
    box-shadow: var(--shadow-lg);
    border: 4px solid var(--color-primary-light);
    margin: 0 auto;
}

.hero-badge {
    text-align: center;
    margin-bottom: var(--space-xl);
    padding-bottom: var(--space-lg);
    border-bottom: 2px dashed var(--color-border);
    display: grid;
    grid-template-columns: 1fr;
    gap: 24px;
    align-items: center;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(250, 250, 250, 0.95));
    padding: 24px;
    border-radius: 20px;
    border: 2px solid rgba(244, 169, 68, 0.4);
    box-shadow: 0 12px 28px rgba(0, 0, 0, 0.1);
}

.badge-icon {
    width: 80px;
    height: 80px;
    margin: 0 auto var(--space-md);
    background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: var(--shadow-md);
    position: relative;
}

.badge-icon-inner {
    font-size: 32px;
    width: 64px;
    height: 64px;
    background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.8), rgba(244, 169, 68, 0.9));
    border-radius: 50%;
    display: grid;
    place-items: center;
    border: 2px solid rgba(212, 138, 31, 0.6);
    box-shadow: 0 8px 16px rgba(244, 169, 68, 0.3);
}

.badge-eyebrow {
    font-family: var(--font-secondary);
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--color-primary-dark);
    font-weight: 700;
    margin-bottom: var(--space-xs);
}

.badge-title {
    font-size: clamp(1.5rem, 3vw, 2rem);
    color: var(--color-dark);
    font-weight: 600;
    font-family: var(--font-secondary);
}

.badge-meta {
    display: flex;
    justify-content: center;
    gap: var(--space-md);
    flex-wrap: wrap;
    margin-top: var(--space-md);
    flex-direction: row;
    gap: 12px;
    align-items: center;
}

.badge-pill {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 10px 16px;
    border-radius: 999px;
    font-weight: 600;
    font-size: 0.95rem;
    white-space: nowrap;
}

.badge-pill.date {
    background: linear-gradient(135deg, rgba(244, 169, 68, 0.15), rgba(244, 169, 68, 0.25));
    color: var(--color-primary-dark);
    border: 1px solid rgba(244, 169, 68, 0.3);
}

.badge-pill.location {
    background: linear-gradient(135deg, rgba(107, 163, 212, 0.15), rgba(107, 163, 212, 0.25));
    color: var(--color-sky);
    border: 1px solid rgba(107, 163, 212, 0.3);
}

.hero-details-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: var(--space-md);
    margin: 30px 0;
}

.hero-detail {
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 20px;
    background: rgba(255, 255, 255, 0.9);
    border-radius: 16px;
    border: 1px solid rgba(244, 169, 68, 0.2);
    transition: all var(--transition-base);
}

.hero-detail:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.1);
    border-color: var(--color-primary);
}

.detail-icon {
    width: 48px;
    height: 48px;
    background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
    border-radius: 50%;
    display: grid;
    place-items: center;
    font-size: 24px;
    color: white;
    flex-shrink: 0;
}

.detail-content {
    flex: 1;
}

.detail-title {
    font-family: var(--font-secondary);
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--color-dark);
    margin-bottom: var(--space-xs);
}

.detail-text {
    font-size: 0.9rem;
    color: var(--color-text-muted);
    line-height: 1.5;
}

.hero-actions {
    display: flex;
    gap: var(--space-md);
    justify-content: center;
    flex-wrap: wrap;
    margin: 30px 0;
}

.hero-action-btn {
    display: inline-flex;
    align-items: center;
    gap: var(--space-sm);
    padding: 14px 24px;
    font-family: var(--font-secondary);
    font-size: 1rem;
    font-weight: 600;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    transition: all var(--transition-base);
    text-decoration: none;
    min-width: 180px;
    justify-content: center;
    border: 2px solid transparent;
}

.hero-action-btn.primary {
    background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
    color: #3c1f0a;
    box-shadow: 0 8px 20px rgba(244, 169, 68, 0.3);
}

.hero-action-btn.primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 24px rgba(244, 169, 68, 0.4);
}

.hero-action-btn.secondary {
    background: linear-gradient(135deg, var(--color-accent), var(--color-accent-dark));
    color: white;
    box-shadow: 0 8px 20px rgba(206, 46, 46, 0.3);
}

.hero-action-btn.secondary:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 24px rgba(206, 46, 46, 0.4);
}

.hero-action-btn.ghost {
    background: rgba(255, 255, 255, 0.9);
    color: var(--color-ink);
    border-color: rgba(244, 169, 68, 0.4);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.08);
}

.hero-action-btn.ghost:hover {
    background: var(--color-primary-light);
    transform: translateY(-2px);
}

/* 6. CHAPTER TRACKER - SIMPLIFIED */
.chapter-tracker {
    position: sticky;
    top: 0;
    background: linear-gradient(120deg, rgba(249, 244, 232, 0.9), rgba(232, 220, 197, 0.95));
    padding: 16px 18px 12px;
    box-shadow: var(--shadow-md);
    z-index: 100;
    border: 2px solid rgba(244, 169, 68, 0.35);
    border-radius: 16px;
    margin: 0 auto 18px;
    max-width: 1200px;
    backdrop-filter: blur(10px);
}

.tracker-row {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 10px;
}

.tracker-label {
    font-family: var(--font-secondary);
    font-size: 1.05rem;
    color: var(--color-accent);
    white-space: nowrap;
    display: inline-flex;
    align-items: center;
    gap: 8px;
}

.book-progress {
    flex: 1;
    height: 10px;
    border-radius: 999px;
    background: rgba(212, 138, 31, 0.16);
    border: 1px solid rgba(212, 138, 31, 0.2);
    overflow: hidden;
}

.progress-fill {
    position: absolute;
    inset: 0;
    width: 0%;
    border-radius: 999px;
    background: linear-gradient(90deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
    box-shadow: 0 0 12px rgba(244, 169, 68, 0.55);
    transition: width 0.4s ease;
}

.chapter-pill-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 10px;
}

.chapter-pill {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: 10px 12px;
    border: 2px dashed rgba(212, 138, 31, 0.6);
    background: rgba(255, 255, 255, 0.92);
    border-radius: 12px;
    cursor: pointer;
    transition: all var(--transition-base);
    position: relative;
    overflow: hidden;
    min-height: 44px;
}

.chapter-pill:hover,
.chapter-pill.active {
    transform: translateY(-3px);
    box-shadow: 0 12px 22px rgba(0, 0, 0, 0.12);
    border-color: var(--color-primary);
    border-style: solid;
}

.chapter-pill.active {
    background: #fff8e6;
    box-shadow: 0 12px 22px rgba(0, 0, 0, 0.16), inset 0 0 0 2px rgba(255, 255, 255, 0.7);
}

.pill-number {
    width: 38px;
    height: 38px;
    border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.45), rgba(244, 169, 68, 0.95));
    display: grid;
    place-items: center;
    color: #3c1f0a;
    font-weight: 800;
    box-shadow: inset 0 0 0 2px rgba(255, 255, 255, 0.4);
    flex-shrink: 0;
}

.chapter-pill.active .pill-number {
    background: white;
    color: var(--color-primary-dark);
}

.pill-text {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.pill-title {
    font-weight: 700;
    font-size: 1rem;
    color: var(--color-dark);
}

.pill-detail {
    font-size: 0.9rem;
    color: #4a3928;
}

/* 7. BOOK CONTAINER */
.book-container {
    max-width: 1200px;
    width: 100%;
    margin: 8px auto 0;
    padding: var(--space-md);
    filter: drop-shadow(0 26px 55px rgba(73, 46, 24, 0.34));
}

.book {
    background: linear-gradient(90deg, rgba(86, 62, 40, 0.94) 0%, rgba(112, 78, 47, 0.92) 7%, rgba(237, 217, 184, 0.97) 9%, rgba(250, 243, 226, 0.98) 65%, rgba(237, 217, 184, 0.97) 100%);
    border-radius: 18px;
    padding: 40px;
    box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.12),
                0 24px 46px rgba(0, 0, 0, 0.18);
    position: relative;
}

.book::before {
    content: '';
    position: absolute;
    left: 22px;
    top: 16px;
    bottom: 16px;
    width: 16px;
    background: linear-gradient(180deg, rgba(125, 86, 44, 0.7), rgba(93, 63, 35, 0.82));
    box-shadow: inset -4px 0 6px rgba(0, 0, 0, 0.38),
                inset 4px 0 8px rgba(255, 255, 255, 0.08),
                12px 0 30px rgba(0, 0, 0, 0.08);
    border-radius: 10px;
    pointer-events: none;
    z-index: 10;
}

.pages-wrapper {
    position: relative;
    padding: 16px 14px 16px 48px;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.18), rgba(255, 255, 255, 0.06));
    border-radius: 16px;
    box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.18),
                inset 0 24px 60px rgba(135, 104, 70, 0.15);
    overflow: hidden;
}

.page {
    flex: 1;
    background: radial-gradient(circle at 22% 18%, rgba(244, 169, 68, 0.07), transparent 40%),
                radial-gradient(circle at 82% 12%, rgba(106, 159, 96, 0.05), transparent 32%),
                var(--color-cream);
    padding: 30px;
    border-radius: 16px;
    border: 2px solid rgba(125, 86, 44, 0.2);
    box-shadow: inset 0 0 30px rgba(139, 111, 71, 0.12),
                0 18px 32px rgba(0, 0, 0, 0.18);
    display: none;
    animation: pageEnter 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.page.active {
    display: block;
    box-shadow: inset 0 0 30px rgba(139, 111, 71, 0.12),
                0 22px 40px rgba(0, 0, 0, 0.2);
}

.page-content {
    max-width: 900px;
    margin: 0 auto;
}

/* 8. CHAPTER STYLES */
.chapter-header {
    text-align: center;
    margin-bottom: 30px;
    padding-bottom: 24px;
    border-bottom: 2px solid var(--color-primary);
    position: relative;
    background: radial-gradient(circle at 50% 100%, rgba(244, 169, 68, 0.08), transparent 55%);
    border-radius: 12px;
}

.chapter-number {
    font-family: var(--font-secondary);
    font-size: 0.9rem;
    letter-spacing: 3px;
    color: var(--color-primary-dark);
    font-weight: 700;
    margin-bottom: var(--space-sm);
    animation: fadeInDown 0.8s ease;
}

.chapter-title {
    font-family: var(--font-display);
    font-size: 2rem;
    color: var(--color-accent);
    font-weight: normal;
    font-style: italic;
    margin-bottom: var(--space-sm);
    line-height: 1.2;
    animation: fadeInUp 1s ease;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
}

.chapter-subtitle {
    font-size: 1rem;
    color: var(--color-text-muted);
    font-style: italic;
    opacity: 0.7;
    animation: fadeIn 1.2s ease;
}

.honey-drip {
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    width: 4px;
    height: 20px;
    background: linear-gradient(to bottom, var(--color-primary), transparent);
    animation: drip 3s ease-in-out infinite;
}

/* 9. STORY CONTENT */
.story-text {
    margin-bottom: 20px;
    line-height: 1.8;
    text-align: justify;
    animation: fadeIn 1.5s ease;
}

.story-text:first-letter {
    font-size: 3.8rem;
    float: left;
    line-height: 0.9;
    margin: 6px 10px 2px 0;
    color: var(--color-accent);
    font-weight: 700;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.18);
    letter-spacing: 0.02em;
}

/* 10. CHAPTER ILLUSTRATIONS */
.chapter-illustrations {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 14px;
    margin: 16px 0 28px;
}

.storybook-figure {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 14px 16px;
    background: radial-gradient(circle at 18% 20%, rgba(244, 169, 68, 0.12), transparent 38%),
                radial-gradient(circle at 82% 28%, rgba(107, 163, 212, 0.1), transparent 40%),
                linear-gradient(180deg, rgba(255, 255, 255, 0.96), rgba(252, 247, 236, 0.96));
    border: 2px solid rgba(232, 164, 39, 0.45);
    border-radius: 18px;
    box-shadow: 0 12px 26px rgba(0, 0, 0, 0.12);
    transition: transform 200ms ease, box-shadow 200ms ease;
}

.storybook-figure:hover {
    transform: translateY(-3px) rotate(-0.3deg);
    box-shadow: 0 16px 32px rgba(0, 0, 0, 0.16);
    border-color: var(--color-primary-light);
}

.storybook-figure img {
    width: 96px;
    height: auto;
    object-fit: contain;
    filter: drop-shadow(0 8px 12px rgba(0, 0, 0, 0.18));
    border-radius: 12px;
}

.figure-copy {
    display: grid;
    gap: 6px;
}

.figure-name {
    font-weight: 700;
    font-size: 1rem;
    color: var(--color-accent);
    letter-spacing: 0.4px;
}

.figure-note {
    font-size: 0.98rem;
    color: #3c2a1a;
    line-height: 1.5;
}

/* Theme variations */
.figure-theme-honey {
    background: radial-gradient(circle at 18% 20%, rgba(244, 169, 68, 0.15), transparent 38%),
                radial-gradient(circle at 82% 28%, rgba(255, 200, 100, 0.1), transparent 40%),
                linear-gradient(180deg, rgba(255, 248, 225, 0.96), rgba(255, 245, 210, 0.96));
    border-color: rgba(244, 169, 68, 0.55);
}

.figure-theme-sky {
    background: radial-gradient(circle at 18% 20%, rgba(107, 163, 212, 0.15), transparent 38%),
                radial-gradient(circle at 82% 28%, rgba(142, 196, 120, 0.1), transparent 40%),
                linear-gradient(180deg, rgba(232, 241, 247, 0.96), rgba(221, 235, 250, 0.96));
    border-color: rgba(107, 163, 212, 0.55);
}

.figure-theme-forest {
    background: radial-gradient(circle at 18% 20%, rgba(106, 159, 96, 0.15), transparent 38%),
                radial-gradient(circle at 82% 28%, rgba(142, 196, 120, 0.1), transparent 40%),
                linear-gradient(180deg, rgba(245, 250, 240, 0.96), rgba(235, 245, 230, 0.96));
    border-color: rgba(106, 159, 96, 0.55);
}

/* 11. DIALOGUE BUBBLES */
.dialogue-bubble {
    padding: 18px 22px;
    margin: 20px 0;
    border-radius: 20px;
    border: 2px solid rgba(244, 169, 68, 0.4);
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(250, 250, 250, 0.95));
    position: relative;
}

.dialogue-pooh {
    border-color: rgba(244, 169, 68, 0.6);
    background: linear-gradient(135deg, rgba(255, 248, 225, 0.95), rgba(255, 245, 210, 0.95));
    margin-left: auto;
    margin-right: 40px;
    max-width: 80%;
}

.dialogue-piglet {
    border-color: rgba(255, 182, 193, 0.5);
    background: linear-gradient(135deg, rgba(255, 245, 245, 0.95), rgba(255, 240, 240, 0.95));
    margin-right: auto;
    margin-left: 40px;
    max-width: 80%;
}

.dialogue-bubble p {
    font-style: italic;
    line-height: 1.7;
    margin-bottom: var(--space-sm);
    text-indent: 0;
}

.speaker {
    display: block;
    text-align: right;
    font-weight: 700;
    color: var(--color-primary-dark);
    margin-top: 8px;
    font-style: normal;
    font-size: 0.9rem;
}

/* 12. GAME EMBED - FIXED */
.game-container {
    container-type: inline-size;
    container-name: game;
    margin: 1.5rem auto;
    max-width: 960px;
    width: 100%;
}

.game-embed {
    width: 100%;
    border-radius: 24px;
    overflow: hidden;
    background: var(--color-cream);
    border: 6px solid var(--color-primary-light);
    aspect-ratio: 16/9;
    min-height: 420px;
}

.game-embed__frame {
    width: 100%;
    height: 100%;
    border: none;
    display: block;
    border-radius: 20px;
    background: white;
}

@container game (max-width: 800px) {
    .game-embed {
        aspect-ratio: 4/3;
        min-height: 360px;
        border-width: 2px;
    }
}

/* 13. REGISTRY & FORMS */
.registry-container {
    margin: 32px 0;
}

.registry-section {
    background: linear-gradient(135deg, var(--color-cream) 0%, white 100%);
    border-radius: var(--radius-lg);
    padding: var(--space-xl);
    border: 3px solid var(--color-primary-light);
    box-shadow: var(--shadow-md);
}

.registry-header {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-bottom: 20px;
    text-align: left;
}

.registry-icon {
    font-size: 48px;
    flex-shrink: 0;
}

.registry-header h3 {
    font-family: var(--font-display);
    font-size: clamp(1.75rem, 4vw, 2.5rem);
    color: var(--color-dark);
    margin-bottom: var(--space-sm);
    font-weight: 400;
}

.registry-subtitle {
    color: var(--color-ink-muted);
    font-size: 1.05rem;
    line-height: 1.5;
    margin-top: 8px;
}

.registry-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: var(--space-md);
    margin-top: 24px;
}

.registry-card {
    display: flex;
    flex-direction: column;
    padding: 24px;
    background: white;
    border: 2px solid rgba(244, 169, 68, 0.3);
    border-radius: 18px;
    text-decoration: none;
    color: var(--color-ink);
    transition: all 0.3s ease;
    text-align: center;
    height: 100%;
}

.registry-card:hover {
    transform: translateY(-6px);
    box-shadow: 0 16px 32px rgba(244, 169, 68, 0.2);
    border-color: var(--color-primary);
}

.card-icon {
    font-size: 40px;
    margin-bottom: 16px;
}

.card-content h4 {
    font-family: var(--font-display);
    font-size: 1.3rem;
    color: var(--color-accent);
    margin-bottom: 8px;
}

.card-content p {
    color: var(--color-ink-muted);
    line-height: 1.5;
    margin-bottom: 16px;
    flex: 1;
}

.card-link {
    color: var(--color-primary);
    font-weight: 700;
    font-size: 0.95rem;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    text-decoration: none;
    transition: color 0.3s ease;
}

.card-link:hover {
    color: var(--color-primary-dark);
}

.gift-ideas {
    list-style: none;
    padding: 0;
    margin: 12px 0 0;
    text-align: left;
    width: 100%;
}

.gift-ideas li {
    padding: 6px 0;
    padding-left: 24px;
    position: relative;
    color: var(--color-ink);
    font-size: 0.95rem;
    line-height: 1.5;
}

.gift-ideas li::before {
    content: 'üéÅ';
    position: absolute;
    left: 0;
    top: 6px;
    font-size: 14px;
}

/* 14. WISHES FORM */
.wishes-section {
    margin: 40px 0;
    padding: 32px;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.98), rgba(252, 248, 240, 0.98));
    border: 3px solid rgba(244, 169, 68, 0.3);
    border-radius: 22px;
    box-shadow: 0 16px 36px rgba(0, 0, 0, 0.12);
}

.wishes-header {
    text-align: center;
    margin-bottom: 28px;
}

.wishes-header h3 {
    font-family: var(--font-display);
    color: var(--color-accent);
    font-size: 1.8rem;
    margin-bottom: 8px;
}

.wishes-header p {
    color: var(--color-ink-muted);
    font-size: 1.1rem;
    max-width: 600px;
    margin: 0 auto;
    line-height: 1.6;
}

.enhanced-form {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.98), rgba(252, 248, 240, 0.98));
    border: 2px solid rgba(244, 169, 68, 0.3);
    border-radius: 18px;
    padding: 28px;
    margin-bottom: 24px;
}

.form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 20px;
}

.form-field {
    display: flex;
    flex-direction: column;
    gap: var(--space-xs);
    margin-bottom: 20px;
}

.form-field label {
    display: block;
    margin-bottom: 8px;
    font-weight: 700;
    color: var(--color-ink);
    font-size: 0.95rem;
}

.form-field input,
.form-field select,
.form-field textarea {
    width: 100%;
    padding: 14px 16px;
    border: 2px solid rgba(244, 169, 68, 0.3);
    border-radius: 12px;
    font-family: inherit;
    font-size: 1rem;
    background: white;
    transition: all 0.3s ease;
    color: var(--color-ink);
}

.form-field input:focus,
.form-field select:focus,
.form-field textarea:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 3px rgba(244, 169, 68, 0.1);
}

.form-field textarea {
    resize: vertical;
    min-height: 120px;
    line-height: 1.6;
}

.character-count {
    text-align: right;
    font-size: 0.85rem;
    color: var(--color-ink-muted);
    margin-top: 4px;
    opacity: 0.7;
}

.form-actions {
    display: flex;
    align-items: center;
    gap: 20px;
    flex-wrap: wrap;
    margin-top: var(--space-lg);
}

.submit-btn {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    padding: 14px 28px;
    background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
    color: #3c1f0a;
    border: none;
    border-radius: 999px;
    font-family: inherit;
    font-size: 1.1rem;
    font-weight: 700;
    transition: all 0.3s ease;
    min-width: 220px;
    cursor: pointer;
}

.submit-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 12px 24px rgba(244, 169, 68, 0.3);
}

.submit-btn:active {
    transform: translateY(-1px);
}

.form-feedback {
    padding: 12px 16px;
    border-radius: 10px;
    margin: 12px 0;
    font-weight: 600;
    text-align: center;
    transition: all 0.3s ease;
    flex: 1;
}

.form-feedback.success {
    background: rgba(142, 196, 120, 0.15);
    color: #2e7d32;
    border: 1px solid rgba(142, 196, 120, 0.3);
}

.form-feedback.error {
    background: rgba(211, 47, 47, 0.1);
    color: #c62828;
    border: 1px solid rgba(211, 47, 47, 0.2);
}

/* 15. SAMPLE WISHES */
.sample-wishes {
    margin-top: 32px;
    padding-top: 24px;
    border-top: 2px dashed rgba(244, 169, 68, 0.3);
}

.sample-wishes h4 {
    color: var(--color-primary-dark);
    margin-bottom: 16px;
    text-align: center;
    font-size: 1.2rem;
    font-family: var(--font-display);
}

.wish-examples {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
}

.wish-example {
    background: linear-gradient(135deg, rgba(255, 251, 240, 0.95), rgba(255, 248, 235, 0.95));
    border: 2px solid rgba(244, 169, 68, 0.2);
    border-radius: 16px;
    padding: 20px;
    margin: 0;
}

.wish-example p {
    font-style: italic;
    color: var(--color-ink);
    line-height: 1.6;
    margin-bottom: 12px;
    font-size: 1.05rem;
}

.wish-example cite {
    color: var(--color-primary-dark);
    font-style: normal;
    font-weight: 700;
    display: block;
    text-align: right;
    font-size: 0.95rem;
}

/* 16. CHAPTER NAVIGATION */
.chapter-nav {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 40px;
    padding-top: 20px;
    border-top: 2px solid rgba(244, 169, 68, 0.3);
    flex-wrap: wrap;
    gap: 20px;
}

.chapter-nav-btn {
    padding: 12px 24px;
    background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
    color: #3c1f0a;
    border: none;
    border-radius: 999px;
    font-family: inherit;
    font-size: 1rem;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s ease;
    min-width: 140px;
    justify-content: center;
    cursor: pointer;
}

.chapter-nav-btn.next {
    background: linear-gradient(135deg, var(--color-accent), var(--color-accent-dark));
    color: white;
}

.chapter-nav-btn:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
}

.chapter-nav-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.chapter-indicator {
    color: var(--color-primary-dark);
    font-weight: 600;
    font-size: 1rem;
    padding: 8px 16px;
    background: rgba(244, 169, 68, 0.1);
    border-radius: 999px;
    min-width: 140px;
    text-align: center;
}

/* 17. SITE FOOTER */
.site-footer {
    text-align: center;
    padding: 24px 0;
    border-top: 1px solid rgba(244, 169, 68, 0.3);
    color: var(--color-ink-muted);
    width: 100%;
    max-width: 1200px;
    margin: 40px auto 0;
}

.site-footer p {
    font-family: var(--font-secondary);
    font-size: 1.1rem;
    color: var(--color-dark);
    margin-bottom: var(--space-md);
}

.footer-links {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 16px;
    flex-wrap: wrap;
}

.footer-link {
    background: none;
    border: 1px solid rgba(244, 169, 68, 0.3);
    color: var(--color-ink-muted);
    padding: 8px 16px;
    border-radius: 20px;
    cursor: pointer;
    font-family: inherit;
    font-size: 0.9rem;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    text-decoration: none;
}

.footer-link:hover {
    background: rgba(244, 169, 68, 0.1);
    border-color: var(--color-primary);
    color: var(--color-ink);
}

/* 18. UTILITY CLASSES */
.hidden {
    display: none !important;
}

.text-center {
    text-align: center;
}

.flex-center {
    display: flex;
    align-items: center;
    justify-content: center;
}

/* 19. ANIMATIONS - SIMPLIFIED */
@keyframes pageEnter {
    from {
        opacity: 0;
        transform: translateX(-20px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(24px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes fadeInDown {
    from {
        opacity: 0;
        transform: translateY(-24px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes drip {
    0% {
        height: 0;
        opacity: 0;
    }
    50% {
        height: 18px;
        opacity: 1;
    }
    100% {
        height: 0;
        opacity: 0;
    }
}

@keyframes gentle-pulse {
    0%, 100% { transform: scale(1); opacity: 0.8; }
    50% { transform: scale(1.1); opacity: 1; }
}

@keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

@keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-8px); }
}

/* 20. RESPONSIVE DESIGN */
@media (max-width: 768px) {
    :root {
        --space-xl: 2.5rem;
    }
    
    body {
        padding: 18px 14px;
    }
    
    .hero-image-container {
        height: 300px;
        padding: var(--space-sm);
    }
    
    .hero-banner__img {
        width: 100%;
        height: auto;
    }
    
    .hero-panel {
        padding: var(--space-lg);
    }
    
    .hero-details-grid {
        grid-template-columns: 1fr;
    }
    
    .hero-actions {
        flex-direction: column;
    }
    
    .hero-action-btn {
        width: 100%;
    }
    
    .chapter-pill-row {
        grid-template-columns: 1fr;
    }
    
    .chapter-pill {
        flex-shrink: 0;
    }
    
    .book {
        padding: 20px 16px;
    }
    
    .page {
        padding: 20px;
    }
    
    .chapter-illustrations {
        grid-template-columns: 1fr;
    }
    
    .registry-grid {
        grid-template-columns: 1fr;
    }
    
    .form-grid {
        grid-template-columns: 1fr;
    }
    
    .chapter-nav {
        flex-direction: column;
        align-items: stretch;
        gap: 10px;
    }
    
    .chapter-indicator {
        order: -1;
        font-size: 0.88rem;
    }
    
    .game-embed {
        max-width: 100%;
        margin: 1rem auto;
        border-width: 2px;
        aspect-ratio: 3/4;
        min-height: 340px;
    }
    
    .footer-links {
        flex-direction: column;
        align-items: center;
        gap: 12px;
    }
    
    .footer-link {
        width: 200px;
        justify-content: center;
    }
    
    /* Remove heavy animations on mobile */
    .ambient-scene,
    .cloud-layer {
        display: none;
    }
}

/* Extra Small Phones */
@media (max-width: 400px) {
    .hero-image-container {
        height: 220px !important;
    }
    
    .masthead-title {
        font-size: 1.5rem !important;
    }
    
    .title-line--secondary {
        font-size: 1.2rem !important;
    }
    
    .chapter-title {
        font-size: 1.4rem !important;
    }
    
    .game-embed {
        aspect-ratio: 4/3;
        min-height: 280px;
    }
}

/* Landscape Mode */
@media (max-width: 768px) and (orientation: landscape) {
    body {
        padding: 8px !important;
    }
    
    .hero-image-container {
        height: 180px !important;
    }
    
    .game-embed {
        max-width: 80%;
        aspect-ratio: 16/9;
        min-height: 360px;
    }
    
    .chapter-illustrations {
        grid-template-columns: repeat(2, 1fr);
    }
}

/* 21. DARK MODE SUPPORT */
@media (prefers-color-scheme: dark) {
    :root {
        --color-primary: #ffb347;
        --color-primary-dark: #e89d2e;
        --color-primary-light: #ffd89b;
        --color-accent: #ff6b6b;
        --color-secondary: #7baa6f;
        --color-dark: #4a5e3f;
        --color-sky: #8ec0ff;
        --color-sky-light: #d4e6f5;
        --color-cream: #2a241c;
        --color-white: #3a342c;
        --color-ink: #e8dcc5;
        --color-ink-muted: #c8b9a0;
    }
    
    body {
        background: linear-gradient(180deg, #1a1610 0%, #2a241c 55%, #3a342c 100%);
    }
    
    .book {
        background: linear-gradient(90deg, #2a241c 0%, #3a342c 100%);
    }
    
    .page {
        background: var(--color-cream);
        color: var(--color-ink);
    }
    
    .storybook-figure {
        background: linear-gradient(180deg, rgba(42, 36, 28, 0.96), rgba(31, 26, 20, 0.92));
    }
}

/* 22. PRINT STYLES */
@media print {
    .ambient-scene,
    .cloud-layer,
    .game-embed,
    .chapter-nav,
    .hero-actions {
        display: none !important;
    }
    
    body {
        background: #fff !important;
        padding: 0 !important;
        font-size: 12pt;
    }
    
    .masthead-hero,
    .book-container,
    .chapter-tracker,
    .page {
        box-shadow: none !important;
        border: 1px solid #ddd !important;
        background: #fff !important;
        margin: 0 !important;
        padding: 0 !important;
    }
    
    .book {
        padding: 20px !important;
    }
    
    .page {
        break-inside: avoid;
        page-break-inside: avoid;
    }
    
    .story-text {
        font-size: 12pt !important;
        line-height: 1.6 !important;
    }
    
    .chapter-title {
        font-size: 16pt !important;
    }
}

/* 23. CONTENT VISIBILITY OPTIMIZATION */
.page:not(.active) {
    content-visibility: auto;
    contain-intrinsic-size: 600px;
}

/* 24. FIX FOR STICKY ELEMENTS */
.chapter-tracker.sticky {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    background: rgba(244, 169, 68, 0.95);
    backdrop-filter: blur(10px);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    padding: 1rem;
    animation: slideDown 0.3s ease-out;
}

.chapter-nav.sticky-bottom {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
    padding: 1rem;
    animation: slideUp 0.3s ease-out;
}

@keyframes slideDown {
    from { transform: translateY(-100%); }
    to { transform: translateY(0); }
}

@keyframes slideUp {
    from { transform: translateY(100%); }
    to { transform: translateY(0); }
}
</style>
</head>
<body>
<!-- Decorative Elements -->
<div aria-hidden="true" class="enhanced-scene" id="enhancedScene"></div>
<div aria-hidden="true" class="cloud-layer">
    <div class="cloud">‚òÅÔ∏è</div>
    <div class="cloud">‚òÅÔ∏è</div>
    <div class="cloud">‚òÅÔ∏è</div>
</div>

<!-- Settings Panel -->
<div class="settings-panel">
    <button class="settings-button" id="settingsButton" aria-label="Open settings">
        ‚öôÔ∏è
    </button>
</div>

<div class="settings-overlay" id="settingsOverlay">
    <div class="settings-card">
        <div class="settings-header">
            <h2>Game Settings</h2>
            <button class="close-settings" id="closeSettings" aria-label="Close settings">√ó</button>
        </div>

        <!-- Game Difficulty -->
        <section class="settings-section">
            <h3><span class="icon">üéÆ</span> Game Difficulty</h3>
            <div class="setting-option">
                <div class="setting-label">
                    <span>Difficulty Level</span>
                    <small>Adjusts jar speed, bee frequency, and time limit</small>
                </div>
                <select class="setting-select" id="difficultySelect">
                    <option value="easy">Easy</option>
                    <option value="medium" selected>Medium</option>
                    <option value="hard">Hard</option>
                    <option value="expert">Expert</option>
                </select>
            </div>
        </section>

        <!-- Sound & Music -->
        <section class="settings-section">
            <h3><span class="icon">üîä</span> Sound & Music</h3>
            <div class="setting-option">
                <div class="setting-label">
                    <span>Background Music</span>
                    <small>Play soothing Hundred Acre Wood music</small>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="musicToggle" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-option">
                <div class="setting-label">
                    <span>Sound Effects</span>
                    <small>Honey catches, bee buzzes, and game sounds</small>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="sfxToggle" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-option">
                <div class="setting-label">
                    <span>Volume Level</span>
                    <small>Adjust overall volume</small>
                </div>
                <div class="setting-range-row">
                    <input type="range" class="setting-range" id="volumeSlider" min="0" max="100" value="80">
                    <span class="setting-range-value" id="volumeValue">80%</span>
                </div>
            </div>
        </section>

        <!-- Visual Theme -->
        <section class="settings-section">
            <h3><span class="icon">üé®</span> Visual Theme</h3>
            <div class="theme-options">
                <div class="theme-option active" data-theme="light">
                    <span class="icon">‚òÄÔ∏è</span>
                    <span class="name">Light</span>
                </div>
                <div class="theme-option" data-theme="dark">
                    <span class="icon">üåô</span>
                    <span class="name">Dark</span>
                </div>
                <div class="theme-option" data-theme="auto">
                    <span class="icon">‚öôÔ∏è</span>
                    <span class="name">Auto</span>
                </div>
            </div>
        </section>

        <!-- Game Visuals -->
        <section class="settings-section">
            <h3><span class="icon">‚ú®</span> Visual Effects</h3>
            <div class="setting-option">
                <div class="setting-label">
                    <span>Particle Effects</span>
                    <small>Show honey sparkles and catch effects</small>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="particlesToggle" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-option">
                <div class="setting-label">
                    <span>Animations</span>
                    <small>Page transitions and character animations</small>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="animationsToggle" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-option">
                <div class="setting-label">
                    <span>Control Sensitivity</span>
                    <small>Adjust bear movement speed</small>
                </div>
                <div class="setting-range-row">
                    <input type="range" class="setting-range" id="sensitivitySlider" min="50" max="400" value="260" step="10">
                    <span class="setting-range-value" id="sensitivityValue">260</span>
                </div>
            </div>
        </section>

        <!-- Game Controls -->
        <section class="settings-section">
            <h3><span class="icon">üéØ</span> Game Controls</h3>
            <div class="setting-option">
                <div class="setting-label">
                    <span>Vibration (Mobile)</span>
                    <small>Haptic feedback on mobile devices</small>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="vibrationToggle">
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-option">
                <div class="setting-label">
                    <span>Show Mobile Controls</span>
                    <small>Display touch controls on mobile</small>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="mobileControlsToggle" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
        </section>

        <!-- Actions -->
        <div class="settings-actions">
            <button class="settings-btn secondary" id="resetSettingsBtn">
                <span>üîÅ</span> Reset to Defaults
            </button>
            <button class="settings-btn primary" id="applySettingsBtn">
                <span>üíæ</span> Apply Settings
            </button>
        </div>
    </div>
</div>

<!-- Hero Header -->
<header class="masthead-hero hero-enhancements">
    <!-- Hero Banner with Image and Title Overlay -->
    <div class="hero-banner">
        <div class="hero-image-container">
            <picture>
                <source sizes="80vw"
                        srcset="Images/Characters/Gunnar.png 800w, Images/Characters/Gunnar.png 1200w, Images/Characters/Gunnar.png 1600w">
                <img alt="Baby Gunnar with Hundred Acre Wood friends in the Hundred Acre Wood" class="hero-banner__img" height="900" loading="eager"
                     src="Images/Characters/Gunnar.png" width="800">
            </picture>
            <!-- Decorative corner elements -->
            <div aria-hidden="true" class="hero-corner-decoration top-left">üåø</div>
            <div aria-hidden="true" class="hero-corner-decoration top-right">üçØ</div>
            <div aria-hidden="true" class="hero-corner-decoration bottom-left">üíõ</div>
            <div aria-hidden="true" class="hero-corner-decoration bottom-right">üêù</div>
        </div>
        <!-- Title Container with Background -->
        <div class="hero-title-container">
            <div class="title-background">
                <h1 class="masthead-title">
                    <span class="title-line title-line--primary">Baby Gunnar's</span>
                    <span class="title-line title-line--secondary">Hundred Acre Wood Shower</span>
                </h1>
                <div aria-hidden="true" class="title-underline">
                    <span class="underline-dot">‚Ä¢</span>
                    <span class="underline-dot">‚Ä¢</span>
                    <span class="underline-dot">‚Ä¢</span>
                </div>
                <p class="hero-subtitle">A storybook celebration with Pooh & friends</p>
            </div>
        </div>
    </div>
    <!-- Decorative Elements -->
    <div aria-hidden="true" class="hero-sparkles" id="heroSparkles"></div>
    <div aria-hidden="true" class="hero-bunting">
        <span>‚ú®</span><span>üéà</span><span>üçØ</span><span>üíù</span><span>üß∏</span><span>üìñ</span><span>‚ú®</span>
    </div>
    <div aria-hidden="true" class="hero-sheen"></div>
    <!-- Hero Info Panel -->
    <div class="masthead-hero-inner">
        <section class="hero-panel">
            <!-- Event Badge -->
            <div class="hero-badge">
                <div aria-hidden="true" class="badge-icon">
                    <div class="badge-icon-inner">üéâ</div>
                </div>
                <div class="badge-copy">
                    <p class="badge-eyebrow">A Very Special</p>
                    <p class="badge-label">Hundred Acre Gathering</p>
                    <p class="badge-title">Virtual Baby Shower Celebration</p>
                </div>
                <div class="badge-meta">
                    <time class="badge-pill date" datetime="2025-06-15">
                        <span aria-hidden="true" class="pill-icon">üìÖ</span>
                        <span class="pill-text">June 15, 2025</span>
                    </time>
                    <div class="badge-pill location">
                        <span aria-hidden="true" class="pill-icon">üìç</span>
                        <span class="pill-text">Online Celebration</span>
                    </div>
                </div>
            </div>
            <!-- Hero Details Grid -->
            <div class="hero-details-grid">
                <div class="hero-detail">
                    <div aria-hidden="true" class="detail-icon">üìö</div>
                    <div class="detail-content">
                        <h4 class="detail-title">Interactive Storybook</h4>
                        <p class="detail-text">Read through four charming chapters</p>
                    </div>
                </div>
                <div class="hero-detail">
                    <div aria-hidden="true" class="detail-icon">üéÆ</div>
                    <div class="detail-content">
                        <h4 class="detail-title">Honey Game</h4>
                        <p class="detail-text">Help Pooh catch honey pots</p>
                    </div>
                </div>
                <div class="hero-detail">
                    <div aria-hidden="true" class="detail-icon">üéÅ</div>
                    <div class="detail-content">
                        <h4 class="detail-title">Gift Registry</h4>
                        <p class="detail-text">Share your wishes & blessings</p>
                    </div>
                </div>
            </div>
            <!-- Quick Actions -->
            <div class="hero-actions">
                <button class="hero-action-btn primary" onclick="scrollToChapter(1)">
                    <span aria-hidden="true" class="btn-icon">üìñ</span>
                    <span class="btn-text">Begin the Story</span>
                </button>
                <button class="hero-action-btn secondary" onclick="scrollToChapter(2)">
                    <span aria-hidden="true" class="btn-icon">üçØ</span>
                    <span class="btn-text">Play Honey Game</span>
                </button>
                <button class="hero-action-btn ghost" onclick="scrollToChapter(3)">
                    <span aria-hidden="true" class="btn-icon">üíù</span>
                    <span class="btn-text">View Registry</span>
                </button>
            </div>
            <!-- Orientation Hint -->
            <div class="orientation-hint">
                <div aria-hidden="true" class="hint-icon">üì±</div>
                <p class="hint-text">For the best experience: Rotate for wider game view, or stay in portrait for lovely
                    story reading.</p>
            </div>
        </section>
    </div>
</header>
<!-- Main Content -->
<main class="book-container" id="storybook">
    <!-- Chapter Navigation -->
    <nav aria-label="Story chapters" class="chapter-tracker">
        <h2 class="sr-only">Chapter navigation</h2>
        <div class="tracker-row">
            <div class="tracker-label">Story path</div>
            <div aria-valuemax="100" aria-valuemin="0" aria-valuenow="0" class="book-progress" role="progressbar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>
        <div class="chapter-pill-row">
            <button aria-current="page" class="chapter-pill sparkle active" data-chapter-target="1">
                <span class="pill-number">1</span>
                <span class="pill-text">
               <span class="pill-title">Welcome</span>
               <span class="pill-detail">Invitation arrives</span>
               </span>
            </button>
            <button class="chapter-pill sparkle" data-chapter-target="2">
                <span class="pill-number">2</span>
                <span class="pill-text">
               <span class="pill-title">Honey Hunt</span>
               <span class="pill-detail">Play the game</span>
               </span>
            </button>
            <button class="chapter-pill sparkle" data-chapter-target="3">
                <span class="pill-number">3</span>
                <span class="pill-text">
               <span class="pill-title">Gifts & Wishes</span>
               <span class="pill-detail">Registry & guestbook</span>
               </span>
            </button>
            <button class="chapter-pill sparkle" data-chapter-target="4">
                <span class="pill-number">4</span>
                <span class="pill-text">
               <span class="pill-title">Celebration</span>
               <span class="pill-detail">Welcome Gunnar</span>
               </span>
            </button>
        </div>
    </nav>
    <!-- Story Pages -->
    <div class="book">
        <div class="pages-wrapper">
            <!-- Chapter 1 -->
            <article class="page active" data-chapter="1">
                <header class="chapter-header">
                    <p class="chapter-number">Chapter One</p>
                    <h2 class="chapter-title">A Special Day in the Hundred Acre Wood</h2>
                    <p class="chapter-subtitle">An Invitation to Celebrate</p>
                    <span aria-hidden="true" class="honey-drip"></span>
                </header>
                <div class="page-content">
                    <p class="story-text">One fine spring day, in a corner of the Hundred Acre Wood where the sun shines
                        warmly through the trees and the flowers bloom in cheerful colors, something wonderful was
                        happening. All the forest friends were gathering, for there was to be a celebration unlike any
                        other.</p>
                    <p class="story-text">"What sort of celebration?" you might ask. Well, it was the very best sort‚Äîthe
                        kind that welcomes a new little friend to the world. A baby boy named Gunnar James was soon to
                        arrive, and everyone in the Hundred Acre Wood wanted to share in the joy.</p>
                    <div class="chapter-illustrations">
                        <figure class="storybook-figure figure-theme-honey clickable-character" data-character="pooh">
                            <img alt="Winnie the Pooh holding a honey pot" height="96"
                                 loading="eager" src="Images/Characters/honey-bear.png" width="96">
                            <figcaption class="figure-copy">
                                <div class="figure-name">Pooh brings the first pot</div>
                                <p class="figure-note">"A baby celebration needs extra honey," he whispered as he dusted
                                    off the lid.</p>
                            </figcaption>
                            <div aria-live="polite" class="character-message"></div>
                        </figure>
                        <figure class="storybook-figure figure-theme-sky clickable-character" data-character="piglet">
                            <img alt="Piglet carrying a welcome banner" height="96" loading="eager"
                                 src="Images/Characters/piglet.png" width="96">
                            <figcaption class="figure-copy">
                                <div class="figure-name">Piglet pins up the banner</div>
                                <p class="figure-note">He fluttered through the clearing making sure every friend felt
                                    warmly invited.</p>
                            </figcaption>
                            <div aria-live="polite" class="character-message"></div>
                        </figure>
                    </div>
                    <p class="story-text">Winnie the Pooh, being a Bear of Very Little Brain but a Very Big Heart, knew
                        that the most important thing for any celebration was honey. And not just a little honey, but
                        lots and lots of it. After all, welcoming Baby Gunnar was a Very Important Matter.</p>
                    <p class="story-text">"But first," thought Pooh, looking up at his honey pots on the high shelf,
                        "we'll need to gather more honey. Won't you help?"</p>
                    <div aria-hidden="true" class="divider">üå≥ ‚úø üêù ‚úø üå≥</div>
                </div>
            </article>
            <!-- Chapter 2: Game -->
            <!-- Chapter 2: Game -->
            <article class="page" data-chapter="2" id="honey-game">
                <header class="chapter-header">
                    <p class="chapter-number">Chapter Two</p>
                    <h2 class="chapter-title">Pooh's Honey Gathering Adventure</h2>
                    <p class="chapter-subtitle">A Game of Skill and Sweetness</p>
                    <span aria-hidden="true" class="honey-drip"></span>
                </header>
                <div class="chapter-illustrations">
                    <figure class="storybook-figure figure-theme-forest clickable-character" data-character="tigger">
                        <img alt="Tigger bouncing" height="96" loading="lazy" src="Images/Characters/tigger.png"
                             width="96">
                        <figcaption class="figure-copy">
                            <div class="figure-name">Tigger stakes out the course</div>
                            <p class="figure-note">He marked the path with springy footprints so every honey pot feels
                                like an adventure to catch.</p>
                        </figcaption>
                        <div aria-live="polite" class="character-message"></div>
                    </figure>
                    <figure class="storybook-figure figure-theme-honey clickable-character" data-character="roo">
                        <img alt="Roo cheering" height="96" loading="lazy" src="Images/Characters/roo.png" width="96">
                        <figcaption class="figure-copy">
                            <div class="figure-name">Roo cheers from the sidelines</div>
                            <p class="figure-note">"Mind the bees!" he giggled, handing out cozy scarves.</p>
                        </figcaption>
                        <div aria-live="polite" class="character-message"></div>
                    </figure>
                </div>

                <!-- Game Container -->
                <div class="game-inline-container" id="gameInlineContainer">
                    <!-- Game Settings Button -->
                    <div class="game-settings-button">
                        <button class="settings-button" id="gameSettingsButton" aria-label="Open game settings">
                            ‚öôÔ∏è
                        </button>
                    </div>

                    <!-- Game Background -->
                    <div class="game-bg-horizon"></div>
                    <div class="game-bg-ground"></div>

                    <!-- Game Start Overlay -->
                    <div class="game-start-overlay" id="gameStartOverlay">
                        <div class="game-start-card">
                            <h2 class="game-start-title">Ready to Hunt Honey?</h2>
                            <p class="game-start-subtitle">Help Pooh catch honey jars while avoiding bees!</p>
                            <button class="btn primary" id="gameStartButton">
                                <i aria-hidden="true" class="fas fa-play"></i>
                                <span>Start Game</span>
                            </button>
                            <div class="game-controls-hint">
                                <p><strong>Controls:</strong></p>
                                <p>‚Üê ‚Üí Arrow Keys or A/D to move</p>
                                <p>Space to pause</p>
                            </div>
                        </div>
                    </div>

                    <!-- Game HUD -->
                    <div aria-live="polite" class="game-hud" id="gameHUD">
                        <div class="game-hud-item">
                            <span class="game-hud-label">Score</span>
                            <span class="game-hud-value" id="gameScoreValue">0</span>
                        </div>
                        <div class="game-hud-item">
                            <span class="game-hud-label">Best</span>
                            <span class="game-hud-value" id="gameBestValue">0</span>
                        </div>
                        <div class="game-hud-item">
                            <span class="game-hud-label">Time</span>
                            <span class="game-hud-value" id="gameTimeValue">60</span>
                        </div>
                        <div class="game-hud-item">
                            <span class="game-hud-label">Lives</span>
                            <span class="game-hud-value" id="gameLivesValue">‚ô•‚ô•‚ô•</span>
                        </div>
                        <div class="game-hud-item">
                            <span class="game-hud-label">Streak</span>
                            <span class="game-hud-value" id="gameStreakValue">0</span>
                            <span class="streak-badge" id="gameStreakBadge">Combo!</span>
                        </div>
                    </div>

                    <!-- Game Canvas -->
                    <canvas aria-label="Honey Hunt playfield" id="gameCanvas" role="img"></canvas>

                    <!-- Game Pause Overlay -->
                    <div class="game-overlay" id="gamePauseOverlay">
                        <div class="game-overlay-card">
                            <h2 class="game-start-title">Game Paused</h2>
                            <p class="game-start-subtitle">The bees are waiting...</p>
                            <button class="btn primary" id="gameResumeButton">
                                <i aria-hidden="true" class="fas fa-play"></i>
                                <span>Resume</span>
                            </button>
                        </div>
                    </div>

                    <!-- Game Over Overlay -->
                    <div class="game-overlay" id="gameOverOverlay">
                        <div class="game-overlay-card">
                            <h2 class="game-start-title">Game Over!</h2>
                            <div class="game-over-stats">
                                <div class="game-over-label">Final Score</div>
                                <div class="game-over-score" id="finalGameScore">0</div>
                                <div class="game-over-best">
                                    Best: <span id="finalGameBest">0</span>
                                </div>
                            </div>
                            <button class="btn primary" id="gameRestartButton">
                                <i aria-hidden="true" class="fas fa-redo"></i>
                                <span>Play Again</span>
                            </button>
                        </div>
                    </div>

                    <!-- Mobile Controls -->
                    <div class="mobile-controls" id="mobileControls">
                        <button class="mobile-control-btn" id="mobileLeftBtn">
                            <i aria-hidden="true" class="fas fa-arrow-left"></i>
                        </button>
                        <button class="mobile-control-btn mobile-control-pause" id="mobilePauseBtn">
                            <i aria-hidden="true" class="fas fa-pause"></i>
                        </button>
                        <button class="mobile-control-btn" id="mobileRightBtn">
                            <i aria-hidden="true" class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                <div class="game-critique" aria-live="polite">
                    <div class="critique-header">
                        <div class="critique-kicker">Run critique</div>
                        <p class="critique-summary" id="critiqueSummary">Finish a run to unlock tips</p>
                    </div>
                    <ul class="critique-list" id="critiqueList">
                        <li>Collect honey and avoid bees to see how you did.</li>
                    </ul>
                </div>

                <div class="game-description">
                    <h3>How to Play</h3>
                    <p>Help Winnie the Pooh collect honey pots while avoiding bees! Move left and right with arrow keys
                        or on-screen controls. Chain catches to build combos for higher scores. Watch for special jars
                        that grant shields and power-ups!</p>
                    <div class="game-tips">
                        <div class="tip">
                            <span class="tip-icon">üéØ</span>
                            <p><strong>Goal:</strong> Score as many points as you can in 60 seconds!</p>
                        </div>
                        <div class="tip">
                            <span class="tip-icon">üõ°Ô∏è</span>
                            <p><strong>Blue Jars:</strong> Give temporary shield protection</p>
                        </div>
                        <div class="tip">
                            <span class="tip-icon">‚ú®</span>
                            <p><strong>Power-ups:</strong> Special jars give amazing abilities</p>
                        </div>
                    </div>
                </div>
            </article>
            <!-- Chapter 3: Gifts & Wishes -->
            <article class="page" data-chapter="3">
                <header class="chapter-header">
                    <p class="chapter-number">Chapter Three</p>
                    <h2 class="chapter-title">Gifts from the Heart</h2>
                    <p class="chapter-subtitle">Preparing for Baby Gunnar's Arrival</p>
                    <span aria-hidden="true" class="honey-drip"></span>
                </header>
                <div class="page-content">
                    <section class="story-section">
                        <p class="story-text">Back in the Hundred Acre Wood, Pooh sat thoughtfully by his honey pots.
                            "Honey is wonderful," he mused, "but I wonder what else a growing bear‚Äîoh, I mean baby‚Äîmight
                            need?"</p>
                        <p class="story-text">Just then, Piglet came scurrying up, holding something soft. "I was
                            thinking, Pooh," he said in his small voice, "perhaps something cozy for chilly
                            evenings?"</p>
                        <div class="dialogue-bubble dialogue-piglet">
                            <div class="bubble-arrow"></div>
                            <p>"Something soft and warm, for when the wind howls!"</p>
                            <span class="speaker">‚Äî Piglet</span>
                        </div>
                    </section>
                    <div class="chapter-illustrations">
                        <figure class="storybook-figure figure-theme-forest clickable-character"
                                data-character="piglet">
                            <img alt="Piglet with blanket" height="96" loading="lazy" src="Images/Characters/piglet.png"
                                 width="96">
                            <figcaption class="figure-copy">
                                <div class="figure-name">Piglet's Cozy Corner</div>
                                <p class="figure-note">Found the snuggliest blanket in all the Wood.</p>
                            </figcaption>
                            <div aria-live="polite" class="character-message"></div>
                        </figure>
                        <figure class="storybook-figure figure-theme-honey clickable-character" data-character="pooh">
                            <img alt="Pooh thinking" height="96" loading="lazy" src="Images/Characters/honey-bear.png"
                                 width="96">
                            <figcaption class="figure-copy">
                                <div class="figure-name">Pooh's Pondering</div>
                                <p class="figure-note">Thinking of practical things (between honey snacks).</p>
                            </figcaption>
                            <div aria-live="polite" class="character-message"></div>
                        </figure>
                        <figure class="storybook-figure figure-theme-sky clickable-character" data-character="tigger">
                            <img alt="Tigger bouncing" height="96" loading="lazy" src="Images/Characters/tigger.png"
                                 width="96">
                            <figcaption class="figure-copy">
                                <div class="figure-name">Tigger's Toys</div>
                                <p class="figure-note">Bounced in with the bounciest ideas!</p>
                            </figcaption>
                            <div aria-live="polite" class="character-message"></div>
                        </figure>
                    </div>
                    <section class="story-section">
                        <p class="story-text">Soon, all the friends had gathered with their ideas. Tigger bounced about
                            toys that bounce, Eeyore suggested "something useful that won't blow away," and Rabbit began
                            making a very organized list.</p>
                        <div class="dialogue-bubble dialogue-pooh">
                            <div class="bubble-arrow"></div>
                            <p>"The most important thing," said Pooh wisely, "is that Baby Gunnar knows he is surrounded
                                by love. But if you'd like to bring something special, his parents have shared a few
                                ideas that would be helpful."</p>
                            <span class="speaker">‚Äî Pooh Bear</span>
                        </div>
                    </section>
                    <div class="registry-container">
                        <aside class="registry-section">
                            <div class="registry-header">
                                <div aria-hidden="true" class="registry-icon">üéÅ</div>
                                <div>
                                    <h3>Baby Gunnar's Registry</h3>
                                    <p class="registry-subtitle">Your presence is the greatest present, but if you'd
                                        like to contribute to his woodland adventures:</p>
                                </div>
                            </div>
                            <div class="registry-grid">
                                <a class="registry-card" href="https://my.babylist.com/lea-hardesty" rel="noopener"
                                   target="_blank">
                                    <div class="card-icon">üéØ</div>
                                    <div class="card-content">
                                        <h4>babylist Registry</h4>
                                        <p>For everyday essentials and nursery items</p>
                                        <span class="card-link">Browse registry ‚Üí</span>
                                    </div>
                                </a>
                                <div class="registry-card gift-idea-card">
                                    <div class="card-icon">üíù</div>
                                    <div class="card-content">
                                        <h4>Gift Ideas</h4>
                                        <ul class="gift-ideas">
                                            <li>Board books & stories</li>
                                            <li>Woodland-themed clothing</li>
                                            <li>Soft blankets & swaddles</li>
                                            <li>Diapers & essentials</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </aside>
                    </div>
                    <section class="nursery-details">
                        <h3><span aria-hidden="true">üß∏</span> Nursery Details</h3>
                        <div class="details-grid">
                            <div class="detail-card">
                                <div class="detail-icon">üé®</div>
                                <div class="detail-content">
                                    <h4>Theme</h4>
                                    <p>Hundred Acre Wood Adventures</p>
                                    <small>Featuring Winnie the Pooh & friends</small>
                                </div>
                            </div>
                            <div class="detail-card">
                                <div class="detail-icon">üåà</div>
                                <div class="detail-content">
                                    <h4>Colors</h4>
                                    <p>Honey gold, Pooh red, sage green, cream</p>
                                    <small>Soft & soothing woodland palette</small>
                                </div>
                            </div>
                            <div class="detail-card">
                                <div class="detail-icon">üìö</div>
                                <div class="detail-content">
                                    <h4>Favorite Items</h4>
                                    <p>Swaddles, sleepers, board books, cozy blankets</p>
                                </div>
                            </div>
                            <div class="detail-card">
                                <div class="detail-icon">üìç</div>
                                <div class="detail-content">
                                    <h4>Location</h4>
                                    <p>Arizona</p>
                                    <small>Where adventures begin</small>
                                </div>
                            </div>
                        </div>
                    </section>
                    <section class="wishes-section">
                        <div class="wishes-header">
                            <h3>Share Your Wishes <span aria-hidden="true">‚ú®</span></h3>
                            <p>Leave wisdom, well-wishes, or favorite childhood memories for Gunnar's storybook</p>
                        </div>
                        <div class="wishes-form-container">
                            <form class="enhanced-form" id="wishesForm">
                                <div class="form-grid">
                                    <div class="form-field">
                                        <label for="guestName">Your Name</label>
                                        <input id="guestName" placeholder="How should we call you?" required
                                               type="text">
                                    </div>
                                    <div class="form-field">
                                        <label for="guestRelation">Your Relation</label>
                                        <select id="guestRelation">
                                            <option value="">Choose one...</option>
                                            <option value="family">Family</option>
                                            <option value="friend">Friend</option>
                                            <option value="colleague">Colleague</option>
                                            <option value="woodland-friend">Woodland Friend</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-field">
                                    <label for="wishMessage">Your Message</label>
                                    <textarea id="wishMessage" placeholder="What wisdom or wishes would you like to share with Baby Gunnar?..."
                                              required
                                              rows="4"></textarea>
                                    <div class="character-count">0/500 characters</div>
                                </div>
                                <div class="form-actions">
                                    <button class="submit-btn" type="submit">
                                        <span aria-hidden="true">üìù</span> Add to Gunnar's Storybook
                                    </button>
                                    <div aria-live="polite" class="form-feedback" id="wishFeedback" role="status"></div>
                                </div>
                            </form>
                        </div>
                        <div class="sample-wishes">
                            <h4>Wishes from the Wood:</h4>
                            <div class="wish-examples">
                                <blockquote class="wish-example">
                                    <p>"May your days be filled with wonder and your nights with sweet dreams."</p>
                                    <cite>‚Äî Owl</cite>
                                </blockquote>
                                <blockquote class="wish-example">
                                    <p>"Remember: even the smallest creatures can have the biggest hearts."</p>
                                    <cite>‚Äî Piglet</cite>
                                </blockquote>
                            </div>
                        </div>
                    </section>
                    <div class="wishes-display" id="wishesDisplay">
                        <!-- Dynamic wishes will appear here -->
                    </div>
                </div>
            </article>
            <!-- Chapter 4: Celebration -->
            <article class="page" data-chapter="4">
                <header class="chapter-header">
                    <p class="chapter-number">Chapter Four</p>
                    <h2 class="chapter-title">The Gathering</h2>
                    <p class="chapter-subtitle">Celebrating What's to Come</p>
                    <span aria-hidden="true" class="honey-drip"></span>
                </header>
                <div class="page-content">
                    <p class="story-text">As the sun began to set over the Hundred Acre Wood, casting long golden
                        shadows through the trees, Pooh and his friends gathered to celebrate the coming arrival of Baby
                        Gunnar.</p>
                    <div class="chapter-illustrations">
                        <figure class="storybook-figure figure-theme-honey clickable-character" data-character="pooh">
                            <img alt="Pooh with honey pot" height="96" loading="lazy" src="Images/Characters/honey-bear.png"
                                 width="96">
                            <figcaption class="figure-copy">
                                <div class="figure-name">Pooh's special pot</div>
                                <p class="figure-note">He saved one golden pot for Gunnar's first visit.</p>
                            </figcaption>
                            <div aria-live="polite" class="character-message"></div>
                        </figure>
                        <figure class="storybook-figure figure-theme-sky clickable-character" data-character="gunnar">
                            <img alt="Baby Gunnar" height="96" loading="lazy" src="Images/Characters/Gunnar.png"
                                 width="96">
                            <figcaption class="figure-copy">
                                <div class="figure-name">Coming Soon</div>
                                <p class="figure-note">The Hundred Acre Wood awaits its newest friend.</p>
                            </figcaption>
                            <div aria-live="polite" class="character-message"></div>
                        </figure>
                    </div>
                    <p class="story-text">With honey gathered, gifts prepared, and wishes shared, everyone in the
                        Hundred Acre Wood looked forward to the day they would meet Baby Gunnar. For as Pooh always
                        said, "How lucky I am to have something to look forward to."</p>
                    <div class="welcome-panel">
                        <div aria-hidden="true" class="welcome-icon">üåü</div>
                        <h3 class="welcome-heading">We Can't Wait to Meet You!</h3>
                        <p class="welcome-subtitle">Baby Gunnar, your adventure in the Hundred Acre Wood is about to
                            begin</p>
                    </div>
                    <section class="countdown-section">
                        <h3>Until We Meet üêª</h3>
                        <div class="countdown-display">
                            <div class="countdown-item">
                                <span class="countdown-number" id="days">--</span>
                                <span class="countdown-label">Days</span>
                            </div>
                            <div class="countdown-item">
                                <span class="countdown-number" id="hours">--</span>
                                <span class="countdown-label">Hours</span>
                            </div>
                        </div>
                        <p class="countdown-note">Expected arrival:
                            <time datetime="2025-08">Late August 2025</time>
                        </p>
                    </section>
                    <div class="honey-jar-interactive">
                        <div aria-hidden="true">üçØ</div>
                        <h3>Gunnar's Honey Jar of Hopes</h3>
                        <p>Share your hopes and dreams for Baby Gunnar's future adventures.</p>
                        <button class="btn primary" id="addHopeBtn">‚ûï Add Your Hope</button>
                    </div>
                    <aside class="final-thought">
                        <blockquote>
                            <p>"Sometimes the smallest things take up the most room in your heart."<br>
                                <cite>‚Äî Winnie the Pooh</cite>
                            </p>
                        </blockquote>
                        <p class="signature">With love from all your friends in the Hundred Acre Wood</p>
                    </aside>
                </div>
            </article>
        </div>
        <!-- Navigation -->
        <nav aria-label="Page navigation" class="chapter-nav">
            <button class="chapter-nav-btn" id="prevBtn">‚Üê Previous</button>
            <div class="chapter-indicator" id="pageIndicator">Chapter 1 of 4</div>
            <button class="chapter-nav-btn next" id="nextBtn">Next ‚Üí</button>
        </nav>
    </div>
</main>
<!-- Footer -->
<footer class="site-footer">
    <p>Made with üíô and üçØ for Baby Gunnar's special day</p>
    <div class="footer-links">
        <button class="footer-link" id="printPageBtn">üñ® Print</button>
        <button class="footer-link" id="sharePageBtn">üì§ Share</button>
        <button class="footer-link" id="toggleAnimationsBtn">üé≠ Animations</button>
    </div>
</footer>

<!-- Game Script -->
<script>
    // Honey Hunt Game - Simplified Version
    (function() {
        "use strict";

        // Game variables
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const gameContainer = document.getElementById('gameInlineContainer');
        const gameStartOverlay = document.getElementById('gameStartOverlay');
        const gameStartButton = document.getElementById('gameStartButton');
        const gameHUD = document.getElementById('gameHUD');
        const gamePauseOverlay = document.getElementById('gamePauseOverlay');
        const gameOverOverlay = document.getElementById('gameOverOverlay');
        const gameResumeButton = document.getElementById('gameResumeButton');
        const gameRestartButton = document.getElementById('gameRestartButton');
        const mobileControls = document.getElementById('mobileControls');
        const mobileLeftBtn = document.getElementById('mobileLeftBtn');
        const mobileRightBtn = document.getElementById('mobileRightBtn');
        const mobilePauseBtn = document.getElementById('mobilePauseBtn');
        const critiqueSummary = document.getElementById('critiqueSummary');
        const critiqueList = document.getElementById('critiqueList');

        // Game state
        let gameState = {
            running: false,
            paused: false,
            timeLeft: 60,
            score: 0,
            best: localStorage.getItem('honeyHuntBest') || 0,
            streak: 0,
            lives: 3,
            shieldTime: 0
        };

        const defaultCritique = {
            summary: 'Finish a run to unlock tips',
            bullets: ['Collect honey and avoid bees to see how you did.']
        };

        const runStats = {
            jarsCaught: 0,
            goldCaught: 0,
            shieldsCaught: 0,
            beesBumped: 0,
            maxStreak: 0
        };

        function resetRunStats() {
            runStats.jarsCaught = 0;
            runStats.goldCaught = 0;
            runStats.shieldsCaught = 0;
            runStats.beesBumped = 0;
            runStats.maxStreak = 0;
            renderCritique(defaultCritique.summary, defaultCritique.bullets);
        }

        function renderCritique(summary, bulletPoints) {
            if (critiqueSummary) {
                critiqueSummary.textContent = summary;
            }

            if (critiqueList) {
                critiqueList.innerHTML = '';
                bulletPoints.forEach((point) => {
                    const li = document.createElement('li');
                    li.textContent = point;
                    critiqueList.appendChild(li);
                });
            }
        }

        function buildRunCritique() {
            const bullets = [];

            const summary = gameState.score >= 240
                ? 'Sweet scoring spree!'
                : gameState.score >= 160
                    ? 'Solid honey haul!'
                    : 'Warm-up jog complete ‚Äî more honey awaits.';

            const safetyNote = runStats.beesBumped === 0
                ? 'Stayed sting-free‚Äînimble dodging!'
                : `Bee bumps: ${runStats.beesBumped}. Weaving and shields keep Pooh cozy.`;
            bullets.push(safetyNote);

            const streakNote = runStats.maxStreak >= 6
                ? `Built a cozy combo of x${runStats.maxStreak}‚Äîkeep chaining catches.`
                : runStats.maxStreak >= 3
                    ? `Nice combo rhythm at x${runStats.maxStreak}; keep jars flowing for bigger boosts.`
                    : 'Try catching back-to-back honey to build a combo bonus.';
            bullets.push(streakNote);

            const haulNote = gameState.score >= 200
                ? 'Honey haul was plentiful‚Äîsweet pace!'
                : gameState.score >= 110
                    ? 'Solid honey haul; chase a few more pots next run.'
                    : 'Slide under falling honey more often to grow your haul.';
            bullets.push(haulNote);

            const shieldNote = runStats.shieldsCaught > 0
                ? `Shields collected: ${runStats.shieldsCaught}. Great for shrugging off bees!`
                : 'Snag blue jars for a shield when bees get busy.';
            bullets.push(shieldNote);

            return { summary, bullets };
        }

        // Game objects
        const bear = {
            x: 0,
            y: 0,
            width: 40,
            height: 60,
            speed: 260,
            vx: 0
        };

        const jars = [];
        const bees = [];
        const particles = [];

        // Control keys
        const keys = {
            left: false,
            right: false
        };

        // Initialize game
        function initGame() {
            // Set canvas size
            resizeCanvas();

            // Initialize bear position
            bear.x = canvas.width / 2;
            bear.y = canvas.height * 0.85;

            // Apply sensitivity from settings
            if (window.getGameSettings) {
                const settings = window.getGameSettings();
                bear.speed = settings.sensitivity || 260;
            }

            // Clear arrays
            jars.length = 0;
            bees.length = 0;
            particles.length = 0;

            // Reset game state with difficulty settings
            const difficulty = window.gameDifficulty || {
                timeLimit: 60,
                lives: 3
            };

            gameState.timeLeft = difficulty.timeLimit || 60;
            gameState.score = 0;
            gameState.streak = 0;
            gameState.lives = difficulty.lives || 3;
            gameState.shieldTime = 0;

            resetRunStats();

            // Update HUD
            updateHUD();

            // Show start overlay
            gameStartOverlay.classList.remove('hidden');
            gameHUD.classList.remove('visible');
            mobileControls.classList.remove('visible');
            gamePauseOverlay.classList.remove('visible');
            gameOverOverlay.classList.remove('visible');

            // Show mobile controls based on settings
            if (window.getGameSettings) {
                const settings = window.getGameSettings();
                if (settings.mobileControls && ('ontouchstart' in window || navigator.maxTouchPoints > 0)) {
                    mobileControls.classList.add('visible');
                }
            }
        }

        // Start game
        function startGame() {
            gameState.running = true;
            gameState.paused = false;
            gameStartOverlay.classList.add('hidden');
            gameHUD.classList.add('visible');
            gamePauseOverlay.classList.remove('visible');
            gameOverOverlay.classList.remove('visible');

            // Start game loop
            lastTimestamp = performance.now();
            requestAnimationFrame(gameLoop);
        }

        // Pause game
        function pauseGame() {
            if (!gameState.running) return;
            gameState.paused = true;
            gamePauseOverlay.classList.add('visible');
        }

        // Resume game
        function resumeGame() {
            if (!gameState.running) return;
            gameState.paused = false;
            gamePauseOverlay.classList.remove('visible');
            lastTimestamp = performance.now();
            requestAnimationFrame(gameLoop);
        }

        // End game
        function endGame() {
            gameState.running = false;

            // Update best score
            if (gameState.score > gameState.best) {
                gameState.best = gameState.score;
                localStorage.setItem('honeyHuntBest', gameState.best);
            }

            // Update final score display
            document.getElementById('finalGameScore').textContent = gameState.score;
            document.getElementById('finalGameBest').textContent = gameState.best;

            // Show game over overlay
            gameOverOverlay.classList.add('visible');
            gameHUD.classList.remove('visible');

            const critique = buildRunCritique();
            renderCritique(critique.summary, critique.bullets);
        }

        // Resize canvas
        function resizeCanvas() {
            const rect = gameContainer.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = rect.height;
        }

        // Update HUD
        function updateHUD() {
            document.getElementById('gameScoreValue').textContent = gameState.score;
            document.getElementById('gameBestValue').textContent = gameState.best;
            document.getElementById('gameTimeValue').textContent = Math.max(0, Math.floor(gameState.timeLeft));
            document.getElementById('gameStreakValue').textContent = gameState.streak;

            // Update lives display
            const livesValue = document.getElementById('gameLivesValue');
            const full = "‚ô•".repeat(gameState.lives);
            const empty = "‚ô°".repeat(3 - gameState.lives);
            livesValue.textContent = full + empty;

            // Update streak badge
            const streakBadge = document.getElementById('gameStreakBadge');
            if (gameState.streak >= 5) {
                streakBadge.classList.add('visible');
            } else {
                streakBadge.classList.remove('visible');
            }
        }

        // Draw functions
        function drawBear() {
            ctx.save();
            ctx.translate(bear.x, bear.y);

            // Draw bear body
            ctx.fillStyle = '#fbbf24';
            ctx.beginPath();
            ctx.ellipse(0, -10, 25, 35, 0, 0, Math.PI * 2);
            ctx.fill();

            // Draw head
            ctx.fillStyle = '#fbbf24';
            ctx.beginPath();
            ctx.arc(0, -48, 20, 0, Math.PI * 2);
            ctx.fill();

            // Draw ears
            ctx.fillStyle = '#f59e0b';
            ctx.beginPath();
            ctx.arc(-12, -60, 8, 0, Math.PI * 2);
            ctx.arc(12, -60, 8, 0, Math.PI * 2);
            ctx.fill();

            // Draw face
            ctx.fillStyle = '#1f2937';
            ctx.beginPath();
            ctx.arc(-8, -52, 3, 0, Math.PI * 2);
            ctx.arc(8, -52, 3, 0, Math.PI * 2);
            ctx.fill();

            // Draw mouth (smile)
            ctx.strokeStyle = '#1f2937';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(0, -45, 6, 0.2, Math.PI - 0.2);
            ctx.stroke();

            // Draw honey jar
            ctx.fillStyle = '#b45309';
            ctx.fillRect(-20, 0, 40, 30);

            ctx.fillStyle = '#f59e0b';
            ctx.fillRect(-18, 2, 36, 26);

            ctx.restore();

            // Draw shield if active
            if (gameState.shieldTime > 0) {
                ctx.save();
                ctx.translate(bear.x, bear.y - 10);

                ctx.strokeStyle = '#38bdf8';
                ctx.lineWidth = 3;
                ctx.globalAlpha = 0.6;
                ctx.beginPath();
                ctx.arc(0, 0, 35, 0, Math.PI * 2);
                ctx.stroke();

                ctx.restore();
            }
        }

        function drawJar(x, y, type = 'normal') {
            ctx.save();
            ctx.translate(x, y);

            let color = '#fbbf24';
            if (type === 'gold') color = '#f59e0b';
            if (type === 'shield') color = '#38bdf8';

            // Jar body
            ctx.fillStyle = color;
            ctx.fillRect(-10, -20, 20, 40);

            // Jar lid
            ctx.fillStyle = '#92400e';
            ctx.fillRect(-12, -25, 24, 5);

            // Honey inside
            ctx.fillStyle = '#d97706';
            ctx.fillRect(-8, 0, 16, 15);

            ctx.restore();
        }

        function drawBee(x, y) {
            ctx.save();
            ctx.translate(x, y);

            // Bee body
            ctx.fillStyle = '#fbbf24';
            ctx.beginPath();
            ctx.ellipse(0, 0, 12, 8, 0, 0, Math.PI * 2);
            ctx.fill();

            // Bee stripes
            ctx.fillStyle = '#1f2937';
            ctx.fillRect(-10, -2, 20, 4);

            // Bee wings
            ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';
            ctx.beginPath();
            ctx.ellipse(-6, -10, 8, 5, Math.PI/4, 0, Math.PI * 2);
            ctx.ellipse(6, -10, 8, 5, -Math.PI/4, 0, Math.PI * 2);
            ctx.fill();

            ctx.restore();
        }

        // Game loop
        let lastTimestamp = 0;

        function gameLoop(timestamp) {
            if (!gameState.running || gameState.paused) return;

            const dt = (timestamp - lastTimestamp) / 1000;
            lastTimestamp = timestamp;

            // Update game state
            updateGame(dt);

            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw game objects
            drawBear();

            // Draw jars
            for (const jar of jars) {
                drawJar(jar.x, jar.y, jar.type);
            }

            // Draw bees
            for (const bee of bees) {
                drawBee(bee.x, bee.y);
            }

            // Draw particles if enabled
            if (window.getGameSettings && window.getGameSettings().particles !== false) {
                for (const p of particles) {
                    ctx.save();
                    ctx.translate(p.x, p.y);
                    ctx.fillStyle = p.color;
                    ctx.globalAlpha = p.life;
                    ctx.fillRect(-2, -2, 4, 4);
                    ctx.restore();
                }
            }

            // Continue game loop
            if (gameState.running && !gameState.paused) {
                requestAnimationFrame(gameLoop);
            }
        }

        function updateGame(dt) {
            // Update time
            gameState.timeLeft -= dt;
            if (gameState.timeLeft <= 0) {
                gameState.timeLeft = 0;
                endGame();
                return;
            }

            // Update shield
            if (gameState.shieldTime > 0) {
                gameState.shieldTime -= dt;
            }

            // Use difficulty settings if available
            const difficulty = window.gameDifficulty || {
                jarSpawnRate: 0.02,
                jarSpeed: { min: 150, max: 200 },
                beeSpawnRate: 0.01,
                beeSpeed: { min: 100, max: 150 },
                timeLimit: 60,
                lives: 3
            };

            // Spawn jars with difficulty settings
            if (Math.random() < difficulty.jarSpawnRate) {
                const type = Math.random() < 0.1 ? 'gold' : Math.random() < 0.15 ? 'shield' : 'normal';
                jars.push({
                    x: Math.random() * (canvas.width - 40) + 20,
                    y: -20,
                    vy: difficulty.jarSpeed.min + Math.random() * (difficulty.jarSpeed.max - difficulty.jarSpeed.min),
                    type: type
                });
            }

            // Spawn bees with difficulty settings
            if (Math.random() < difficulty.beeSpawnRate) {
                bees.push({
                    x: Math.random() < 0.5 ? -20 : canvas.width + 20,
                    y: Math.random() * canvas.height * 0.6 + 50,
                    vx: (Math.random() < 0.5 ? -1 : 1) * (difficulty.beeSpeed.min + Math.random() * (difficulty.beeSpeed.max - difficulty.beeSpeed.min)),
                    vy: 0
                });
            }

            // Update bear position
            if (keys.left) bear.vx = -bear.speed;
            else if (keys.right) bear.vx = bear.speed;
            else bear.vx = 0;

            bear.x += bear.vx * dt;
            bear.x = Math.max(20, Math.min(canvas.width - 20, bear.x));

            // Update jars
            for (let i = jars.length - 1; i >= 0; i--) {
                const jar = jars[i];
                jar.y += jar.vy * dt;

                // Check collision with bear
                const dx = jar.x - bear.x;
                const dy = jar.y - (bear.y - 20);
                const distance = Math.sqrt(dx * dx + dy * dy);

                if (distance < 30) {
                    // Jar caught!
                    jars.splice(i, 1);
                    gameState.score += jar.type === 'gold' ? 30 : jar.type === 'shield' ? 15 : 10;
                    gameState.streak++;
                    runStats.jarsCaught++;
                    if (jar.type === 'gold') {
                        runStats.goldCaught++;
                    }

                    if (jar.type === 'shield') {
                        runStats.shieldsCaught++;
                        gameState.shieldTime = 5;
                    }

                    runStats.maxStreak = Math.max(runStats.maxStreak, gameState.streak);

                    // Create particles if enabled
                    if (window.getGameSettings && window.getGameSettings().particles !== false) {
                        for (let j = 0; j < 10; j++) {
                            particles.push({
                                x: jar.x,
                                y: jar.y,
                                vx: (Math.random() - 0.5) * 200,
                                vy: -100 - Math.random() * 100,
                                color: jar.type === 'gold' ? '#f59e0b' : jar.type === 'shield' ? '#38bdf8' : '#fbbf24',
                                life: 1
                            });
                        }
                    }

                    // Play sound if enabled
                    if (window.getGameSettings && window.getGameSettings().sfx !== false) {
                        const honeySound = document.getElementById('honeySound');
                        if (honeySound) {
                            honeySound.currentTime = 0;
                            honeySound.play().catch(e => console.log('Sound play failed:', e));
                        }
                    }
                }

                // Remove off-screen jars
                if (jar.y > canvas.height + 50) {
                    jars.splice(i, 1);
                    gameState.streak = 0;
                }
            }

            // Update bees
            for (let i = bees.length - 1; i >= 0; i--) {
                const bee = bees[i];
                bee.x += bee.vx * dt;

                // Check collision with bear
                const dx = bee.x - bear.x;
                const dy = bee.y - bear.y;
                const distance = Math.sqrt(dx * dx + dy * dy);

                if (distance < 25) {
                    // Bee hit!
                    bees.splice(i, 1);

                    if (gameState.shieldTime > 0) {
                        gameState.shieldTime = 0;
                    } else {
                        runStats.beesBumped++;
                        gameState.lives--;
                        gameState.streak = 0;

                        if (gameState.lives <= 0) {
                            endGame();
                            return;
                        }
                    }
                }

                // Remove off-screen bees
                if (bee.x < -50 || bee.x > canvas.width + 50) {
                    bees.splice(i, 1);
                }
            }

            // Update particles
            for (let i = particles.length - 1; i >= 0; i--) {
                const p = particles[i];
                p.x += p.vx * dt;
                p.y += p.vy * dt;
                p.vy += 200 * dt;
                p.life -= dt;

                if (p.life <= 0) {
                    particles.splice(i, 1);
                }
            }

            // Update HUD
            updateHUD();
        }

        // Event listeners
        gameStartButton.addEventListener('click', startGame);
        gameResumeButton.addEventListener('click', resumeGame);
        gameRestartButton.addEventListener('click', () => {
            initGame();
            startGame();
        });        // Keyboard controls - FOR THE GAME
        document.addEventListener('keydown', (e) => {
            // Only handle game controls if we're in Chapter 2 AND game is running
            const gamePage = document.querySelector('.page[data-chapter="2"]');
            const isInGame = gamePage && gamePage.classList.contains('active');

            if (isInGame && gameState.running && !gameState.paused) {
                if (e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') {
                    e.preventDefault(); // Prevent chapter navigation
                    keys.left = true;
                } else if (e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') {
                    e.preventDefault(); // Prevent chapter navigation
                    keys.right = true;
                } else if (e.key === ' ' || e.key === 'Spacebar') {
                    e.preventDefault();
                    pauseGame();
                }
            }
        });

        document.addEventListener('keyup', (e) => {
            const gamePage = document.querySelector('.page[data-chapter="2"]');
            const isInGame = gamePage && gamePage.classList.contains('active');

            if (isInGame) {
                if (e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') {
                    e.preventDefault();
                    keys.left = false;
                } else if (e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') {
                    e.preventDefault();
                    keys.right = false;
                }
            }
        });

        // Mobile controls
        mobileLeftBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            keys.left = true;
        });

        mobileLeftBtn.addEventListener('touchend', (e) => {
            e.preventDefault();
            keys.left = false;
        });

        mobileRightBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            keys.right = true;
        });

        mobileRightBtn.addEventListener('touchend', (e) => {
            e.preventDefault();
            keys.right = false;
        });

        mobilePauseBtn.addEventListener('click', pauseGame);

        // Initialize game when page loads
        window.addEventListener('load', initGame);
        window.addEventListener('resize', resizeCanvas);

        // Make game functions available to chapter navigation
        window.initHoneyGame = initGame;
        window.pauseHoneyGame = pauseGame;
    })();

    // Storybook chapter navigation
    document.addEventListener("DOMContentLoaded", () => {
        const pages = [...document.querySelectorAll(".page")];
        const nextBtn = document.getElementById("nextBtn");
        const prevBtn = document.getElementById("prevBtn");
        const indicator = document.getElementById("pageIndicator");
        const progress = document.getElementById("progressFill");
        const pageTurnSound = document.getElementById("pageSound");
        const total = pages.length;
        let current = 0;

        function playPageTurn() {
            const settings = typeof window.getGameSettings === 'function'
                ? window.getGameSettings()
                : null;

            const allowSfx = settings ? settings.sfx !== false : true;

            if (!allowSfx || !pageTurnSound) return;

            pageTurnSound.currentTime = 0;
            pageTurnSound.play().catch(() => {});
        }

        function scrollToChapter(chapter) {
            const target = chapter - 1;
            if (!isNaN(target) && target >= 0 && target < total) {
                current = target;
                playPageTurn();
                updateUI();
            }
        }

        function updateUI() {
            pages.forEach((page, i) => {
                const wasActive = page.classList.contains("active");
                page.classList.toggle("active", i === current);

                // Initialize game when Chapter 2 becomes active
                if (i === 1 && i === current && !wasActive) {
                    setTimeout(() => {
                        if (typeof initHoneyGame === 'function') {
                            initHoneyGame();
                        }
                    }, 300);
                }

                // Pause game when leaving Chapter 2
                if (i === 1 && wasActive && i !== current) {
                    if (typeof pauseHoneyGame === 'function') {
                        pauseHoneyGame();
                    }
                }
            });

            indicator.textContent = `Chapter ${current + 1} of ${total}`;
            progress.style.width = `${((current + 1) / total) * 100}%`;
            document
                .querySelectorAll("[data-chapter-target]")
                .forEach((btn) =>
                    btn.classList.toggle(
                        "active",
                        parseInt(btn.dataset.chapterTarget, 10) === current + 1
                    )
                );

            // Smooth scroll to page
            pages[current].scrollIntoView({ behavior: "smooth", block: "start" });
        }

        nextBtn?.addEventListener("click", () => {
            if (current < total - 1) {
                current++;
                playPageTurn();
                updateUI();
            }
        });

        prevBtn?.addEventListener("click", () => {
            if (current > 0) {
                current--;
                playPageTurn();
                updateUI();
            }
        });

        // Allow clicking chapter pills directly
        document.querySelectorAll("[data-chapter-target]").forEach((btn) => {
            btn.addEventListener("click", () => {
                const target = parseInt(btn.dataset.chapterTarget, 10) - 1;
                if (!isNaN(target) && target >= 0 && target < total) {
                    current = target;
                    playPageTurn();
                    updateUI();
                }
            });
        });

        // Optional keyboard navigation - only works when NOT in Chapter 2
        document.addEventListener("keydown", (e) => {
            // Check if we're in the game chapter
            const gamePage = document.querySelector('.page[data-chapter="2"]');
            const isInGame = gamePage && gamePage.classList.contains('active');

            // Don't navigate chapters if we're in the game
            if (isInGame) return;

            if (e.key === "ArrowRight") nextBtn?.click();
            if (e.key === "ArrowLeft") prevBtn?.click();
        });

        // Make scrollToChapter globally accessible
        window.scrollToChapter = scrollToChapter;

        // Initialize
        updateUI();
    });

    // Settings Panel Functionality
    (function() {
        "use strict";

        const settingsButton = document.getElementById('settingsButton');
        const settingsOverlay = document.getElementById('settingsOverlay');
        const closeSettings = document.getElementById('closeSettings');
        const applySettingsBtn = document.getElementById('applySettingsBtn');
        const resetSettingsBtn = document.getElementById('resetSettingsBtn');

        // Settings elements
        const difficultySelect = document.getElementById('difficultySelect');
        const musicToggle = document.getElementById('musicToggle');
        const sfxToggle = document.getElementById('sfxToggle');
        const volumeSlider = document.getElementById('volumeSlider');
        const volumeValue = document.getElementById('volumeValue');
        const particlesToggle = document.getElementById('particlesToggle');
        const animationsToggle = document.getElementById('animationsToggle');
        const sensitivitySlider = document.getElementById('sensitivitySlider');
        const sensitivityValue = document.getElementById('sensitivityValue');
        const vibrationToggle = document.getElementById('vibrationToggle');
        const mobileControlsToggle = document.getElementById('mobileControlsToggle');
        const themeOptions = document.querySelectorAll('.theme-option');

        // Audio elements
        const bgMusic = document.getElementById('bgMusic');
        const ambientForest = document.getElementById('ambientForest');
        const honeySound = document.getElementById('honeySound');
        const pageSound = document.getElementById('pageSound');

        function applyMobileViewportFix() {
            const viewportMeta = document.querySelector('meta[name="viewport"]');
            if (viewportMeta) {
                // This fixes the skinny layout issue on iPhones
                viewportMeta.content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover';
            }

            // Force body to full width
            document.body.style.width = '100vw';
            document.body.style.maxWidth = '100vw';
            document.body.style.overflowX = 'hidden';

            // Force all main containers to full width
            const containers = document.querySelectorAll('.container, .book-container, .masthead-hero, .hero-panel');
            containers.forEach(container => {
                container.style.width = '100%';
                container.style.maxWidth = '100%';
                container.style.marginLeft = '0';
                container.style.marginRight = '0';
            });
        }

        // Default settings
        const defaultSettings = {
            difficulty: 'medium',
            music: true,
            sfx: true,
            volume: 80,
            particles: true,
            animations: true,
            sensitivity: 260,
            vibration: false,
            mobileControls: true,
            theme: 'light'
        };

        // Current settings
        let currentSettings = { ...defaultSettings };
        let audioPrimed = false;

        // Call viewport fix early
        applyMobileViewportFix();
        window.addEventListener('resize', applyMobileViewportFix);
        window.addEventListener('orientationchange', () => {
            setTimeout(applyMobileViewportFix, 100);
        });

        const primeAudio = () => {
            audioPrimed = true;
            applySettingsToGame();
        };

        // Ensure browsers allow playback after the first interaction
        document.addEventListener('pointerdown', primeAudio, { once: true });
        document.addEventListener('keydown', primeAudio, { once: true });

        // Load saved settings from localStorage
        function loadSettings() {
            const saved = localStorage.getItem('honeyGameSettings');
            if (saved) {
                try {
                    currentSettings = { ...defaultSettings, ...JSON.parse(saved) };
                    applySettingsToUI();
                } catch (e) {
                    console.error('Error loading settings:', e);
                }
            }
            applySettingsToGame();
        }

        // Save settings to localStorage
        function saveSettings() {
            localStorage.setItem('honeyGameSettings', JSON.stringify(currentSettings));
        }

        // Apply settings to UI controls
        function applySettingsToUI() {
            difficultySelect.value = currentSettings.difficulty;
            musicToggle.checked = currentSettings.music;
            sfxToggle.checked = currentSettings.sfx;
            volumeSlider.value = currentSettings.volume;
            volumeValue.textContent = `${currentSettings.volume}%`;
            particlesToggle.checked = currentSettings.particles;
            animationsToggle.checked = currentSettings.animations;
            sensitivitySlider.value = currentSettings.sensitivity;
            sensitivityValue.textContent = currentSettings.sensitivity;
            vibrationToggle.checked = currentSettings.vibration;
            mobileControlsToggle.checked = currentSettings.mobileControls;

            // Set active theme
            themeOptions.forEach(option => {
                option.classList.remove('active');
                if (option.dataset.theme === currentSettings.theme) {
                    option.classList.add('active');
                }
            });

            // Apply theme to document
            applyTheme(currentSettings.theme);
        }

        // Apply settings to game
        function applySettingsToGame() {
            // Apply difficulty
            switch(currentSettings.difficulty) {
                case 'easy':
                    window.gameDifficulty = {
                        jarSpawnRate: 0.015,
                        jarSpeed: { min: 100, max: 180 },
                        beeSpawnRate: 0.008,
                        beeSpeed: { min: 80, max: 120 },
                        timeLimit: 90,
                        lives: 4
                    };
                    break;
                case 'medium':
                    window.gameDifficulty = {
                        jarSpawnRate: 0.02,
                        jarSpeed: { min: 150, max: 200 },
                        beeSpawnRate: 0.01,
                        beeSpeed: { min: 100, max: 150 },
                        timeLimit: 60,
                        lives: 3
                    };
                    break;
                case 'hard':
                    window.gameDifficulty = {
                        jarSpawnRate: 0.025,
                        jarSpeed: { min: 180, max: 250 },
                        beeSpawnRate: 0.015,
                        beeSpeed: { min: 120, max: 180 },
                        timeLimit: 45,
                        lives: 2
                    };
                    break;
                case 'expert':
                    window.gameDifficulty = {
                        jarSpawnRate: 0.03,
                        jarSpeed: { min: 200, max: 300 },
                        beeSpawnRate: 0.02,
                        beeSpeed: { min: 150, max: 220 },
                        timeLimit: 30,
                        lives: 1
                    };
                    break;
            }

            // Apply sensitivity to bear
            if (window.bear) {
                window.bear.speed = currentSettings.sensitivity;
            }

            // Apply volume to audio elements
            const volume = currentSettings.volume / 100;
            const audioElements = document.querySelectorAll('audio');
            audioElements.forEach(audio => {
                audio.volume = volume;
            });

            if (honeySound) honeySound.muted = !currentSettings.sfx;
            if (pageSound) pageSound.muted = !currentSettings.sfx;

            // Apply theme
            applyTheme(currentSettings.theme);

            // Apply animations
            document.body.classList.toggle('no-animations', !currentSettings.animations);

            // Apply mobile controls
            const mobileControls = document.getElementById('mobileControls');
            if (mobileControls) {
                if (currentSettings.mobileControls && ('ontouchstart' in window || navigator.maxTouchPoints > 0)) {
                    mobileControls.classList.add('visible');
                } else {
                    mobileControls.classList.remove('visible');
                }
            }

            // Toggle music
            if (bgMusic) {
                bgMusic.muted = !currentSettings.music;
                if (currentSettings.music && audioPrimed) {
                    bgMusic.play().catch(e => console.log('Audio play failed:', e));
                } else {
                    bgMusic.pause();
                }
            }

            if (ambientForest) {
                ambientForest.muted = !currentSettings.music;
                if (currentSettings.music && audioPrimed) {
                    ambientForest.play().catch(e => console.log('Audio play failed:', e));
                } else {
                    ambientForest.pause();
                }
            }
        }

        // Apply theme to document
        function applyTheme(theme) {
            // Remove existing theme classes
            document.documentElement.classList.remove('theme-light', 'theme-dark');

            // Determine actual theme (auto checks system preference)
            let actualTheme = theme;
            if (theme === 'auto') {
                actualTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
            }

            // Apply theme class
            document.documentElement.classList.add(`theme-${actualTheme}`);

            // Update theme colors
            if (actualTheme === 'dark') {
                document.documentElement.style.setProperty('--bg', '#1a1a1a');
                document.documentElement.style.setProperty('--bg-soft', '#2a2a2a');
                document.documentElement.style.setProperty('--ink', '#f0f0f0');
                document.documentElement.style.setProperty('--ink-soft', '#cccccc');
                document.documentElement.style.setProperty('--card-bg', '#2a2a2a');
                document.documentElement.style.setProperty('--border-soft', 'rgba(255, 255, 255, 0.1)');
            } else {
                // Reset to light theme
                document.documentElement.style.setProperty('--bg', '#fff9ec');
                document.documentElement.style.setProperty('--bg-soft', '#fff4dd');
                document.documentElement.style.setProperty('--ink', '#3b2604');
                document.documentElement.style.setProperty('--ink-soft', '#5a4330');
                document.documentElement.style.setProperty('--card-bg', '#ffffff');
                document.documentElement.style.setProperty('--border-soft', 'rgba(0, 0, 0, 0.06)');
            }
        }

        // Collect settings from UI
        function collectSettingsFromUI() {
            return {
                difficulty: difficultySelect.value,
                music: musicToggle.checked,
                sfx: sfxToggle.checked,
                volume: parseInt(volumeSlider.value),
                particles: particlesToggle.checked,
                animations: animationsToggle.checked,
                sensitivity: parseInt(sensitivitySlider.value),
                vibration: vibrationToggle.checked,
                mobileControls: mobileControlsToggle.checked,
                theme: document.querySelector('.theme-option.active').dataset.theme
            };
        }

        // Update game with new settings
        function updateGameSettings() {
            currentSettings = collectSettingsFromUI();
            saveSettings();
            applySettingsToGame();

            // Show confirmation
            showNotification('Settings applied!');
        }

        // Reset to defaults
        function resetToDefaults() {
            if (confirm('Reset all settings to defaults?')) {
                currentSettings = { ...defaultSettings };
                saveSettings();
                applySettingsToUI();
                applySettingsToGame();
                showNotification('Settings reset to defaults');
            }
        }

        // Show notification
        function showNotification(message) {
            // Create notification element
            const notification = document.createElement('div');
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: linear-gradient(135deg, #f4b944, #f59e0b);
                color: #3b2604;
                padding: 12px 24px;
                border-radius: 999px;
                font-weight: 600;
                box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
                z-index: 1001;
                animation: slideDown 0.3s ease, slideUp 0.3s ease 2s forwards;
            `;

            document.body.appendChild(notification);

            // Remove after animation
            setTimeout(() => {
                notification.remove();
            }, 2300);
        }

        // Event Listeners
        settingsButton.addEventListener('click', () => {
            settingsOverlay.classList.add('visible');
            document.body.style.overflow = 'hidden';
        });

        closeSettings.addEventListener('click', () => {
            settingsOverlay.classList.remove('visible');
            document.body.style.overflow = '';
        });

        settingsOverlay.addEventListener('click', (e) => {
            if (e.target === settingsOverlay) {
                settingsOverlay.classList.remove('visible');
                document.body.style.overflow = '';
            }
        });

        applySettingsBtn.addEventListener('click', updateGameSettings);
        resetSettingsBtn.addEventListener('click', resetToDefaults);

        // Live updates for sliders
        volumeSlider.addEventListener('input', (e) => {
            volumeValue.textContent = `${e.target.value}%`;
        });

        sensitivitySlider.addEventListener('input', (e) => {
            sensitivityValue.textContent = e.target.value;
        });

        // Theme selection
        themeOptions.forEach(option => {
            option.addEventListener('click', () => {
                themeOptions.forEach(opt => opt.classList.remove('active'));
                option.classList.add('active');
            });
        });

        // Listen for system theme changes (for auto theme)
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
            if (currentSettings.theme === 'auto') {
                applyTheme('auto');
            }
        });

        // Close with Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && settingsOverlay.classList.contains('visible')) {
                settingsOverlay.classList.remove('visible');
                document.body.style.overflow = '';
            }
        });

        // Initialize settings
        window.addEventListener('load', loadSettings);

        // Make functions available globally
        window.applyGameSettings = applySettingsToGame;
        window.getGameSettings = () => currentSettings;
        window.showSettings = () => settingsButton.click();

    })();

</script>

<!-- Audio Elements -->
<audio id="bgMusic" loop preload="auto" src="media/hundred-acre-lullaby.mp3"></audio>
<audio id="honeySound" preload="auto">
    <source src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3">
</audio>
<audio id="pageSound" preload="auto">
    <source src="https://assets.mixkit.co/sfx/preview/mixkit-page-turn-single-1100.mp3">
</audio>
<audio id="pageRustle1" preload="auto">
    <source src="https://assets.mixkit.co/sfx/preview/mixkit-page-turn-single-1100.mp3">
</audio>
<audio id="pageRustle2" preload="auto">
    <source src="https://assets.mixkit.co/sfx/preview/mixkit-page-turn-medium-1103.mp3">
</audio>
<audio id="paperThump" preload="auto">
    <source src="https://assets.mixkit.co/sfx/preview/mixkit-soft-ui-click-2577.mp3">
</audio>
<audio id="ambientForest" loop preload="auto">
    <source src="https://assets.mixkit.co/sfx/preview/mixkit-forest-birds-ambience-121.mp3">
</audio>
</body>
</html>
