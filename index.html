<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <title>Baby Gunnar's Hundred Acre Wood Adventure</title>
    <meta name="description" content="An interactive storybook journey through the Hundred Acre Wood with honey-sweet games and heartfelt wishes for Baby Gunnar." />
    <meta name="theme-color" content="#f4a944" />
    <meta name="color-scheme" content="light dark" />
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üçØ</text></svg>">
    <link rel="apple-touch-icon" href="media/icons/icon-192.png">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700;900&family=Patrick+Hand&family=Playfair+Display:wght@600;700;800&family=Caveat:wght@400;600&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet" />
    
    <!-- Animate.css for smooth animations -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    
    <!-- Main CSS -->
    <link rel="preload" href="styles.css" as="style">
            
</head>
<body>
    <!-- Parallax background elements -->
    <div class="floating-element" style="top: 10%; left: 5%; font-size: 3rem; animation-delay: 0s;">üçØ</div>
    <div class="floating-element" style="top: 20%; right: 10%; font-size: 2.5rem; animation-delay: 1s;">üêù</div>
    <div class="floating-element" style="bottom: 30%; left: 15%; font-size: 4rem; animation-delay: 2s;">üêª</div>
    <div class="floating-element" style="bottom: 20%; right: 5%; font-size: 3rem; animation-delay: 3s;">üéà</div>
    
    <a class="skip-link" href="#main">Skip to content</a>
    
    <!-- Toast notification system -->
    <div id="toast" class="toast" role="alert" aria-live="assertive" aria-atomic="true"></div>
    
    <!-- Reading progress -->
    <div class="reading-progress" id="readingProgress" aria-hidden="true"></div>
    
    <!-- Cover / Intro -->
    <div class="storybook-cover" id="cover" role="dialog" aria-modal="true" aria-label="Welcome screen">
        <div class="cover-card">
            <div class="cover-decoration" aria-hidden="true"></div>
            <h1 class="cover-title animate__animated animate__fadeInDown">Baby Gunnar's Hundred Acre Wood</h1>
            <p class="cover-subtitle animate__animated animate__fadeInUp animate__delay-1s">
                A magical interactive storybook journey through the Hundred Acre Wood. 
                Play honey-sweet games, meet beloved friends, and share heartfelt wishes.
            </p>
            <div class="storybook-form animate__animated animate__fadeInUp animate__delay-2s">
                <button class="btn btn-primary" id="enterStory" type="button" aria-label="Enter the storybook">
                    <i class="fa-solid fa-book-open" aria-hidden="true"></i>
                    Begin the Adventure
                </button>
                <p class="tip" style="margin-top: 2rem; opacity: 0.8; max-width: 58ch; text-align:center;">
                    <i class="fa-solid fa-lightbulb"></i>
                    Tip: Tap anywhere to unlock sound. Works best on modern browsers.
                    <span id="installPrompt" style="display: none; margin-top: 0.5rem;">
                        <br>
                        <button id="installButton" class="btn btn-ghost" style="font-size: 0.9rem;">
                            <i class="fas fa-download"></i> Install App
                        </button>
                    </span>
                </p>
            </div>
        </div>
    </div>
    
    <!-- Top nav -->
    <header class="nav" role="navigation" aria-label="Primary">
        <div class="nav-brand">
            <span aria-hidden="true" role="img">üçØ</span>
            <div class="nav-title">Hundred Acre Celebration</div>
        </div>
        <button class="nav-toggle" id="navToggle" type="button" aria-label="Open menu" aria-expanded="false">
            <i class="fa-solid fa-bars" aria-hidden="true"></i>
        </button>
        <nav class="nav-menu" id="navMenu" aria-label="Site sections">
            <a class="nav-item" href="#story"><i class="fa-solid fa-feather" aria-hidden="true"></i> Story</a>
            <a class="nav-item" href="#friends"><i class="fa-solid fa-people-group" aria-hidden="true"></i> Friends</a>
            <a class="nav-item" href="#games"><i class="fa-solid fa-gamepad" aria-hidden="true"></i> Games</a>
            <a class="nav-item" href="#wishes"><i class="fa-solid fa-heart" aria-hidden="true"></i> Wishes</a>
        </nav>
    </header>
    
    <!-- Floating action buttons -->
    <div class="fab-stack" aria-label="Quick actions">
        <button class="fab" id="muteToggle" type="button" aria-label="Toggle sound" aria-pressed="false" title="Sound">
            <i class="fa-solid fa-volume-xmark" aria-hidden="true"></i>
        </button>
        <button class="accessibility-btn" id="accessibilityToggle" type="button" aria-label="Toggle accessibility mode" aria-pressed="false" title="Accessibility">
            <i class="fa-solid fa-person-walking" aria-hidden="true"></i>
        </button>
        <button class="fab" id="scrollTop" type="button" aria-label="Scroll to top" title="Top">
            <i class="fa-solid fa-arrow-up" aria-hidden="true"></i>
        </button>
    </div>
    
    <main id="main" class="storybook-shell">
        <div class="storybook">
            <div class="storybook-inner">
                <!-- Story -->
                <section class="content-section" id="story" aria-labelledby="storyTitle">
                    <div class="content-section-inner">
                        <header class="storybook-header">
                            <h2 class="storybook-heading" id="storyTitle">A Cozy Little Adventure</h2>
                            <p class="storybook-subheading">
                                Welcome to Baby Gunnar's Hundred Acre Wood celebration ‚Äî a gentle storybook moment with friends,
                                honey-sweet games, and a place to leave your wishes.
                            </p>
                        </header>
                        <!-- Story progression -->
                        <div class="story-progression">
                            <div class="story-step">
                                <div class="story-icon">üìñ</div>
                                <h3>Read</h3>
                                <p>Discover heartfelt messages from Pooh and friends</p>
                            </div>
                            <div class="story-step">
                                <div class="story-icon">üéÆ</div>
                                <h3>Play</h3>
                                <p>Enjoy the honey-sweet catch game with Pooh</p>
                            </div>
                            <div class="story-step">
                                <div class="story-icon">üíù</div>
                                <h3>Share</h3>
                                <p>Leave warm wishes for Baby Gunnar</p>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Friends -->
                <section class="content-section" id="friends" aria-labelledby="friendsTitle">
                    <div class="content-section-inner">
                        <h2 class="section-title" id="friendsTitle">Friends in the Wood</h2>
                        <p class="section-subtitle">Tap a friend for a little message.</p>
                        <div class="characters-grid-enhanced">
                            <article class="character-spotlight" data-character="pooh" tabindex="0" role="button" 
                                     aria-label="Open Pooh message" aria-describedby="pooh-desc">
                                <div class="character-spotlight-content">
                                    <div class="character-illustration">
                                        <img src="media/characters/pooh.png" alt="Pooh holding a honey pot" loading="lazy" decoding="async"
                                            onerror="this.style.display='none'; this.parentElement.innerHTML='üêª';" />
                                    </div>
                                    <h3 class="character-name">Pooh</h3>
                                    <p class="character-quote">A little honey goes a long way.</p>
                                </div>
                                <div class="sr-only" id="pooh-desc">Click to hear Pooh's message about sweetness and kindness</div>
                            </article>
                            <article class="character-spotlight" data-character="piglet" tabindex="0" role="button" 
                                     aria-label="Open Piglet message" aria-describedby="piglet-desc">
                                <div class="character-spotlight-content">
                                    <div class="character-illustration">
                                        <img src="media/characters/piglet.png" alt="Piglet looking thoughtful" loading="lazy" decoding="async"
                                            onerror="this.style.display='none'; this.parentElement.innerHTML='üê∑';" />
                                    </div>
                                    <h3 class="character-name">Piglet</h3>
                                    <p class="character-quote">Small steps. Big heart.</p>
                                </div>
                                <div class="sr-only" id="piglet-desc">Click to hear Piglet's message about courage and small beginnings</div>
                            </article>
                            <article class="character-spotlight" data-character="eeyore" tabindex="0" role="button" 
                                     aria-label="Open Eeyore message" aria-describedby="eeyore-desc">
                                <div class="character-spotlight-content">
                                    <div class="character-illustration">
                                        <img src="media/characters/eeyore.png" alt="Eeyore with his tail" loading="lazy" decoding="async"
                                            onerror="this.style.display='none'; this.parentElement.innerHTML='üê¥';" />
                                    </div>
                                    <h3 class="character-name">Eeyore</h3>
                                    <p class="character-quote">Quiet love still counts.</p>
                                </div>
                                <div class="sr-only" id="eeyore-desc">Click to hear Eeyore's message about quiet strength and loyalty</div>
                            </article>
                            <article class="character-spotlight" data-character="tigger" tabindex="0" role="button" 
                                     aria-label="Open Tigger message" aria-describedby="tigger-desc">
                                <div class="character-spotlight-content">
                                    <div class="character-illustration">
                                        <img src="media/characters/tigger.png" alt="Tigger bouncing happily" loading="lazy" decoding="async"
                                            onerror="this.style.display='none'; this.parentElement.innerHTML='üêØ';" />
                                    </div>
                                    <h3 class="character-name">Tigger</h3>
                                    <p class="character-quote">Bounce into the fun-fun.</p>
                                </div>
                                <div class="sr-only" id="tigger-desc">Click to hear Tigger's message about joy and enthusiasm</div>
                            </article>
                        </div>
                    </div>
                </section>
                
                <!-- Games -->
                <article class="game-card" id="catch-card" aria-label="Honey Pot Catch game">
                    <header class="game-header">
                        <h3 class="game-title">
                            <i class="fa-solid fa-gamepad" aria-hidden="true"></i>
                            Honey Pot Catch
                        </h3>
                        <p class="game-help">
                            Move Pooh left/right. Catch honey. Dodge bees. Power-ups help.
                        </p>
                        <div class="game-mode-toggle" role="group" aria-label="Pick a tempo">
                            <button class="mode-chip is-active" data-catch-mode="calm" type="button" aria-pressed="true">Calm Stroll</button>
                            <button class="mode-chip" data-catch-mode="brisk" type="button" aria-pressed="false">Adventure</button>
                            <button class="mode-chip" data-catch-mode="rush" type="button" aria-pressed="false">Honey Rush</button>
                            <p class="mode-chip-note" id="catch-mode-description">A relaxed 70 second run with extra hearts.</p>
                        </div>
                    </header>
                    
                    <!-- Enhanced HUD with more stats -->
                    <div class="game-hud" aria-label="Game status">
                        <span class="hud-stat"><span class="hud-pill">Score: <span id="score-count">0</span></span></span>
                        <span class="hud-stat"><span class="hud-pill">Time: <span id="time-count">60</span>s</span></span>
                        <span class="hud-stat"><span class="hud-pill">Lives: <span id="catch-lives">3</span></span></span>
                        <span class="hud-stat"><span class="hud-pill"><span id="catch-combo">0</span> Combo</span></span>
                        <span class="hud-stat"><span class="hud-pill">√ó<span id="catch-multiplier">1</span></span></span>
                        <span class="hud-stat"><span class="hud-pill">Best: <span id="catch-best">0</span></span></span>
                        <span class="hud-stat"><span class="hud-pill">FPS: <span id="catch-fps">60</span></span></span>
                    </div>
                    
                    <div class="hud-progress" aria-hidden="false">
                        <div class="progress-block">
                            <div class="progress-label">Time left</div>
                            <div class="progress-track">
                                <div class="progress-fill" id="catch-timebar" style="--w: 100%; width: 100%;"></div>
                            </div>
                        </div>
                        <div class="progress-block">
                            <div class="progress-label">Hearts</div>
                            <div class="progress-track hearts">
                                <div class="progress-fill" id="catch-life-bar" style="--w: 100%; width: 100%;"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="game-stage">
                        <canvas id="honey-game" class="game-canvas" 
                            aria-label="Honey Pot Catch game area. Use arrow keys or touch to move Pooh left and right to catch honey pots and avoid bees." 
                            role="application"
                            tabindex="0">
                            Your browser does not support the canvas element. Please try using a modern browser.
                        </canvas>
                        
                        <!-- Overlay with game status -->
                        <div class="game-overlay" id="catch-overlay" aria-live="polite">
                            <div class="countdown-display" id="catch-countdown">Ready when you are.</div>
                            <div class="overlay-hint" id="catch-hint">Press Start to begin a calm 60 second run.</div>
                        </div>
                        
                        <!-- Active power-ups display -->
                        <div class="active-effects" id="activeEffects" aria-label="Active power-ups" style="display: none;">
                            <div class="effect" id="effect-shield">üõ°Ô∏è 0s</div>
                            <div class="effect" id="effect-star">‚≠ê 0s</div>
                            <div class="effect" id="effect-lightning">‚ö° 0s</div>
                        </div>
                    </div>
                    
                    <!-- Enhanced Game Controls -->
                    <div class="game-controls" aria-label="Game controls">
                        <button class="btn btn-primary" id="start-catch" type="button">
                            <i class="fa-solid fa-play" aria-hidden="true"></i> Start
                        </button>
                        <button class="btn btn-secondary" id="pause-catch" type="button" aria-pressed="false">
                            <i class="fa-solid fa-pause" aria-hidden="true"></i> Pause
                        </button>
                        <button class="btn btn-secondary" id="stats-button" type="button">
                            <i class="fa-solid fa-chart-bar" aria-hidden="true"></i> Stats
                        </button>
                        <button class="btn btn-secondary" id="save-button" type="button">
                            <i class="fa-solid fa-save" aria-hidden="true"></i> Save
                        </button>
                        <button class="btn btn-secondary" id="share-button" type="button">
                            <i class="fa-solid fa-share-alt" aria-hidden="true"></i> Share
                        </button>
                        
                        <div class="joystick-dock" aria-hidden="false">
                            <div id="catchJoystick" class="virtual-joystick" aria-label="Drag to steer Pooh" role="slider" aria-valuemin="-40" aria-valuemax="40" aria-valuenow="0">
                                <div class="joystick-base"></div>
                                <div class="joystick-knob" id="catchJoystickKnob"></div>
                            </div>
                            <p class="joystick-hint">Drag on phones. Arrow keys + mouse also work.</p>
                        </div>
                    </div>
                    
                    <!-- Quick Save Indicator -->
                    <div class="save-indicator" id="saveIndicator" aria-live="polite" style="display: none;">
                        <i class="fas fa-check-circle"></i> Game saved
                    </div>
                    
                    <!-- Game status with announcements -->
                    <p class="tip" id="catchStatus" aria-live="polite" style="margin: 12px 14px 16px;">
                        Ready. Select a mode and press Start to play.
                    </p>
                    
                    <!-- Game guide with keyboard shortcuts -->
                    <div class="game-guide-grid" aria-label="How to play">
                        <div class="guide-card">
                            <div class="guide-icon" role="img" aria-label="Honey pot">üçØ</div>
                            <div>
                                <h4>Sweet catches</h4>
                                <p>Golden pots boost your score and streak. Keep moving to chain them.</p>
                                <small class="key-hint"><kbd>‚Üê</kbd> <kbd>‚Üí</kbd> Move</small>
                            </div>
                        </div>
                        <div class="guide-card">
                            <div class="guide-icon" role="img" aria-label="Bee">üêù</div>
                            <div>
                                <h4>Watch the buzz</h4>
                                <p>Angry bees drift toward Pooh. A shield or quick sidestep keeps hearts safe.</p>
                                <small class="key-hint"><kbd>A</kbd> <kbd>D</kbd> Move</small>
                            </div>
                        </div>
                        <div class="guide-card">
                            <div class="guide-icon" role="img" aria-label="Star">‚≠ê</div>
                            <div>
                                <h4>Power-up moments</h4>
                                <p>Clock adds time, hearts heal, lightning slows the world, stars double points.</p>
                                <small class="key-hint"><kbd>Space</kbd> Dash</small>
                            </div>
                        </div>
                        <div class="guide-card">
                            <div class="guide-icon" role="img" aria-label="Target">üéØ</div>
                            <div>
                                <h4>Chase a personal best</h4>
                                <p>Your best run is saved locally. Try the Honey Rush tempo for riskier rewards.</p>
                                <small class="key-hint"><kbd>Esc</kbd> Pause</small>
                            </div>
                        </div>
                    </div>
                </article>
                
                <!-- Wishes -->
                <section class="content-section" id="wishes" aria-labelledby="wishesTitle">
                    <div class="content-section-inner">
                        <h2 class="section-title" id="wishesTitle">Leave a Wish</h2>
                        <p class="section-subtitle">A simple spot to leave kind words for Baby Gunnar.</p>
                        
                        <form class="wishes-form" id="wishesForm" novalidate>
                            <div class="wishes-grid">
                                <label class="wishes-field" for="wishName">
                                    <span class="field-label">Your name (optional)</span>
                                    <input id="wishName" name="wishName" type="text" maxlength="60" autocomplete="name" placeholder="Christopher Robin" />
                                </label>
                                <label class="wishes-field" for="wishEmoji">
                                    <span class="field-label">Mood</span>
                                    <select id="wishEmoji" name="wishEmoji">
                                        <option value="üçØ">üçØ Honey-sweet</option>
                                        <option value="üåø">üåø Peaceful stroll</option>
                                        <option value="üéà">üéà Cheerful</option>
                                        <option value="‚≠ê">‚≠ê Encouraging</option>
                                        <option value="üíå">üíå Heartfelt</option>
                                        <option value="üêª">üêª Friendly bear hug</option>
                                    </select>
                                </label>
                            </div>
                            <label class="wishes-field" for="wishMessage">
                                <span class="field-label">Your note</span>
                                <textarea id="wishMessage" name="wishMessage" maxlength="240" 
                                          placeholder="Write a gentle wish or encouragement..." 
                                          required></textarea>
                                <div class="field-meta" id="wishMeta" aria-live="polite">0 / 240 characters</div>
                            </label>
                            
                            <div class="wishes-actions">
                                <button class="btn btn-primary" type="submit">
                                    <i class="fa-solid fa-paper-plane" aria-hidden="true"></i>
                                    Send wish
                                </button>
                                <button class="btn btn-secondary" type="reset">
                                    <i class="fa-solid fa-rotate-left" aria-hidden="true"></i>
                                    Reset
                                </button>
                                <button class="btn btn-ghost" id="clearWishes" type="button">
                                    <i class="fa-solid fa-broom" aria-hidden="true"></i>
                                    Clear saved wishes
                                </button>
                            </div>
                            
                            <div class="wish-status" id="wishStatus" role="status" aria-live="polite"></div>
                        </form>
                        
                        <!-- Wish statistics -->
                        <div class="wish-stats" id="wishStats" aria-label="Wish statistics">
                            <div class="stat">
                                <span class="stat-number" id="totalWishes">0</span>
                                <span class="stat-label">Total Wishes</span>
                            </div>
                            <div class="stat">
                                <span class="stat-number" id="todayWishes">0</span>
                                <span class="stat-label">Today</span>
                            </div>
                            <div class="stat">
                                <span class="stat-number" id="lastWish">--:--</span>
                                <span class="stat-label">Last Wish</span>
                            </div>
                        </div>
                        
                        <!-- Wishes list with filtering -->
                        <div class="wishes-controls">
                            <div class="filter-buttons" role="group" aria-label="Filter wishes">
                                <button class="filter-btn active" data-filter="all">All</button>
                                <button class="filter-btn" data-filter="today">Today</button>
                                <button class="filter-btn" data-filter="week">This Week</button>
                            </div>
                            <div class="sort-options">
                                <label for="sortWishes">Sort by:</label>
                                <select id="sortWishes">
                                    <option value="newest">Newest First</option>
                                    <option value="oldest">Oldest First</option>
                                    <option value="name">Name A-Z</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="wishes-list" id="wishesList" aria-live="polite" aria-label="Recent wishes">
                            <!-- Wishes will be loaded here dynamically -->
                            <div class="empty-state" id="emptyWishes">
                                <div class="empty-icon">üí≠</div>
                                <h3>No wishes yet</h3>
                                <p>Be the first to leave a warm wish for Baby Gunnar!</p>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Footer with credits -->
                <footer class="site-footer">
                    <div class="footer-content">
                        <p>Made with <span aria-label="love">‚ù§Ô∏è</span> for Baby Gunnar</p>
                        <p class="footer-links">
                            <a href="#story" class="footer-link">Story</a> ‚Ä¢ 
                            <a href="#friends" class="footer-link">Friends</a> ‚Ä¢ 
                            <a href="#games" class="footer-link">Games</a> ‚Ä¢ 
                            <a href="#wishes" class="footer-link">Wishes</a>
                        </p>
                        <p class="footer-copyright">¬© 2024 Hundred Acre Celebration</p>
                        <button class="btn btn-ghost btn-small" id="resetAll" type="button">
                            <i class="fas fa-trash-can"></i> Clear All Data
                        </button>
                    </div>
                </footer>
            </div>
        </div>
    </main>
    
    <!-- Character Modal -->
    <div class="character-modal" id="characterModal" role="dialog" aria-modal="true" aria-label="Character message" tabindex="-1">
        <div class="modal-content" role="document">
            <button class="close-modal" id="closeCharacterModal" type="button" aria-label="Close">
                <i class="fa-solid fa-xmark" aria-hidden="true"></i>
            </button>
            <div class="modal-character">
                <div class="modal-character-icon pooh-icon-modal" id="modalIcon" aria-hidden="true">
                    üêª
                </div>
                <div>
                    <h3 class="modal-character-name" id="modalName">Pooh</h3>
                    <p class="modal-character-quote" id="modalQuote">A little honey goes a long way.</p>
                </div>
            </div>
            <div class="modal-character-bio" id="modalBio">
                Pooh reminds us that sometimes the sweetest things come in simple moments. 
                Just like honey, kindness spreads and makes everything better.
            </div>
        </div>
    </div>
    
    <!-- Stats Modal -->
    <div class="modal-overlay" id="statsModal">
        <div class="modal-content stats-modal" role="dialog" aria-labelledby="statsTitle">
            <button class="close-modal" id="closeStatsModal" type="button" aria-label="Close">
                <i class="fa-solid fa-xmark" aria-hidden="true"></i>
            </button>
            <h3 id="statsTitle">Game Statistics</h3>
            <div class="stats-grid" id="statsContent">
                <!-- Stats will be loaded here -->
            </div>
        </div>
    </div>
    
    <!-- Reset Confirmation Modal -->
    <div class="modal-overlay" id="resetModal">
        <div class="modal-content" role="dialog" aria-labelledby="resetTitle">
            <h3 id="resetTitle">Confirm Reset</h3>
            <p>Are you sure you want to clear all game data? This cannot be undone.</p>
            <div class="modal-actions">
                <button class="btn btn-danger" id="confirmReset">Clear All</button>
                <button class="btn btn-secondary" id="cancelReset">Cancel</button>
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="script.js" defer></script>
   
</body>
</html>